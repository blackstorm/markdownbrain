/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MarkdownBrainPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  serverUrl: "https://api.markdownbrain.com",
  syncKey: "",
  autoSync: true
};
var SyncManager = class {
  constructor(config) {
    this.config = config;
  }
  updateConfig(config) {
    this.config = config;
  }
  async testConnection(timeout = 3e4) {
    try {
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), timeout);
      const response = await (0, import_obsidian.requestUrl)({
        url: `${this.config.serverUrl}/api/vault/info`,
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.syncKey}`
        },
        throw: false
      });
      clearTimeout(timeoutId);
      if (response.status === 200) {
        const data = response.json;
        return {
          success: true,
          vaultInfo: data.vault
        };
      } else {
        return {
          success: false,
          error: `HTTP ${response.status}: ${response.text || "Unknown error"}`
        };
      }
    } catch (error) {
      if ((error == null ? void 0 : error.name) === "AbortError") {
        return {
          success: false,
          error: "\u8FDE\u63A5\u8D85\u65F6\uFF0830\u79D2\uFF09"
        };
      }
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  async sync(data) {
    var _a, _b;
    console.log("[MarkdownBrain] Starting sync:", {
      path: data.path,
      action: data.action,
      hasContent: !!data.content,
      contentLength: (_a = data.content) == null ? void 0 : _a.length,
      serverUrl: this.config.serverUrl,
      hasSyncKey: !!this.config.syncKey
    });
    try {
      const requestBody = JSON.stringify(data);
      console.log("[MarkdownBrain] Request body size:", requestBody.length, "bytes");
      const response = await (0, import_obsidian.requestUrl)({
        url: `${this.config.serverUrl}/api/sync`,
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${this.config.syncKey}`
        },
        body: requestBody,
        throw: false
      });
      console.log("[MarkdownBrain] Response:", {
        status: response.status,
        statusText: response.status,
        headers: response.headers,
        bodyPreview: (_b = response.text) == null ? void 0 : _b.substring(0, 200)
      });
      if (response.status === 200) {
        console.log("[MarkdownBrain] \u2713 Sync successful:", data.path);
        return { success: true };
      } else {
        const errorMsg = `HTTP ${response.status}: ${response.text || "Sync failed"}`;
        console.error("[MarkdownBrain] \u2717 Sync failed:", {
          path: data.path,
          status: response.status,
          error: errorMsg,
          responseBody: response.text
        });
        return {
          success: false,
          error: errorMsg
        };
      }
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 Sync exception:", {
        path: data.path,
        error,
        errorMessage: error instanceof Error ? error.message : "Unknown error",
        errorStack: error instanceof Error ? error.stack : void 0
      });
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  destroy() {
  }
};
var MarkdownBrainPlugin = class extends import_obsidian.Plugin {
  // 跟踪待同步的文件
  constructor(app, manifest) {
    super(app, manifest);
    this.syncDebounceTimers = /* @__PURE__ */ new Map();
    this.pendingSyncs = /* @__PURE__ */ new Set();
  }
  // 生成客户端 ID（基于路径的 SHA-256 hash）
  async generateClientId(path) {
    const encoder = new TextEncoder();
    const data = encoder.encode(path);
    const hashBuffer = await crypto.subtle.digest("SHA-256", data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map((b) => b.toString(16).padStart(2, "0")).join("");
    return `${hashHex.substring(0, 8)}-${hashHex.substring(8, 12)}-${hashHex.substring(12, 16)}-${hashHex.substring(16, 20)}-${hashHex.substring(20, 32)}`;
  }
  // 标准化 Obsidian 链接路径
  normalizeLinkPath(link) {
    let path = link.split("#")[0].split("^")[0];
    if (!path.includes(".")) {
      path = path + ".md";
    }
    return path;
  }
  // 判断是否是媒体文件
  isMediaFile(path) {
    const mediaExtensions = [
      // 图片
      ".png",
      ".jpg",
      ".jpeg",
      ".gif",
      ".bmp",
      ".svg",
      ".webp",
      // 视频
      ".mp4",
      ".webm",
      ".ogv",
      ".mov",
      ".mkv",
      // 音频
      ".mp3",
      ".wav",
      ".m4a",
      ".ogg",
      ".3gp",
      ".flac",
      // 其他
      ".pdf"
    ];
    const ext = path.substring(path.lastIndexOf(".")).toLowerCase();
    return mediaExtensions.includes(ext);
  }
  // 获取媒体文件类型
  getMediaType(path) {
    const ext = path.substring(path.lastIndexOf(".")).toLowerCase();
    const imageExts = [".png", ".jpg", ".jpeg", ".gif", ".bmp", ".svg", ".webp"];
    const videoExts = [".mp4", ".webm", ".ogv", ".mov", ".mkv"];
    const audioExts = [".mp3", ".wav", ".m4a", ".ogg", ".3gp", ".flac"];
    if (imageExts.includes(ext)) return "image";
    if (videoExts.includes(ext)) return "video";
    if (audioExts.includes(ext)) return "audio";
    if (ext === ".pdf") return "pdf";
    return "other";
  }
  async onload() {
    var _a;
    console.log("[MarkdownBrain] ========================================");
    console.log("[MarkdownBrain] Plugin loading...");
    await this.loadSettings();
    console.log("[MarkdownBrain] Settings loaded:", {
      serverUrl: this.settings.serverUrl,
      hasSyncKey: !!this.settings.syncKey,
      syncKeyLength: (_a = this.settings.syncKey) == null ? void 0 : _a.length,
      autoSync: this.settings.autoSync
    });
    this.syncManager = new SyncManager({
      serverUrl: this.settings.serverUrl,
      syncKey: this.settings.syncKey
    });
    console.log("[MarkdownBrain] SyncManager initialized");
    this.registerEvent(
      this.app.vault.on("create", (file) => {
        if (file instanceof import_obsidian.TFile && file.extension === "md") {
          this.handleFileChange(file, "create");
        }
      })
    );
    console.log("[MarkdownBrain] Registered event: file create");
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian.TFile && file.extension === "md") {
          this.pendingSyncs.add(file.path);
        }
      })
    );
    console.log("[MarkdownBrain] Registered event: file modify");
    this.registerEvent(
      this.app.metadataCache.on("resolved", () => {
        for (const filePath of this.pendingSyncs) {
          const file = this.app.vault.getAbstractFileByPath(filePath);
          if (file instanceof import_obsidian.TFile) {
            this.handleFileChange(file, "modify");
          }
        }
        this.pendingSyncs.clear();
      })
    );
    console.log("[MarkdownBrain] Registered event: metadata resolved");
    this.registerEvent(
      this.app.vault.on("delete", (file) => {
        if (file instanceof import_obsidian.TFile && file.extension === "md") {
          this.handleFileDelete(file);
        }
      })
    );
    console.log("[MarkdownBrain] Registered event: file delete");
    this.addSettingTab(new MarkdownBrainSettingTab(this.app, this));
    console.log("[MarkdownBrain] Settings tab added");
    this.addCommand({
      id: "sync-current-file",
      name: "Sync current file",
      callback: () => {
        const file = this.app.workspace.getActiveFile();
        if (file) {
          this.handleFileChange(file, "modify");
        }
      }
    });
    this.addCommand({
      id: "sync-all-files",
      name: "Sync all files",
      callback: () => {
        this.syncAllFiles();
      }
    });
    console.log("[MarkdownBrain] Commands registered");
    console.log("[MarkdownBrain] \u2713 Plugin loaded successfully");
    console.log("[MarkdownBrain] ========================================");
  }
  async handleFileChange(file, action) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping:", file.path);
      return;
    }
    const existingTimer = this.syncDebounceTimers.get(file.path);
    if (existingTimer) {
      clearTimeout(existingTimer);
    }
    const timer = setTimeout(async () => {
      this.syncDebounceTimers.delete(file.path);
      await this.performSync(file, action);
    }, 300);
    this.syncDebounceTimers.set(file.path, timer);
  }
  async performSync(file, action) {
    var _a, _b, _c, _d;
    console.log("[MarkdownBrain] File change detected:", {
      path: file.path,
      action,
      extension: file.extension,
      size: file.stat.size
    });
    try {
      const content = await this.app.vault.read(file);
      console.log("[MarkdownBrain] File read successfully:", {
        path: file.path,
        contentLength: content.length
      });
      if (!content || content.trim().length === 0) {
        console.log("[MarkdownBrain] Skipping empty file:", file.path);
        return;
      }
      if (file.path.includes("\u672A\u547D\u540D") && content.trim().length === 0) {
        console.log("[MarkdownBrain] Skipping untitled empty file:", file.path);
        return;
      }
      const cachedMetadata = this.app.metadataCache.getFileCache(file);
      const metadata = {};
      console.log("[MarkdownBrain] Raw cached metadata:", cachedMetadata);
      if (cachedMetadata) {
        const allLinks = [];
        if (cachedMetadata.links) {
          console.log("[MarkdownBrain] Found", cachedMetadata.links.length, "links in metadata");
          for (const link of cachedMetadata.links) {
            console.log("[MarkdownBrain] Processing link:", link);
            const normalizedPath = this.normalizeLinkPath(link.link);
            console.log("[MarkdownBrain] Normalized path:", normalizedPath);
            const targetClientId = await this.generateClientId(normalizedPath);
            console.log("[MarkdownBrain] Generated targetClientId:", targetClientId);
            const isMedia = this.isMediaFile(normalizedPath);
            const linkData = {
              link: normalizedPath,
              targetClientId,
              original: link.original,
              displayText: link.displayText,
              linkType: "link"
            };
            if (isMedia) {
              linkData.isMedia = true;
              linkData.mediaType = this.getMediaType(normalizedPath);
              console.log("[MarkdownBrain] Media file detected:", linkData.mediaType);
            }
            allLinks.push(linkData);
          }
        }
        if (cachedMetadata.embeds) {
          console.log("[MarkdownBrain] Found", cachedMetadata.embeds.length, "embeds in metadata");
          for (const embed of cachedMetadata.embeds) {
            console.log("[MarkdownBrain] Processing embed:", embed);
            const normalizedPath = this.normalizeLinkPath(embed.link);
            console.log("[MarkdownBrain] Normalized path:", normalizedPath);
            const targetClientId = await this.generateClientId(normalizedPath);
            console.log("[MarkdownBrain] Generated targetClientId:", targetClientId);
            const isMedia = this.isMediaFile(normalizedPath);
            const linkData = {
              link: normalizedPath,
              targetClientId,
              original: embed.original,
              linkType: "embed"
            };
            if (isMedia) {
              linkData.isMedia = true;
              linkData.mediaType = this.getMediaType(normalizedPath);
              console.log("[MarkdownBrain] Media file detected:", linkData.mediaType);
            }
            allLinks.push(linkData);
          }
        }
        if (allLinks.length > 0) {
          metadata.links = allLinks;
          console.log("[MarkdownBrain] Total links to sync:", allLinks.length);
          console.log("[MarkdownBrain] Links data:", JSON.stringify(allLinks, null, 2));
        } else {
          console.log("[MarkdownBrain] No links found in this document");
        }
        if (cachedMetadata.tags) {
          metadata.tags = cachedMetadata.tags.map((tag) => ({
            tag: tag.tag,
            position: tag.position
          }));
        }
        if (cachedMetadata.headings) {
          metadata.headings = cachedMetadata.headings.map((heading) => ({
            heading: heading.heading,
            level: heading.level,
            position: heading.position
          }));
        }
        if (cachedMetadata.frontmatter) {
          metadata.frontmatter = cachedMetadata.frontmatter;
        }
        console.log("[MarkdownBrain] Metadata extracted:", {
          path: file.path,
          linksCount: ((_a = metadata.links) == null ? void 0 : _a.length) || 0,
          tagsCount: ((_b = metadata.tags) == null ? void 0 : _b.length) || 0,
          headingsCount: ((_c = metadata.headings) == null ? void 0 : _c.length) || 0,
          hasFrontmatter: !!metadata.frontmatter
        });
      }
      const stat = file.stat;
      const hash = this.hashString(content);
      const mtime = new Date(stat.mtime).toISOString();
      const clientId = await this.generateClientId(file.path);
      console.log("[MarkdownBrain] File metadata:", {
        path: file.path,
        clientId,
        hash,
        mtime,
        hasMetadata: !!metadata,
        linksCount: ((_d = metadata.links) == null ? void 0 : _d.length) || 0
      });
      const syncData = {
        path: file.path,
        clientId,
        clientType: "obsidian",
        content,
        hash,
        mtime,
        metadata,
        action
      };
      console.log("[MarkdownBrain] Sync data prepared:");
      console.log("[MarkdownBrain] - Path:", syncData.path);
      console.log("[MarkdownBrain] - ClientId:", syncData.clientId);
      console.log("[MarkdownBrain] - Action:", syncData.action);
      console.log("[MarkdownBrain] - Metadata:", JSON.stringify(syncData.metadata, null, 2));
      const result = await this.syncManager.sync(syncData);
      if (result.success) {
        console.log("[MarkdownBrain] \u2713 File synced successfully:", file.path);
      } else {
        console.error("[MarkdownBrain] \u2717 File sync failed:", file.path, result.error);
        new import_obsidian.Notice(`\u540C\u6B65\u5931\u8D25: ${file.path}
${result.error}`);
      }
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 File change handler error:", {
        path: file.path,
        error,
        errorMessage: error instanceof Error ? error.message : "Unknown error",
        errorStack: error instanceof Error ? error.stack : void 0
      });
      new import_obsidian.Notice(`\u540C\u6B65\u9519\u8BEF: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  async handleFileDelete(file) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping delete:", file.path);
      return;
    }
    console.log("[MarkdownBrain] File deletion detected:", {
      path: file.path,
      extension: file.extension
    });
    try {
      const clientId = await this.generateClientId(file.path);
      const result = await this.syncManager.sync({
        path: file.path,
        clientId,
        clientType: "obsidian",
        action: "delete"
      });
      if (result.success) {
        console.log("[MarkdownBrain] \u2713 File deletion synced:", file.path);
      } else {
        console.error("[MarkdownBrain] \u2717 File deletion sync failed:", file.path, result.error);
      }
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 Delete sync exception:", {
        path: file.path,
        error,
        errorMessage: error instanceof Error ? error.message : "Unknown error"
      });
    }
  }
  async syncAllFiles() {
    const files = this.app.vault.getMarkdownFiles();
    new import_obsidian.Notice(`\u5F00\u59CB\u540C\u6B65 ${files.length} \u4E2A\u6587\u4EF6...`);
    let success = 0;
    let failed = 0;
    for (const file of files) {
      try {
        await this.handleFileChange(file, "modify");
        success++;
      } catch (error) {
        failed++;
        console.error(`Failed to sync ${file.path}:`, error);
      }
    }
    new import_obsidian.Notice(`\u540C\u6B65\u5B8C\u6210: ${success} \u6210\u529F, ${failed} \u5931\u8D25`);
  }
  // 简单的字符串哈希函数
  hashString(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = (hash << 5) - hash + char;
      hash = hash & hash;
    }
    return hash.toString(16);
  }
  onunload() {
    console.log("Unloading MarkdownBrain plugin");
    for (const timer of this.syncDebounceTimers.values()) {
      clearTimeout(timer);
    }
    this.syncDebounceTimers.clear();
    this.syncManager.destroy();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.syncManager.updateConfig({
      serverUrl: this.settings.serverUrl,
      syncKey: this.settings.syncKey
    });
  }
};
var MarkdownBrainSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "MarkdownBrain \u540C\u6B65\u8BBE\u7F6E" });
    new import_obsidian.Setting(containerEl).setName("\u670D\u52A1\u5668\u5730\u5740").setDesc("MarkdownBrain \u670D\u52A1\u5668 API \u5730\u5740").addText((text) => text.setPlaceholder("https://api.markdownbrain.com").setValue(this.plugin.settings.serverUrl).onChange(async (value) => {
      this.plugin.settings.serverUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Sync Key").setDesc("\u4ECE\u7BA1\u7406\u540E\u53F0\u83B7\u53D6\u7684\u540C\u6B65\u5BC6\u94A5").addText((text) => text.setPlaceholder("xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx").setValue(this.plugin.settings.syncKey).onChange(async (value) => {
      this.plugin.settings.syncKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("\u6D4B\u8BD5\u8FDE\u63A5").setDesc("\u6D4B\u8BD5\u4E0E\u670D\u52A1\u5668\u7684\u8FDE\u63A5\uFF0830\u79D2\u8D85\u65F6\uFF09").addButton((button) => button.setButtonText("\u6D4B\u8BD5").onClick(async () => {
      button.setDisabled(true);
      button.setButtonText("\u6D4B\u8BD5\u4E2D...");
      new import_obsidian.Notice("\u6B63\u5728\u6D4B\u8BD5\u8FDE\u63A5...");
      const result = await this.plugin.syncManager.testConnection(3e4);
      button.setDisabled(false);
      button.setButtonText("\u6D4B\u8BD5");
      if (result.success && result.vaultInfo) {
        new import_obsidian.Notice(
          `\u2705 \u8FDE\u63A5\u6210\u529F\uFF01
Vault: ${result.vaultInfo.name}
Domain: ${result.vaultInfo.domain}`,
          5e3
        );
      } else {
        new import_obsidian.Notice(`\u274C \u8FDE\u63A5\u5931\u8D25: ${result.error || "Unknown error"}`, 5e3);
      }
    }));
    new import_obsidian.Setting(containerEl).setName("\u81EA\u52A8\u540C\u6B65").setDesc("\u6587\u4EF6\u4FEE\u6539\u65F6\u81EA\u52A8\u540C\u6B65\u5230\u670D\u52A1\u5668").addToggle((toggle) => toggle.setValue(this.plugin.settings.autoSync).onChange(async (value) => {
      this.plugin.settings.autoSync = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL21haW4udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgVEZpbGUsIE5vdGljZSwgUGx1Z2luU2V0dGluZ1RhYiwgQXBwLCBTZXR0aW5nLCByZXF1ZXN0VXJsIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5pbnRlcmZhY2UgTWFya2Rvd25CcmFpblNldHRpbmdzIHtcbiAgICBzZXJ2ZXJVcmw6IHN0cmluZztcbiAgICBzeW5jS2V5OiBzdHJpbmc7XG4gICAgYXV0b1N5bmM6IGJvb2xlYW47XG59XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE1hcmtkb3duQnJhaW5TZXR0aW5ncyA9IHtcbiAgICBzZXJ2ZXJVcmw6ICdodHRwczovL2FwaS5tYXJrZG93bmJyYWluLmNvbScsXG4gICAgc3luY0tleTogJycsXG4gICAgYXV0b1N5bmM6IHRydWVcbn07XG5cbi8vIFx1NTQwQ1x1NkI2NVx1OTE0RFx1N0Y2RVxuaW50ZXJmYWNlIFN5bmNDb25maWcge1xuICAgIHNlcnZlclVybDogc3RyaW5nO1xuICAgIHN5bmNLZXk6IHN0cmluZztcbn1cblxuLy8gXHU2NTg3XHU2ODYzXHU1MTQzXHU2NTcwXHU2MzZFXG5pbnRlcmZhY2UgRG9jdW1lbnRNZXRhZGF0YSB7XG4gICAgbGlua3M/OiBBcnJheTx7XG4gICAgICAgIGxpbms6IHN0cmluZzsgICAgICAgICAgICAgIC8vIFx1OTRGRVx1NjNBNVx1NzZFRVx1NjgwN1x1OERFRlx1NUY4NFxuICAgICAgICB0YXJnZXRDbGllbnRJZDogc3RyaW5nOyAgICAvLyBcdTc2RUVcdTY4MDdcdTY1ODdcdTY4NjNcdTc2ODQgY2xpZW50X2lkXG4gICAgICAgIG9yaWdpbmFsOiBzdHJpbmc7ICAgICAgICAgIC8vIFx1NTM5Rlx1NTlDQlx1NjU4N1x1NjcyQ1xuICAgICAgICBkaXNwbGF5VGV4dD86IHN0cmluZzsgICAgICAvLyBcdTY2M0VcdTc5M0FcdTY1ODdcdTY3MkNcbiAgICAgICAgbGlua1R5cGU6ICdsaW5rJyB8ICdlbWJlZCc7IC8vIFx1OTRGRVx1NjNBNVx1N0M3Qlx1NTc4QlxuICAgICAgICBpc01lZGlhPzogYm9vbGVhbjsgICAgICAgICAvLyBcdTY2MkZcdTU0MjZcdTY2MkZcdTVBOTJcdTRGNTNcdTY1ODdcdTRFRjZcbiAgICAgICAgbWVkaWFUeXBlPzogJ2ltYWdlJyB8ICd2aWRlbycgfCAnYXVkaW8nIHwgJ3BkZicgfCAnb3RoZXInOyAvLyBcdTVBOTJcdTRGNTNcdTdDN0JcdTU3OEJcbiAgICB9PjtcbiAgICB0YWdzPzogQXJyYXk8e1xuICAgICAgICB0YWc6IHN0cmluZztcbiAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgIHN0YXJ0OiB7IGxpbmU6IG51bWJlcjsgY29sOiBudW1iZXI7IG9mZnNldDogbnVtYmVyIH07XG4gICAgICAgICAgICBlbmQ6IHsgbGluZTogbnVtYmVyOyBjb2w6IG51bWJlcjsgb2Zmc2V0OiBudW1iZXIgfTtcbiAgICAgICAgfTtcbiAgICB9PjtcbiAgICBoZWFkaW5ncz86IEFycmF5PHtcbiAgICAgICAgaGVhZGluZzogc3RyaW5nO1xuICAgICAgICBsZXZlbDogbnVtYmVyO1xuICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgc3RhcnQ6IHsgbGluZTogbnVtYmVyOyBjb2w6IG51bWJlcjsgb2Zmc2V0OiBudW1iZXIgfTtcbiAgICAgICAgICAgIGVuZDogeyBsaW5lOiBudW1iZXI7IGNvbDogbnVtYmVyOyBvZmZzZXQ6IG51bWJlciB9O1xuICAgICAgICB9O1xuICAgIH0+O1xuICAgIGZyb250bWF0dGVyPzogUmVjb3JkPHN0cmluZywgYW55Pjtcbn1cblxuLy8gXHU1NDBDXHU2QjY1XHU2NTcwXHU2MzZFXG5pbnRlcmZhY2UgU3luY0RhdGEge1xuICAgIHBhdGg6IHN0cmluZztcbiAgICBjbGllbnRJZDogc3RyaW5nOyAgICAgICAgICAgLy8gXHU1QkEyXHU2MjM3XHU3QUVGXHU3NTFGXHU2MjEwXHU3Njg0XHU1NTJGXHU0RTAwIElEXG4gICAgY2xpZW50VHlwZTogc3RyaW5nOyAgICAgICAgIC8vIFx1NUJBMlx1NjIzN1x1N0FFRlx1N0M3Qlx1NTc4Qlx1RkYxQSdvYnNpZGlhbidcbiAgICBjb250ZW50Pzogc3RyaW5nO1xuICAgIGhhc2g/OiBzdHJpbmc7XG4gICAgbXRpbWU/OiBzdHJpbmc7XG4gICAgbWV0YWRhdGE/OiBEb2N1bWVudE1ldGFkYXRhO1xuICAgIGFjdGlvbjogJ2NyZWF0ZScgfCAnbW9kaWZ5JyB8ICdkZWxldGUnO1xufVxuXG4vLyBWYXVsdCBcdTRGRTFcdTYwNkZcbmludGVyZmFjZSBWYXVsdEluZm8ge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGRvbWFpbjogc3RyaW5nO1xuICAgICdjcmVhdGVkLWF0Jzogc3RyaW5nO1xufVxuXG4vLyBcdTU0MENcdTZCNjVcdTdCQTFcdTc0MDZcdTU2NjhcbmNsYXNzIFN5bmNNYW5hZ2VyIHtcbiAgICBwcml2YXRlIGNvbmZpZzogU3luY0NvbmZpZztcblxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZzogU3luY0NvbmZpZykge1xuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB9XG5cbiAgICB1cGRhdGVDb25maWcoY29uZmlnOiBTeW5jQ29uZmlnKSB7XG4gICAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cblxuICAgIGFzeW5jIHRlc3RDb25uZWN0aW9uKHRpbWVvdXQ6IG51bWJlciA9IDMwMDAwKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IHZhdWx0SW5mbz86IFZhdWx0SW5mbzsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCB0aW1lb3V0KTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgICAgICB1cmw6IGAke3RoaXMuY29uZmlnLnNlcnZlclVybH0vYXBpL3ZhdWx0L2luZm9gLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5zeW5jS2V5fWBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRocm93OiBmYWxzZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbjtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB2YXVsdEluZm86IGRhdGEudmF1bHRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBIVFRQICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS50ZXh0IHx8ICdVbmtub3duIGVycm9yJ31gXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgICAgaWYgKGVycm9yPy5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdcdThGREVcdTYzQTVcdThEODVcdTY1RjZcdUZGMDgzMFx1NzlEMlx1RkYwOSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBzeW5jKGRhdGE6IFN5bmNEYXRhKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBTdGFydGluZyBzeW5jOicsIHtcbiAgICAgICAgICAgIHBhdGg6IGRhdGEucGF0aCxcbiAgICAgICAgICAgIGFjdGlvbjogZGF0YS5hY3Rpb24sXG4gICAgICAgICAgICBoYXNDb250ZW50OiAhIWRhdGEuY29udGVudCxcbiAgICAgICAgICAgIGNvbnRlbnRMZW5ndGg6IGRhdGEuY29udGVudD8ubGVuZ3RoLFxuICAgICAgICAgICAgc2VydmVyVXJsOiB0aGlzLmNvbmZpZy5zZXJ2ZXJVcmwsXG4gICAgICAgICAgICBoYXNTeW5jS2V5OiAhIXRoaXMuY29uZmlnLnN5bmNLZXlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFJlcXVlc3QgYm9keSBzaXplOicsIHJlcXVlc3RCb2R5Lmxlbmd0aCwgJ2J5dGVzJyk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG4gICAgICAgICAgICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5zZXJ2ZXJVcmx9L2FwaS9zeW5jYCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLnN5bmNLZXl9YFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogcmVxdWVzdEJvZHksXG4gICAgICAgICAgICAgICAgdGhyb3c6IGZhbHNlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBSZXNwb25zZTonLCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgYm9keVByZXZpZXc6IHJlc3BvbnNlLnRleHQ/LnN1YnN0cmluZygwLCAyMDApXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBcdTI3MTMgU3luYyBzdWNjZXNzZnVsOicsIGRhdGEucGF0aCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IGBIVFRQICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS50ZXh0IHx8ICdTeW5jIGZhaWxlZCd9YDtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTWFya2Rvd25CcmFpbl0gXHUyNzE3IFN5bmMgZmFpbGVkOicsIHtcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogZGF0YS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yTXNnLFxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZUJvZHk6IHJlc3BvbnNlLnRleHRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yTXNnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgU3luYyBleGNlcHRpb246Jywge1xuICAgICAgICAgICAgICAgIHBhdGg6IGRhdGEucGF0aCxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXG4gICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgICAgICAgICBlcnJvclN0YWNrOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICAvLyBDbGVhbnVwIGlmIG5lZWRlZFxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFya2Rvd25CcmFpblBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3MhOiBNYXJrZG93bkJyYWluU2V0dGluZ3M7XG4gICAgc3luY01hbmFnZXIhOiBTeW5jTWFuYWdlcjsgIC8vIFx1NjUzOVx1NEUzQSBwdWJsaWNcdUZGMENcdTRGOUJcdThCQkVcdTdGNkVcdTk3NjJcdTY3N0ZcdTRGN0ZcdTc1MjhcbiAgICBwcml2YXRlIHN5bmNEZWJvdW5jZVRpbWVyczogTWFwPHN0cmluZywgTm9kZUpTLlRpbWVvdXQ+O1xuICAgIHByaXZhdGUgcGVuZGluZ1N5bmNzOiBTZXQ8c3RyaW5nPjsgIC8vIFx1OERERlx1OEUyQVx1NUY4NVx1NTQwQ1x1NkI2NVx1NzY4NFx1NjU4N1x1NEVGNlxuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG1hbmlmZXN0OiBQbHVnaW5NYW5pZmVzdCkge1xuICAgICAgICBzdXBlcihhcHAsIG1hbmlmZXN0KTtcbiAgICAgICAgdGhpcy5zeW5jRGVib3VuY2VUaW1lcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMucGVuZGluZ1N5bmNzID0gbmV3IFNldCgpO1xuICAgIH1cblxuICAgIC8vIFx1NzUxRlx1NjIxMFx1NUJBMlx1NjIzN1x1N0FFRiBJRFx1RkYwOFx1NTdGQVx1NEU4RVx1OERFRlx1NUY4NFx1NzY4NCBTSEEtMjU2IGhhc2hcdUZGMDlcbiAgICBhc3luYyBnZW5lcmF0ZUNsaWVudElkKHBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICAgICAgY29uc3QgZGF0YSA9IGVuY29kZXIuZW5jb2RlKHBhdGgpO1xuICAgICAgICBjb25zdCBoYXNoQnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kaWdlc3QoJ1NIQS0yNTYnLCBkYXRhKTtcbiAgICAgICAgY29uc3QgaGFzaEFycmF5ID0gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShoYXNoQnVmZmVyKSk7XG4gICAgICAgIGNvbnN0IGhhc2hIZXggPSBoYXNoQXJyYXkubWFwKGIgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKSkuam9pbignJyk7XG4gICAgICAgIC8vIFx1NjgzQ1x1NUYwRlx1NTMxNlx1NEUzQSBVVUlEIFx1NjgzN1x1NUYwRlxuICAgICAgICByZXR1cm4gYCR7aGFzaEhleC5zdWJzdHJpbmcoMCwgOCl9LSR7aGFzaEhleC5zdWJzdHJpbmcoOCwgMTIpfS0ke2hhc2hIZXguc3Vic3RyaW5nKDEyLCAxNil9LSR7aGFzaEhleC5zdWJzdHJpbmcoMTYsIDIwKX0tJHtoYXNoSGV4LnN1YnN0cmluZygyMCwgMzIpfWA7XG4gICAgfVxuXG4gICAgLy8gXHU2ODA3XHU1MUM2XHU1MzE2IE9ic2lkaWFuIFx1OTRGRVx1NjNBNVx1OERFRlx1NUY4NFxuICAgIG5vcm1hbGl6ZUxpbmtQYXRoKGxpbms6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIFx1NzlGQlx1OTY2NFx1NTNFRlx1ODBGRFx1NzY4NFx1OTUxQVx1NzBCOVx1NTQ4Q1x1NTc1N1x1NUYxNVx1NzUyOFxuICAgICAgICBsZXQgcGF0aCA9IGxpbmsuc3BsaXQoJyMnKVswXS5zcGxpdCgnXicpWzBdO1xuXG4gICAgICAgIC8vIFx1NEUwRFx1ODk4MVx1NEUzQVx1OTc1RSBtYXJrZG93biBcdTY1ODdcdTRFRjZcdTZERkJcdTUyQTAgLm1kIFx1NjI2OVx1NUM1NVx1NTQwRFxuICAgICAgICAvLyBcdTRGRERcdTc1NTlcdTUzOUZcdTU5Q0JcdTYyNjlcdTVDNTVcdTU0MERcdUZGMDhcdTU5ODIgLnBuZywgLmpwZywgLm1wNCBcdTdCNDlcdUZGMDlcbiAgICAgICAgaWYgKCFwYXRoLmluY2x1ZGVzKCcuJykpIHtcbiAgICAgICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NkNBMVx1NjcwOVx1NjI2OVx1NUM1NVx1NTQwRFx1RkYwQ1x1NTA0N1x1OEJCRVx1NjYyRiBtYXJrZG93biBcdTY1ODdcdTRFRjZcbiAgICAgICAgICAgIHBhdGggPSBwYXRoICsgJy5tZCc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcGF0aDtcbiAgICB9XG5cbiAgICAvLyBcdTUyMjRcdTY1QURcdTY2MkZcdTU0MjZcdTY2MkZcdTVBOTJcdTRGNTNcdTY1ODdcdTRFRjZcbiAgICBpc01lZGlhRmlsZShwYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgbWVkaWFFeHRlbnNpb25zID0gW1xuICAgICAgICAgICAgLy8gXHU1NkZFXHU3MjQ3XG4gICAgICAgICAgICAnLnBuZycsICcuanBnJywgJy5qcGVnJywgJy5naWYnLCAnLmJtcCcsICcuc3ZnJywgJy53ZWJwJyxcbiAgICAgICAgICAgIC8vIFx1ODlDNlx1OTg5MVxuICAgICAgICAgICAgJy5tcDQnLCAnLndlYm0nLCAnLm9ndicsICcubW92JywgJy5ta3YnLFxuICAgICAgICAgICAgLy8gXHU5N0YzXHU5ODkxXG4gICAgICAgICAgICAnLm1wMycsICcud2F2JywgJy5tNGEnLCAnLm9nZycsICcuM2dwJywgJy5mbGFjJyxcbiAgICAgICAgICAgIC8vIFx1NTE3Nlx1NEVENlxuICAgICAgICAgICAgJy5wZGYnXG4gICAgICAgIF07XG5cbiAgICAgICAgY29uc3QgZXh0ID0gcGF0aC5zdWJzdHJpbmcocGF0aC5sYXN0SW5kZXhPZignLicpKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gbWVkaWFFeHRlbnNpb25zLmluY2x1ZGVzKGV4dCk7XG4gICAgfVxuXG4gICAgLy8gXHU4M0I3XHU1M0Q2XHU1QTkyXHU0RjUzXHU2NTg3XHU0RUY2XHU3QzdCXHU1NzhCXG4gICAgZ2V0TWVkaWFUeXBlKHBhdGg6IHN0cmluZyk6ICdpbWFnZScgfCAndmlkZW8nIHwgJ2F1ZGlvJyB8ICdwZGYnIHwgJ290aGVyJyB7XG4gICAgICAgIGNvbnN0IGV4dCA9IHBhdGguc3Vic3RyaW5nKHBhdGgubGFzdEluZGV4T2YoJy4nKSkudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBjb25zdCBpbWFnZUV4dHMgPSBbJy5wbmcnLCAnLmpwZycsICcuanBlZycsICcuZ2lmJywgJy5ibXAnLCAnLnN2ZycsICcud2VicCddO1xuICAgICAgICBjb25zdCB2aWRlb0V4dHMgPSBbJy5tcDQnLCAnLndlYm0nLCAnLm9ndicsICcubW92JywgJy5ta3YnXTtcbiAgICAgICAgY29uc3QgYXVkaW9FeHRzID0gWycubXAzJywgJy53YXYnLCAnLm00YScsICcub2dnJywgJy4zZ3AnLCAnLmZsYWMnXTtcblxuICAgICAgICBpZiAoaW1hZ2VFeHRzLmluY2x1ZGVzKGV4dCkpIHJldHVybiAnaW1hZ2UnO1xuICAgICAgICBpZiAodmlkZW9FeHRzLmluY2x1ZGVzKGV4dCkpIHJldHVybiAndmlkZW8nO1xuICAgICAgICBpZiAoYXVkaW9FeHRzLmluY2x1ZGVzKGV4dCkpIHJldHVybiAnYXVkaW8nO1xuICAgICAgICBpZiAoZXh0ID09PSAnLnBkZicpIHJldHVybiAncGRmJztcbiAgICAgICAgcmV0dXJuICdvdGhlcic7XG4gICAgfVxuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBQbHVnaW4gbG9hZGluZy4uLicpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBTZXR0aW5ncyBsb2FkZWQ6Jywge1xuICAgICAgICAgICAgc2VydmVyVXJsOiB0aGlzLnNldHRpbmdzLnNlcnZlclVybCxcbiAgICAgICAgICAgIGhhc1N5bmNLZXk6ICEhdGhpcy5zZXR0aW5ncy5zeW5jS2V5LFxuICAgICAgICAgICAgc3luY0tleUxlbmd0aDogdGhpcy5zZXR0aW5ncy5zeW5jS2V5Py5sZW5ndGgsXG4gICAgICAgICAgICBhdXRvU3luYzogdGhpcy5zZXR0aW5ncy5hdXRvU3luY1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBcdTUyMURcdTU5Q0JcdTUzMTZcdTU0MENcdTZCNjVcdTdCQTFcdTc0MDZcdTU2NjhcbiAgICAgICAgdGhpcy5zeW5jTWFuYWdlciA9IG5ldyBTeW5jTWFuYWdlcih7XG4gICAgICAgICAgICBzZXJ2ZXJVcmw6IHRoaXMuc2V0dGluZ3Muc2VydmVyVXJsLFxuICAgICAgICAgICAgc3luY0tleTogdGhpcy5zZXR0aW5ncy5zeW5jS2V5XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFN5bmNNYW5hZ2VyIGluaXRpYWxpemVkJyk7XG5cbiAgICAgICAgLy8gXHU3NkQxXHU1NDJDXHU2NTg3XHU0RUY2XHU1MjFCXHU1RUZBXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdjcmVhdGUnLCAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVGaWxlQ2hhbmdlKGZpbGUsICdjcmVhdGUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFJlZ2lzdGVyZWQgZXZlbnQ6IGZpbGUgY3JlYXRlJyk7XG5cbiAgICAgICAgLy8gXHU3NkQxXHU1NDJDXHU2NTg3XHU0RUY2XHU0RkVFXHU2NTM5XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU2ODA3XHU4QkIwXHU0RTNBXHU1Rjg1XHU1NDBDXHU2QjY1XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZ1N5bmNzLmFkZChmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gUmVnaXN0ZXJlZCBldmVudDogZmlsZSBtb2RpZnknKTtcblxuICAgICAgICAvLyBcdTc2RDFcdTU0MkNcdTUxNDNcdTY1NzBcdTYzNkVcdTdGMTNcdTVCNThcdTY2RjRcdTY1QjBcdTVCOENcdTYyMTBcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5vbigncmVzb2x2ZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gbWV0YWRhdGFDYWNoZSBcdTVERjJcdTg5RTNcdTY3OTBcdTVCOENcdTYyMTBcdUZGMENcdTU5MDRcdTc0MDZcdTYyNDBcdTY3MDlcdTVGODVcdTU0MENcdTZCNjVcdTc2ODRcdTY1ODdcdTRFRjZcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIHRoaXMucGVuZGluZ1N5bmNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUZpbGVDaGFuZ2UoZmlsZSwgJ21vZGlmeScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZ1N5bmNzLmNsZWFyKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFJlZ2lzdGVyZWQgZXZlbnQ6IG1ldGFkYXRhIHJlc29sdmVkJyk7XG5cbiAgICAgICAgLy8gXHU3NkQxXHU1NDJDXHU2NTg3XHU0RUY2XHU1MjIwXHU5NjY0XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVGaWxlRGVsZXRlKGZpbGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gUmVnaXN0ZXJlZCBldmVudDogZmlsZSBkZWxldGUnKTtcblxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdThCQkVcdTdGNkVcdTk3NjJcdTY3N0ZcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBNYXJrZG93bkJyYWluU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFNldHRpbmdzIHRhYiBhZGRlZCcpO1xuXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NTQ3RFx1NEVFNFx1RkYxQVx1NjI0Qlx1NTJBOFx1NTQwQ1x1NkI2NVx1NUY1M1x1NTI0RFx1NjU4N1x1NEVGNlxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzeW5jLWN1cnJlbnQtZmlsZScsXG4gICAgICAgICAgICBuYW1lOiAnU3luYyBjdXJyZW50IGZpbGUnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUZpbGVDaGFuZ2UoZmlsZSwgJ21vZGlmeScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU1NDdEXHU0RUU0XHVGRjFBXHU1NDBDXHU2QjY1XHU2MjQwXHU2NzA5XHU2NTg3XHU0RUY2XG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3N5bmMtYWxsLWZpbGVzJyxcbiAgICAgICAgICAgIG5hbWU6ICdTeW5jIGFsbCBmaWxlcycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3luY0FsbEZpbGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIENvbW1hbmRzIHJlZ2lzdGVyZWQnKTtcblxuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFx1MjcxMyBQbHVnaW4gbG9hZGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcbiAgICB9XG5cbiAgICBhc3luYyBoYW5kbGVGaWxlQ2hhbmdlKGZpbGU6IFRGaWxlLCBhY3Rpb246ICdjcmVhdGUnIHwgJ21vZGlmeScpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmF1dG9TeW5jKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEF1dG8tc3luYyBkaXNhYmxlZCwgc2tpcHBpbmc6JywgZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFx1NkUwNVx1OTY2NFx1NEU0Qlx1NTI0RFx1NzY4NFx1OTYzMlx1NjI5Nlx1NUI5QVx1NjVGNlx1NTY2OFxuICAgICAgICBjb25zdCBleGlzdGluZ1RpbWVyID0gdGhpcy5zeW5jRGVib3VuY2VUaW1lcnMuZ2V0KGZpbGUucGF0aCk7XG4gICAgICAgIGlmIChleGlzdGluZ1RpbWVyKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoZXhpc3RpbmdUaW1lcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBcdTRGN0ZcdTc1MjhcdTk2MzJcdTYyOTZcdTkwN0ZcdTUxNERcdTVGRUJcdTkwMUZcdThGREVcdTdFRURcdTc2ODRcdTU0MENcdTZCNjVcbiAgICAgICAgY29uc3QgdGltZXIgPSBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3luY0RlYm91bmNlVGltZXJzLmRlbGV0ZShmaWxlLnBhdGgpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wZXJmb3JtU3luYyhmaWxlLCBhY3Rpb24pO1xuICAgICAgICB9LCAzMDApOyAvLyAzMDBtcyBcdTk2MzJcdTYyOTZcblxuICAgICAgICB0aGlzLnN5bmNEZWJvdW5jZVRpbWVycy5zZXQoZmlsZS5wYXRoLCB0aW1lcik7XG4gICAgfVxuXG4gICAgYXN5bmMgcGVyZm9ybVN5bmMoZmlsZTogVEZpbGUsIGFjdGlvbjogJ2NyZWF0ZScgfCAnbW9kaWZ5Jykge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gRmlsZSBjaGFuZ2UgZGV0ZWN0ZWQ6Jywge1xuICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICBleHRlbnNpb246IGZpbGUuZXh0ZW5zaW9uLFxuICAgICAgICAgICAgc2l6ZTogZmlsZS5zdGF0LnNpemVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFx1OEJGQlx1NTNENlx1NjU4N1x1NEVGNlx1NTE4NVx1NUJCOVxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEZpbGUgcmVhZCBzdWNjZXNzZnVsbHk6Jywge1xuICAgICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICBjb250ZW50TGVuZ3RoOiBjb250ZW50Lmxlbmd0aFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFx1OERGM1x1OEZDN1x1N0E3QVx1NTE4NVx1NUJCOVx1NzY4NFx1NjU4N1x1NEVGNlxuICAgICAgICAgICAgaWYgKCFjb250ZW50IHx8IGNvbnRlbnQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gU2tpcHBpbmcgZW1wdHkgZmlsZTonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gXHU4REYzXHU4RkM3XCJcdTY3MkFcdTU0N0RcdTU0MEQubWRcIlx1NjU4N1x1NEVGNlx1RkYwOFx1NTk4Mlx1Njc5Q1x1NTE4NVx1NUJCOVx1NEUzQVx1N0E3QVx1RkYwOVxuICAgICAgICAgICAgaWYgKGZpbGUucGF0aC5pbmNsdWRlcygnXHU2NzJBXHU1NDdEXHU1NDBEJykgJiYgY29udGVudC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBTa2lwcGluZyB1bnRpdGxlZCBlbXB0eSBmaWxlOicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBcdTgzQjdcdTUzRDZcdTY1ODdcdTRFRjZcdTUxNDNcdTY1NzBcdTYzNkUgLSBcdTRGN0ZcdTc1MjggT2JzaWRpYW4gQVBJXG4gICAgICAgICAgICBjb25zdCBjYWNoZWRNZXRhZGF0YSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgICAgY29uc3QgbWV0YWRhdGE6IERvY3VtZW50TWV0YWRhdGEgPSB7fTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBSYXcgY2FjaGVkIG1ldGFkYXRhOicsIGNhY2hlZE1ldGFkYXRhKTtcblxuICAgICAgICAgICAgaWYgKGNhY2hlZE1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gXHU2M0QwXHU1M0Q2XHU5NEZFXHU2M0E1XHU1NDhDXHU1RDRDXHU1MTY1XHVGRjBDXHU1NDA4XHU1RTc2XHU0RTNBXHU3RURGXHU0RTAwXHU3Njg0IGxpbmtzIFx1NjU3MFx1N0VDNFxuICAgICAgICAgICAgICAgIGNvbnN0IGFsbExpbmtzOiBBcnJheTx7XG4gICAgICAgICAgICAgICAgICAgIGxpbms6IHN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2xpZW50SWQ6IHN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWw6IHN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVRleHQ/OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgIGxpbmtUeXBlOiAnbGluaycgfCAnZW1iZWQnO1xuICAgICAgICAgICAgICAgIH0+ID0gW107XG5cbiAgICAgICAgICAgICAgICAvLyBcdTU5MDRcdTc0MDZcdTY2NkVcdTkwMUFcdTk0RkVcdTYzQTVcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGVkTWV0YWRhdGEubGlua3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBGb3VuZCcsIGNhY2hlZE1ldGFkYXRhLmxpbmtzLmxlbmd0aCwgJ2xpbmtzIGluIG1ldGFkYXRhJyk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbGluayBvZiBjYWNoZWRNZXRhZGF0YS5saW5rcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBQcm9jZXNzaW5nIGxpbms6JywgbGluayk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub3JtYWxpemVkUGF0aCA9IHRoaXMubm9ybWFsaXplTGlua1BhdGgobGluay5saW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gTm9ybWFsaXplZCBwYXRoOicsIG5vcm1hbGl6ZWRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldENsaWVudElkID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNsaWVudElkKG5vcm1hbGl6ZWRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gR2VuZXJhdGVkIHRhcmdldENsaWVudElkOicsIHRhcmdldENsaWVudElkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNNZWRpYSA9IHRoaXMuaXNNZWRpYUZpbGUobm9ybWFsaXplZFBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlua0RhdGE6IGFueSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rOiBub3JtYWxpemVkUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDbGllbnRJZDogdGFyZ2V0Q2xpZW50SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWw6IGxpbmsub3JpZ2luYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVRleHQ6IGxpbmsuZGlzcGxheVRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua1R5cGU6ICdsaW5rJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTWVkaWEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rRGF0YS5pc01lZGlhID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rRGF0YS5tZWRpYVR5cGUgPSB0aGlzLmdldE1lZGlhVHlwZShub3JtYWxpemVkUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBNZWRpYSBmaWxlIGRldGVjdGVkOicsIGxpbmtEYXRhLm1lZGlhVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbExpbmtzLnB1c2gobGlua0RhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gXHU1OTA0XHU3NDA2XHU1RDRDXHU1MTY1XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlZE1ldGFkYXRhLmVtYmVkcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEZvdW5kJywgY2FjaGVkTWV0YWRhdGEuZW1iZWRzLmxlbmd0aCwgJ2VtYmVkcyBpbiBtZXRhZGF0YScpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVtYmVkIG9mIGNhY2hlZE1ldGFkYXRhLmVtYmVkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBQcm9jZXNzaW5nIGVtYmVkOicsIGVtYmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRQYXRoID0gdGhpcy5ub3JtYWxpemVMaW5rUGF0aChlbWJlZC5saW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gTm9ybWFsaXplZCBwYXRoOicsIG5vcm1hbGl6ZWRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldENsaWVudElkID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNsaWVudElkKG5vcm1hbGl6ZWRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gR2VuZXJhdGVkIHRhcmdldENsaWVudElkOicsIHRhcmdldENsaWVudElkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNNZWRpYSA9IHRoaXMuaXNNZWRpYUZpbGUobm9ybWFsaXplZFBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlua0RhdGE6IGFueSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rOiBub3JtYWxpemVkUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDbGllbnRJZDogdGFyZ2V0Q2xpZW50SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWw6IGVtYmVkLm9yaWdpbmFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtUeXBlOiAnZW1iZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNZWRpYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtEYXRhLmlzTWVkaWEgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtEYXRhLm1lZGlhVHlwZSA9IHRoaXMuZ2V0TWVkaWFUeXBlKG5vcm1hbGl6ZWRQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIE1lZGlhIGZpbGUgZGV0ZWN0ZWQ6JywgbGlua0RhdGEubWVkaWFUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgYWxsTGlua3MucHVzaChsaW5rRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYWxsTGlua3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YS5saW5rcyA9IGFsbExpbmtzO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFRvdGFsIGxpbmtzIHRvIHN5bmM6JywgYWxsTGlua3MubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBMaW5rcyBkYXRhOicsIEpTT04uc3RyaW5naWZ5KGFsbExpbmtzLCBudWxsLCAyKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBObyBsaW5rcyBmb3VuZCBpbiB0aGlzIGRvY3VtZW50Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gXHU2M0QwXHU1M0Q2XHU2ODA3XHU3QjdFXG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlZE1ldGFkYXRhLnRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEudGFncyA9IGNhY2hlZE1ldGFkYXRhLnRhZ3MubWFwKHRhZyA9PiAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnOiB0YWcudGFnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHRhZy5wb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gXHU2M0QwXHU1M0Q2XHU2ODA3XHU5ODk4XG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlZE1ldGFkYXRhLmhlYWRpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLmhlYWRpbmdzID0gY2FjaGVkTWV0YWRhdGEuaGVhZGluZ3MubWFwKGhlYWRpbmcgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRpbmc6IGhlYWRpbmcuaGVhZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBoZWFkaW5nLmxldmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGhlYWRpbmcucG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFx1NjNEMFx1NTNENiBmcm9udG1hdHRlclxuICAgICAgICAgICAgICAgIGlmIChjYWNoZWRNZXRhZGF0YS5mcm9udG1hdHRlcikge1xuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YS5mcm9udG1hdHRlciA9IGNhY2hlZE1ldGFkYXRhLmZyb250bWF0dGVyO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gTWV0YWRhdGEgZXh0cmFjdGVkOicsIHtcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICBsaW5rc0NvdW50OiBtZXRhZGF0YS5saW5rcz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgIHRhZ3NDb3VudDogbWV0YWRhdGEudGFncz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRpbmdzQ291bnQ6IG1ldGFkYXRhLmhlYWRpbmdzPy5sZW5ndGggfHwgMCxcbiAgICAgICAgICAgICAgICAgICAgaGFzRnJvbnRtYXR0ZXI6ICEhbWV0YWRhdGEuZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU2NTg3XHU0RUY2XHU3RURGXHU4QkExXHU0RkUxXHU2MDZGXG4gICAgICAgICAgICBjb25zdCBzdGF0ID0gZmlsZS5zdGF0O1xuICAgICAgICAgICAgY29uc3QgaGFzaCA9IHRoaXMuaGFzaFN0cmluZyhjb250ZW50KTtcbiAgICAgICAgICAgIGNvbnN0IG10aW1lID0gbmV3IERhdGUoc3RhdC5tdGltZSkudG9JU09TdHJpbmcoKTtcblxuICAgICAgICAgICAgLy8gXHU3NTFGXHU2MjEwXHU1QkEyXHU2MjM3XHU3QUVGIElEXG4gICAgICAgICAgICBjb25zdCBjbGllbnRJZCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVDbGllbnRJZChmaWxlLnBhdGgpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEZpbGUgbWV0YWRhdGE6Jywge1xuICAgICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICBjbGllbnRJZDogY2xpZW50SWQsXG4gICAgICAgICAgICAgICAgaGFzaDogaGFzaCxcbiAgICAgICAgICAgICAgICBtdGltZTogbXRpbWUsXG4gICAgICAgICAgICAgICAgaGFzTWV0YWRhdGE6ICEhbWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgbGlua3NDb3VudDogbWV0YWRhdGEubGlua3M/Lmxlbmd0aCB8fCAwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gXHU1MUM2XHU1OTA3XHU1NDBDXHU2QjY1XHU2NTcwXHU2MzZFXG4gICAgICAgICAgICBjb25zdCBzeW5jRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgY2xpZW50SWQ6IGNsaWVudElkLFxuICAgICAgICAgICAgICAgIGNsaWVudFR5cGU6ICdvYnNpZGlhbicsXG4gICAgICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgICAgICBoYXNoOiBoYXNoLFxuICAgICAgICAgICAgICAgIG10aW1lOiBtdGltZSxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogbWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb25cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gU3luYyBkYXRhIHByZXBhcmVkOicpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSAtIFBhdGg6Jywgc3luY0RhdGEucGF0aCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIC0gQ2xpZW50SWQ6Jywgc3luY0RhdGEuY2xpZW50SWQpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSAtIEFjdGlvbjonLCBzeW5jRGF0YS5hY3Rpb24pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSAtIE1ldGFkYXRhOicsIEpTT04uc3RyaW5naWZ5KHN5bmNEYXRhLm1ldGFkYXRhLCBudWxsLCAyKSk7XG5cbiAgICAgICAgICAgIC8vIFx1OEMwM1x1NzUyOFx1NTQwQ1x1NkI2NVx1NTFGRFx1NjU3MFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zeW5jTWFuYWdlci5zeW5jKHN5bmNEYXRhKTtcblxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBcdTI3MTMgRmlsZSBzeW5jZWQgc3VjY2Vzc2Z1bGx5OicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgRmlsZSBzeW5jIGZhaWxlZDonLCBmaWxlLnBhdGgsIHJlc3VsdC5lcnJvcik7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHU1NDBDXHU2QjY1XHU1OTMxXHU4RDI1OiAke2ZpbGUucGF0aH1cXG4ke3Jlc3VsdC5lcnJvcn1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgRmlsZSBjaGFuZ2UgaGFuZGxlciBlcnJvcjonLCB7XG4gICAgICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGVycm9yU3RhY2s6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBcdTU0MENcdTZCNjVcdTk1MTlcdThCRUY6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBoYW5kbGVGaWxlRGVsZXRlKGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5hdXRvU3luYykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBBdXRvLXN5bmMgZGlzYWJsZWQsIHNraXBwaW5nIGRlbGV0ZTonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBGaWxlIGRlbGV0aW9uIGRldGVjdGVkOicsIHtcbiAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICAgIGV4dGVuc2lvbjogZmlsZS5leHRlbnNpb25cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFx1NzUxRlx1NjIxMFx1NUJBMlx1NjIzN1x1N0FFRiBJRFxuICAgICAgICAgICAgY29uc3QgY2xpZW50SWQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ2xpZW50SWQoZmlsZS5wYXRoKTtcblxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zeW5jTWFuYWdlci5zeW5jKHtcbiAgICAgICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgY2xpZW50SWQ6IGNsaWVudElkLFxuICAgICAgICAgICAgICAgIGNsaWVudFR5cGU6ICdvYnNpZGlhbicsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnZGVsZXRlJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gXHUyNzEzIEZpbGUgZGVsZXRpb24gc3luY2VkOicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgRmlsZSBkZWxldGlvbiBzeW5jIGZhaWxlZDonLCBmaWxlLnBhdGgsIHJlc3VsdC5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTWFya2Rvd25CcmFpbl0gXHUyNzE3IERlbGV0ZSBzeW5jIGV4Y2VwdGlvbjonLCB7XG4gICAgICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHN5bmNBbGxGaWxlcygpIHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIG5ldyBOb3RpY2UoYFx1NUYwMFx1NTlDQlx1NTQwQ1x1NkI2NSAke2ZpbGVzLmxlbmd0aH0gXHU0RTJBXHU2NTg3XHU0RUY2Li4uYCk7XG5cbiAgICAgICAgbGV0IHN1Y2Nlc3MgPSAwO1xuICAgICAgICBsZXQgZmFpbGVkID0gMDtcblxuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVGaWxlQ2hhbmdlKGZpbGUsICdtb2RpZnknKTtcbiAgICAgICAgICAgICAgICBzdWNjZXNzKys7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGZhaWxlZCsrO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBzeW5jICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBuZXcgTm90aWNlKGBcdTU0MENcdTZCNjVcdTVCOENcdTYyMTA6ICR7c3VjY2Vzc30gXHU2MjEwXHU1MjlGLCAke2ZhaWxlZH0gXHU1OTMxXHU4RDI1YCk7XG4gICAgfVxuXG4gICAgLy8gXHU3QjgwXHU1MzU1XHU3Njg0XHU1QjU3XHU3QjI2XHU0RTMyXHU1NEM4XHU1RTBDXHU1MUZEXHU2NTcwXG4gICAgaGFzaFN0cmluZyhzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBoYXNoID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSBzdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSArIGNoYXI7XG4gICAgICAgICAgICBoYXNoID0gaGFzaCAmIGhhc2g7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhc2gudG9TdHJpbmcoMTYpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVW5sb2FkaW5nIE1hcmtkb3duQnJhaW4gcGx1Z2luJyk7XG4gICAgICAgIC8vIFx1NkUwNVx1NzQwNlx1NjI0MFx1NjcwOVx1OTYzMlx1NjI5Nlx1NUI5QVx1NjVGNlx1NTY2OFxuICAgICAgICBmb3IgKGNvbnN0IHRpbWVyIG9mIHRoaXMuc3luY0RlYm91bmNlVGltZXJzLnZhbHVlcygpKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3luY0RlYm91bmNlVGltZXJzLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuc3luY01hbmFnZXIuZGVzdHJveSgpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICAvLyBcdTY2RjRcdTY1QjBcdTU0MENcdTZCNjVcdTdCQTFcdTc0MDZcdTU2NjhcdTkxNERcdTdGNkVcbiAgICAgICAgdGhpcy5zeW5jTWFuYWdlci51cGRhdGVDb25maWcoe1xuICAgICAgICAgICAgc2VydmVyVXJsOiB0aGlzLnNldHRpbmdzLnNlcnZlclVybCxcbiAgICAgICAgICAgIHN5bmNLZXk6IHRoaXMuc2V0dGluZ3Muc3luY0tleVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vIFx1OEJCRVx1N0Y2RVx1OTc2Mlx1Njc3RlxuY2xhc3MgTWFya2Rvd25CcmFpblNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IE1hcmtkb3duQnJhaW5QbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNYXJrZG93bkJyYWluUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdNYXJrZG93bkJyYWluIFx1NTQwQ1x1NkI2NVx1OEJCRVx1N0Y2RScgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnXHU2NzBEXHU1MkExXHU1NjY4XHU1NzMwXHU1NzQwJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNYXJrZG93bkJyYWluIFx1NjcwRFx1NTJBMVx1NTY2OCBBUEkgXHU1NzMwXHU1NzQwJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignaHR0cHM6Ly9hcGkubWFya2Rvd25icmFpbi5jb20nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXJ2ZXJVcmwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXJ2ZXJVcmwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1N5bmMgS2V5JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdTRFQ0VcdTdCQTFcdTc0MDZcdTU0MEVcdTUzRjBcdTgzQjdcdTUzRDZcdTc2ODRcdTU0MENcdTZCNjVcdTVCQzZcdTk0QTUnKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd4eHh4eHh4eC14eHh4LXh4eHgteHh4eC14eHh4eHh4eHh4eHgnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jS2V5KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3luY0tleSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gXHU2RDRCXHU4QkQ1XHU4RkRFXHU2M0E1XHU2MzA5XHU5NEFFXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1NkQ0Qlx1OEJENVx1OEZERVx1NjNBNScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU2RDRCXHU4QkQ1XHU0RTBFXHU2NzBEXHU1MkExXHU1NjY4XHU3Njg0XHU4RkRFXHU2M0E1XHVGRjA4MzBcdTc5RDJcdThEODVcdTY1RjZcdUZGMDknKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1NkQ0Qlx1OEJENScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdcdTZENEJcdThCRDVcdTRFMkQuLi4nKTtcblxuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdcdTZCNjNcdTU3MjhcdTZENEJcdThCRDVcdThGREVcdTYzQTUuLi4nKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5zeW5jTWFuYWdlci50ZXN0Q29ubmVjdGlvbigzMDAwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1x1NkQ0Qlx1OEJENScpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2VzcyAmJiByZXN1bHQudmF1bHRJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBcdTI3MDUgXHU4RkRFXHU2M0E1XHU2MjEwXHU1MjlGXHVGRjAxXFxuYCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFZhdWx0OiAke3Jlc3VsdC52YXVsdEluZm8ubmFtZX1cXG5gICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgRG9tYWluOiAke3Jlc3VsdC52YXVsdEluZm8uZG9tYWlufWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNTAwMFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc0QyBcdThGREVcdTYzQTVcdTU5MzFcdThEMjU6ICR7cmVzdWx0LmVycm9yIHx8ICdVbmtub3duIGVycm9yJ31gLCA1MDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTgxRUFcdTUyQThcdTU0MENcdTZCNjUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1NjU4N1x1NEVGNlx1NEZFRVx1NjUzOVx1NjVGNlx1ODFFQVx1NTJBOFx1NTQwQ1x1NkI2NVx1NTIzMFx1NjcwRFx1NTJBMVx1NTY2OCcpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1N5bmMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvU3luYyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBa0Y7QUFRbEYsSUFBTSxtQkFBMEM7QUFBQSxFQUM1QyxXQUFX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
