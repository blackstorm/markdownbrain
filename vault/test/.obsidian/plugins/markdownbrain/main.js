/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MarkdownBrainPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/core/client-id.ts
var import_obsidian = require("obsidian");
var CLIENT_ID_KEY = "markdownbrain-id";
async function getOrCreateClientId(file, content, app) {
  var _a;
  const cache = app.metadataCache.getFileCache(file);
  if ((_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[CLIENT_ID_KEY]) {
    return String(cache.frontmatter[CLIENT_ID_KEY]).trim();
  }
  const fileContent = await app.vault.read(file);
  const latestContent = fileContent || content;
  const frontmatterMatch = latestContent.match(/^---\n([\s\S]*?)\n---/);
  if (frontmatterMatch) {
    try {
      const frontmatter = (0, import_obsidian.parseYaml)(frontmatterMatch[1]);
      if (frontmatter == null ? void 0 : frontmatter[CLIENT_ID_KEY]) {
        return String(frontmatter[CLIENT_ID_KEY]).trim();
      }
    } catch (e) {
    }
  }
  const newId = crypto.randomUUID();
  await app.fileManager.processFrontMatter(file, (frontmatter) => {
    frontmatter[CLIENT_ID_KEY] = newId;
  });
  return newId;
}

// src/domain/types.ts
var DEFAULT_SETTINGS = {
  serverUrl: "https://api.markdownbrain.com",
  syncKey: "",
  autoSync: true
};

// src/utils/asset.ts
var ASSET_EXTENSIONS = /* @__PURE__ */ new Set([
  "png",
  "jpg",
  "jpeg",
  "gif",
  "webp",
  "svg",
  "bmp",
  "ico",
  "pdf",
  "mp3",
  "ogg",
  "wav",
  "mp4",
  "webm"
]);
function isAssetFile(file) {
  return ASSET_EXTENSIONS.has(file.extension.toLowerCase());
}

// src/utils/mime.ts
var MIME_TYPES = {
  // Images
  "png": "image/png",
  "jpg": "image/jpeg",
  "jpeg": "image/jpeg",
  "gif": "image/gif",
  "webp": "image/webp",
  "svg": "image/svg+xml",
  "bmp": "image/bmp",
  "ico": "image/x-icon",
  // Documents
  "pdf": "application/pdf",
  // Audio
  "mp3": "audio/mpeg",
  "ogg": "audio/ogg",
  "wav": "audio/wav",
  // Video
  "mp4": "video/mp4",
  "webm": "video/webm"
};
function getContentType(extension) {
  const ext = extension.toLowerCase();
  return MIME_TYPES[ext] || "application/octet-stream";
}

// src/utils/encoding.ts
async function arrayBufferToBase64(buffer) {
  const bytes = new Uint8Array(buffer);
  let binary = "";
  for (let i = 0; i < bytes.byteLength; i++) {
    binary += String.fromCharCode(bytes[i]);
  }
  return btoa(binary);
}

// src/utils/hash.ts
async function sha256Hash(buffer) {
  const hashBuffer = await crypto.subtle.digest("SHA-256", buffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map((b) => b.toString(16).padStart(2, "0")).join("");
}
async function hashString(str) {
  const encoder = new TextEncoder();
  const data = encoder.encode(str);
  return sha256Hash(data.buffer);
}

// src/api/sync-api.ts
var SyncApiClient = class {
  constructor(config, httpClient) {
    this.config = config;
    this.http = httpClient;
  }
  updateConfig(config) {
    this.config = config;
  }
  async testConnection(timeout = 3e4) {
    try {
      const response = await this.http.request({
        url: `${this.config.serverUrl}/obsidian/vault/info`,
        method: "GET",
        headers: {
          "Authorization": `Bearer ${this.config.syncKey}`
        }
      });
      if (response.status === 200) {
        const data = response.json;
        return {
          success: true,
          vaultInfo: data.vault
        };
      } else {
        return {
          success: false,
          error: `HTTP ${response.status}: ${response.text || "Unknown error"}`
        };
      }
    } catch (error) {
      if (error && typeof error === "object" && "name" in error && error.name === "AbortError") {
        return {
          success: false,
          error: `\u8FDE\u63A5\u8D85\u65F6\uFF08${timeout / 1e3}\u79D2\uFF09`
        };
      }
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  async syncNote(data) {
    var _a, _b;
    console.log("[MarkdownBrain] Starting sync:", {
      path: data.path,
      action: data.action,
      hasContent: !!data.content,
      contentLength: (_a = data.content) == null ? void 0 : _a.length,
      serverUrl: this.config.serverUrl,
      hasSyncKey: !!this.config.syncKey
    });
    try {
      const requestBody = JSON.stringify(data);
      console.log("[MarkdownBrain] Request body size:", requestBody.length, "bytes");
      const response = await this.http.request({
        url: `${this.config.serverUrl}/obsidian/sync`,
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${this.config.syncKey}`
        },
        body: requestBody
      });
      console.log("[MarkdownBrain] Response:", {
        status: response.status,
        bodyPreview: (_b = response.text) == null ? void 0 : _b.substring(0, 200)
      });
      if (response.status === 200) {
        console.log("[MarkdownBrain] \u2713 Sync successful:", data.path);
        return { success: true };
      } else {
        const errorMsg = `HTTP ${response.status}: ${response.text || "Sync failed"}`;
        console.error("[MarkdownBrain] \u2717 Sync failed:", {
          path: data.path,
          status: response.status,
          error: errorMsg,
          responseBody: response.text
        });
        return {
          success: false,
          error: errorMsg
        };
      }
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 Sync exception:", {
        path: data.path,
        error,
        errorMessage: error instanceof Error ? error.message : "Unknown error",
        errorStack: error instanceof Error ? error.stack : void 0
      });
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  async fullSync(clientIds) {
    console.log("[MarkdownBrain] Starting full sync...", {
      clientNoteCount: clientIds.length
    });
    try {
      const requestBody = { clientIds };
      const response = await this.http.request({
        url: `${this.config.serverUrl}/obsidian/sync/full`,
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${this.config.syncKey}`
        },
        body: JSON.stringify(requestBody)
      });
      if (response.status === 404) {
        console.warn("[MarkdownBrain] Full sync not supported by server (404), skipping orphan cleanup");
        return {
          success: true,
          data: {
            "vault-id": "",
            action: "full-sync",
            "client-notes": clientIds.length,
            "deleted-count": 0,
            "remaining-notes": clientIds.length
          }
        };
      }
      if (response.status === 200) {
        const data = response.json;
        console.log("[MarkdownBrain] \u2713 Full sync successful:", {
          deletedCount: data == null ? void 0 : data["deleted-count"],
          remainingNotes: data == null ? void 0 : data["remaining-notes"]
        });
        return {
          success: true,
          data
        };
      } else {
        const errorMsg = `HTTP ${response.status}: ${response.text || "Full sync failed"}`;
        console.error("[MarkdownBrain] \u2717 Full sync failed:", {
          status: response.status,
          error: errorMsg
        });
        return {
          success: false,
          error: errorMsg
        };
      }
    } catch (error) {
      const errorMsg = error instanceof Error ? error.message : "Unknown error";
      console.error("[MarkdownBrain] \u2717 Full sync exception:", {
        error: errorMsg
      });
      return {
        success: false,
        error: errorMsg
      };
    }
  }
  async syncAsset(data) {
    console.log("[MarkdownBrain] Starting asset sync:", {
      path: data.path,
      clientId: data.clientId,
      action: data.action,
      contentType: data.contentType,
      size: data.size
    });
    try {
      const response = await this.http.request({
        url: `${this.config.serverUrl}/obsidian/assets/sync`,
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${this.config.syncKey}`
        },
        body: JSON.stringify(data)
      });
      if (response.status === 200) {
        console.log("[MarkdownBrain] \u2713 Asset sync successful:", data.path);
        return { success: true };
      } else {
        const errorMsg = `HTTP ${response.status}: ${response.text || "Asset sync failed"}`;
        console.error("[MarkdownBrain] \u2717 Asset sync failed:", {
          path: data.path,
          status: response.status,
          error: errorMsg
        });
        return { success: false, error: errorMsg };
      }
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 Asset sync exception:", {
        path: data.path,
        error: error instanceof Error ? error.message : "Unknown error"
      });
      return {
        success: false,
        error: error instanceof Error ? error.message : "Unknown error"
      };
    }
  }
  destroy() {
  }
};

// src/api/obsidian-http-client.ts
var import_obsidian2 = require("obsidian");
var ObsidianHttpClient = class {
  async request(req) {
    const response = await (0, import_obsidian2.requestUrl)({
      url: req.url,
      method: req.method,
      headers: req.headers,
      body: req.body,
      throw: false
    });
    return {
      status: response.status,
      json: response.json,
      text: response.text
    };
  }
};

// src/services/debounce.ts
var defaultTimerFactory = {
  setTimeout: (callback, delay) => setTimeout(callback, delay),
  clearTimeout: (id) => clearTimeout(id)
};
var DebounceService = class {
  constructor(timerFactory = defaultTimerFactory) {
    this.timers = /* @__PURE__ */ new Map();
    this.timerFactory = timerFactory;
  }
  /**
   * Schedule a debounced callback for the given key
   * If a timer already exists for the key, it will be cancelled and replaced
   */
  debounce(key, callback, delay) {
    const existingTimer = this.timers.get(key);
    if (existingTimer !== void 0) {
      this.timerFactory.clearTimeout(existingTimer);
    }
    const timer = this.timerFactory.setTimeout(() => {
      this.timers.delete(key);
      callback();
    }, delay);
    this.timers.set(key, timer);
  }
  /**
   * Cancel a specific debounced operation by key
   */
  cancel(key) {
    const timer = this.timers.get(key);
    if (timer !== void 0) {
      this.timerFactory.clearTimeout(timer);
      this.timers.delete(key);
    }
  }
  /**
   * Clear all pending timers
   */
  clearAll() {
    for (const timer of this.timers.values()) {
      this.timerFactory.clearTimeout(timer);
    }
    this.timers.clear();
  }
  /**
   * Check if a key has a pending timer
   */
  has(key) {
    return this.timers.has(key);
  }
};

// src/services/client-id-cache.ts
var ClientIdCache = class {
  constructor() {
    this.cache = /* @__PURE__ */ new Map();
  }
  /**
   * Get client ID for a file path
   */
  get(path) {
    return this.cache.get(path);
  }
  /**
   * Set client ID for a file path
   */
  set(path, clientId) {
    this.cache.set(path, clientId);
  }
  /**
   * Check if a path has a cached client ID
   */
  has(path) {
    return this.cache.has(path);
  }
  /**
   * Remove client ID for a file path
   */
  delete(path) {
    this.cache.delete(path);
  }
  /**
   * Handle file rename - moves client ID from old path to new path
   */
  rename(oldPath, newPath) {
    const clientId = this.cache.get(oldPath);
    if (clientId !== void 0) {
      this.cache.delete(oldPath);
      this.cache.set(newPath, clientId);
    }
  }
  /**
   * Clear all cached entries
   */
  clear() {
    this.cache.clear();
  }
  /**
   * Get number of cached entries
   */
  get size() {
    return this.cache.size;
  }
  /**
   * Get all entries as array of [path, clientId] tuples
   */
  entries() {
    return Array.from(this.cache.entries());
  }
  /**
   * Get all client IDs
   */
  getAllClientIds() {
    return Array.from(this.cache.values());
  }
  /**
   * Build cache from entries (replaces existing cache)
   */
  buildFromEntries(entries) {
    this.cache.clear();
    for (const [path, clientId] of entries) {
      this.cache.set(path, clientId);
    }
  }
};

// src/services/metadata-extractor.ts
function extractNoteMetadata(cached) {
  if (!cached) {
    return {};
  }
  const metadata = {};
  if (cached.tags) {
    metadata.tags = cached.tags.map((tag) => ({
      tag: tag.tag,
      position: tag.position
    }));
  }
  if (cached.headings) {
    metadata.headings = cached.headings.map((heading) => ({
      heading: heading.heading,
      level: heading.level,
      position: heading.position
    }));
  }
  if (cached.frontmatter) {
    metadata.frontmatter = cached.frontmatter;
  }
  return metadata;
}

// src/plugin/settings-tab.ts
var import_obsidian3 = require("obsidian");
var MarkdownBrainSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "MarkdownBrain \u540C\u6B65\u8BBE\u7F6E" });
    new import_obsidian3.Setting(containerEl).setName("\u670D\u52A1\u5668\u5730\u5740").setDesc("MarkdownBrain \u670D\u52A1\u5668 API \u5730\u5740").addText((text) => text.setPlaceholder("https://api.markdownbrain.com").setValue(this.plugin.settings.serverUrl).onChange(async (value) => {
      this.plugin.settings.serverUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("Sync Key").setDesc("\u4ECE\u7BA1\u7406\u540E\u53F0\u83B7\u53D6\u7684\u540C\u6B65\u5BC6\u94A5").addText((text) => text.setPlaceholder("xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx").setValue(this.plugin.settings.syncKey).onChange(async (value) => {
      this.plugin.settings.syncKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("\u6D4B\u8BD5\u8FDE\u63A5").setDesc("\u6D4B\u8BD5\u4E0E\u670D\u52A1\u5668\u7684\u8FDE\u63A5\uFF0830\u79D2\u8D85\u65F6\uFF09").addButton((button) => button.setButtonText("\u6D4B\u8BD5").onClick(async () => {
      button.setDisabled(true);
      button.setButtonText("\u6D4B\u8BD5\u4E2D...");
      new import_obsidian3.Notice("\u6B63\u5728\u6D4B\u8BD5\u8FDE\u63A5...");
      const result = await this.plugin.syncManager.testConnection(3e4);
      button.setDisabled(false);
      button.setButtonText("\u6D4B\u8BD5");
      if (result.success && result.vaultInfo) {
        new import_obsidian3.Notice(
          `\u2705 \u8FDE\u63A5\u6210\u529F\uFF01
Vault: ${result.vaultInfo.name}
Domain: ${result.vaultInfo.domain}`,
          5e3
        );
      } else {
        new import_obsidian3.Notice(`\u274C \u8FDE\u63A5\u5931\u8D25: ${result.error || "Unknown error"}`, 5e3);
      }
    }));
    new import_obsidian3.Setting(containerEl).setName("\u6279\u91CF\u540C\u6B65").setDesc("\u624B\u52A8\u540C\u6B65\u6240\u6709 Markdown \u6587\u4EF6\u5230\u670D\u52A1\u5668").addButton((button) => button.setButtonText("\u5F00\u59CB\u540C\u6B65").onClick(async () => {
      button.setDisabled(true);
      button.setButtonText("\u540C\u6B65\u4E2D...");
      await this.plugin.syncAllFiles();
      button.setDisabled(false);
      button.setButtonText("\u5F00\u59CB\u540C\u6B65");
    }));
    new import_obsidian3.Setting(containerEl).setName("\u81EA\u52A8\u540C\u6B65").setDesc("\u6587\u4EF6\u4FEE\u6539\u65F6\u81EA\u52A8\u540C\u6B65\u5230\u670D\u52A1\u5668").addToggle((toggle) => toggle.setValue(this.plugin.settings.autoSync).onChange(async (value) => {
      this.plugin.settings.autoSync = value;
      await this.plugin.saveSettings();
    }));
  }
};

// src/plugin/events.ts
var import_obsidian4 = require("obsidian");
function registerFileEvents(app, handlers, pendingSyncs, registerEvent) {
  registerEvent(
    app.vault.on("create", (file) => {
      if (file instanceof import_obsidian4.TFile) {
        if (file.extension === "md") {
          handlers.onFileChange(file, "create");
        } else if (isAssetFile(file)) {
          handlers.onAssetChange(file, "create");
        }
      }
    })
  );
  registerEvent(
    app.vault.on("modify", (file) => {
      if (file instanceof import_obsidian4.TFile) {
        if (file.extension === "md") {
          pendingSyncs.add(file.path);
        } else if (isAssetFile(file)) {
          handlers.onAssetChange(file, "modify");
        }
      }
    })
  );
  registerEvent(
    app.metadataCache.on("resolved", () => {
      pendingSyncs.forEach((filePath) => {
        const file = app.vault.getAbstractFileByPath(filePath);
        if (file instanceof import_obsidian4.TFile) {
          handlers.onFileChange(file, "modify");
        }
      });
      pendingSyncs.clear();
      handlers.onMetadataResolved();
    })
  );
  registerEvent(
    app.vault.on("delete", (file) => {
      if (file instanceof import_obsidian4.TFile) {
        if (file.extension === "md") {
          handlers.onFileDelete(file);
        } else if (isAssetFile(file)) {
          handlers.onAssetDelete(file);
        }
      }
    })
  );
  registerEvent(
    app.vault.on("rename", (file, oldPath) => {
      if (file instanceof import_obsidian4.TFile) {
        if (file.extension === "md") {
          handlers.onFileRename(file, oldPath);
        } else if (isAssetFile(file)) {
          handlers.onAssetRename(file, oldPath);
        }
      }
    })
  );
}

// src/main.ts
var MarkdownBrainPlugin = class extends import_obsidian5.Plugin {
  constructor(app, manifest) {
    super(app, manifest);
    this.debounceService = new DebounceService();
    this.pendingSyncs = /* @__PURE__ */ new Set();
    this.clientIdCache = new ClientIdCache();
    this.assetClientIdCache = new ClientIdCache();
  }
  async onload() {
    var _a;
    console.log("[MarkdownBrain] ========================================");
    console.log("[MarkdownBrain] Plugin loading...");
    await this.loadSettings();
    console.log("[MarkdownBrain] Settings loaded:", {
      serverUrl: this.settings.serverUrl,
      hasSyncKey: !!this.settings.syncKey,
      syncKeyLength: (_a = this.settings.syncKey) == null ? void 0 : _a.length,
      autoSync: this.settings.autoSync
    });
    const httpClient = new ObsidianHttpClient();
    this.syncManager = new SyncApiClient({
      serverUrl: this.settings.serverUrl,
      syncKey: this.settings.syncKey
    }, httpClient);
    console.log("[MarkdownBrain] SyncManager initialized");
    registerFileEvents(
      this.app,
      {
        onFileChange: (file, action) => this.handleFileChange(file, action),
        onFileDelete: (file) => this.handleFileDelete(file),
        onFileRename: (file, oldPath) => this.handleFileRename(file, oldPath),
        onAssetChange: (file, action) => this.handleAssetChange(file, action),
        onAssetDelete: (file) => this.handleAssetDelete(file),
        onAssetRename: (file, oldPath) => this.handleAssetRename(file, oldPath),
        onMetadataResolved: () => {
        }
      },
      {
        add: (path) => this.pendingSyncs.add(path),
        clear: () => this.pendingSyncs.clear(),
        forEach: (cb) => this.pendingSyncs.forEach(cb)
      },
      (event) => this.registerEvent(event)
    );
    console.log("[MarkdownBrain] File events registered");
    this.addSettingTab(new MarkdownBrainSettingTab(this.app, this));
    console.log("[MarkdownBrain] Settings tab added");
    this.addCommand({
      id: "sync-current-file",
      name: "Sync current file",
      callback: () => {
        const file = this.app.workspace.getActiveFile();
        if (file) {
          this.handleFileChange(file, "modify");
        }
      }
    });
    this.addCommand({
      id: "sync-all-files",
      name: "Sync all files",
      callback: () => {
        this.syncAllFiles();
      }
    });
    console.log("[MarkdownBrain] Commands registered");
    await this.buildClientIdCache();
    console.log("[MarkdownBrain] \u2713 Plugin loaded successfully");
    console.log("[MarkdownBrain] ========================================");
  }
  async buildClientIdCache() {
    var _a;
    const files = this.app.vault.getMarkdownFiles();
    let cached = 0;
    for (const file of files) {
      const cache = this.app.metadataCache.getFileCache(file);
      const clientId = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[CLIENT_ID_KEY];
      if (clientId) {
        this.clientIdCache.set(file.path, String(clientId).trim());
        cached++;
      }
    }
    console.log(`[MarkdownBrain] ClientId cache built: ${cached}/${files.length} files`);
  }
  async handleFileChange(file, action) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping:", file.path);
      return;
    }
    this.debounceService.debounce(file.path, async () => {
      await this.performSync(file, action);
    }, 300);
  }
  async performSync(file, action) {
    var _a, _b;
    console.log("[MarkdownBrain] File change detected:", {
      path: file.path,
      action,
      extension: file.extension,
      size: file.stat.size
    });
    try {
      const content = await this.app.vault.read(file);
      console.log("[MarkdownBrain] File read successfully:", {
        path: file.path,
        contentLength: content.length
      });
      const cachedMetadata = this.app.metadataCache.getFileCache(file);
      const metadata = extractNoteMetadata(cachedMetadata);
      console.log("[MarkdownBrain] Metadata extracted:", {
        path: file.path,
        tagsCount: ((_a = metadata.tags) == null ? void 0 : _a.length) || 0,
        headingsCount: ((_b = metadata.headings) == null ? void 0 : _b.length) || 0,
        hasFrontmatter: !!metadata.frontmatter
      });
      const stat = file.stat;
      const hash = await hashString(content);
      const mtime = new Date(stat.mtime).toISOString();
      const clientId = await getOrCreateClientId(file, content, this.app);
      console.log("[MarkdownBrain] File metadata:", {
        path: file.path,
        clientId,
        hash,
        mtime
      });
      const syncData = {
        path: file.path,
        clientId,
        clientType: "obsidian",
        content,
        hash,
        mtime,
        metadata,
        action
      };
      const result = await this.syncManager.syncNote(syncData);
      if (result.success) {
        this.clientIdCache.set(file.path, clientId);
        console.log("[MarkdownBrain] \u2713 File synced successfully:", file.path);
      } else {
        console.error("[MarkdownBrain] \u2717 File sync failed:", file.path, result.error);
        new import_obsidian5.Notice(`\u540C\u6B65\u5931\u8D25: ${file.path}
${result.error}`);
      }
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 File change handler error:", {
        path: file.path,
        error,
        errorMessage: error instanceof Error ? error.message : "Unknown error",
        errorStack: error instanceof Error ? error.stack : void 0
      });
      new import_obsidian5.Notice(`\u540C\u6B65\u9519\u8BEF: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  async handleFileDelete(file) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping delete:", file.path);
      return;
    }
    console.log("[MarkdownBrain] File deletion detected:", {
      path: file.path,
      extension: file.extension
    });
    const clientId = this.clientIdCache.get(file.path);
    if (!clientId) {
      console.warn("[MarkdownBrain] Cannot sync deletion - clientId not in cache:", file.path);
      return;
    }
    const result = await this.syncManager.syncNote({
      path: file.path,
      clientId,
      clientType: "obsidian",
      action: "delete"
    });
    if (result.success) {
      this.clientIdCache.delete(file.path);
      console.log("[MarkdownBrain] \u2713 File deletion synced:", file.path);
    } else {
      console.error("[MarkdownBrain] \u2717 File deletion sync failed:", file.path, result.error);
    }
  }
  async handleFileRename(file, oldPath) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping rename:", oldPath, "->", file.path);
      return;
    }
    console.log("[MarkdownBrain] File rename detected:", {
      oldPath,
      newPath: file.path,
      extension: file.extension
    });
    this.clientIdCache.rename(oldPath, file.path);
    try {
      console.log("[MarkdownBrain] Syncing rename with frontmatter UUID");
      await this.performSync(file, "modify");
      console.log("[MarkdownBrain] \u2713 File rename synced:", oldPath, "->", file.path);
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 Rename sync exception:", {
        oldPath,
        newPath: file.path,
        error,
        errorMessage: error instanceof Error ? error.message : "Unknown error"
      });
      new import_obsidian5.Notice(`\u91CD\u547D\u540D\u540C\u6B65\u9519\u8BEF: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  async handleAssetChange(file, action) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping asset:", file.path);
      return;
    }
    this.debounceService.debounce(file.path, async () => {
      await this.performAssetSync(file, action);
    }, 500);
  }
  async performAssetSync(file, action) {
    var _a;
    console.log("[MarkdownBrain] Asset change detected:", {
      path: file.path,
      action,
      extension: file.extension,
      size: file.stat.size
    });
    try {
      const buffer = await this.app.vault.readBinary(file);
      const content = await arrayBufferToBase64(buffer);
      const sha256 = await sha256Hash(buffer);
      const clientId = (_a = this.assetClientIdCache.get(file.path)) != null ? _a : crypto.randomUUID();
      const syncData = {
        path: file.path,
        clientId,
        content,
        contentType: getContentType(file.extension),
        sha256,
        size: buffer.byteLength,
        action
      };
      const result = await this.syncManager.syncAsset(syncData);
      if (result.success) {
        this.assetClientIdCache.set(file.path, clientId);
        console.log("[MarkdownBrain] \u2713 Asset synced successfully:", file.path);
      } else {
        console.error("[MarkdownBrain] \u2717 Asset sync failed:", file.path, result.error);
        new import_obsidian5.Notice(`\u8D44\u6E90\u540C\u6B65\u5931\u8D25: ${file.path}
${result.error}`);
      }
    } catch (error) {
      console.error("[MarkdownBrain] \u2717 Asset sync exception:", {
        path: file.path,
        error: error instanceof Error ? error.message : "Unknown error"
      });
      new import_obsidian5.Notice(`\u8D44\u6E90\u540C\u6B65\u9519\u8BEF: ${error instanceof Error ? error.message : "Unknown error"}`);
    }
  }
  async handleAssetDelete(file) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping asset delete:", file.path);
      return;
    }
    console.log("[MarkdownBrain] Asset deletion detected:", file.path);
    const clientId = this.assetClientIdCache.get(file.path);
    if (!clientId) {
      console.warn("[MarkdownBrain] Cannot sync asset deletion - clientId not in cache:", file.path);
      return;
    }
    const result = await this.syncManager.syncAsset({
      path: file.path,
      clientId,
      contentType: getContentType(file.extension),
      action: "delete"
    });
    if (result.success) {
      this.assetClientIdCache.delete(file.path);
      console.log("[MarkdownBrain] \u2713 Asset deletion synced:", file.path);
    } else {
      console.error("[MarkdownBrain] \u2717 Asset deletion sync failed:", file.path, result.error);
    }
  }
  async handleAssetRename(file, oldPath) {
    if (!this.settings.autoSync) {
      console.log("[MarkdownBrain] Auto-sync disabled, skipping asset rename:", oldPath, "->", file.path);
      return;
    }
    console.log("[MarkdownBrain] Asset rename detected:", oldPath, "->", file.path);
    this.assetClientIdCache.rename(oldPath, file.path);
    await this.performAssetSync(file, "modify");
  }
  /**
   * 全量同步所有文件
   * @flow 收集 IDs → 清理孤儿 → 增量同步 Markdown → 同步资源
   * @complexity O(n) where n = 文件数量
   */
  async syncAllFiles() {
    const markdownFiles = this.app.vault.getMarkdownFiles();
    const assetFiles = this.app.vault.getFiles().filter((f) => isAssetFile(f));
    const totalFiles = markdownFiles.length + assetFiles.length;
    console.log(`[MarkdownBrain] Starting full sync for ${markdownFiles.length} markdown + ${assetFiles.length} assets = ${totalFiles} files`);
    new import_obsidian5.Notice(`\u5F00\u59CB\u5168\u91CF\u540C\u6B65 ${totalFiles} \u4E2A\u6587\u4EF6 (${markdownFiles.length} \u7B14\u8BB0, ${assetFiles.length} \u8D44\u6E90)...`);
    const clientIds = await this.collectClientIds(markdownFiles);
    console.log(`[MarkdownBrain] Collected ${clientIds.length} client IDs`);
    await this.cleanupOrphans(clientIds);
    await this.incrementalSyncBatch(markdownFiles);
    await this.syncAssetBatch(assetFiles);
  }
  /**
   * 收集所有文件的 client_ids
   * @complexity O(n) time, O(n) space
   */
  async collectClientIds(files) {
    const ids = [];
    for (const file of files) {
      try {
        const content = await this.app.vault.read(file);
        if ((content == null ? void 0 : content.trim().length) > 0) {
          ids.push(await getOrCreateClientId(file, content, this.app));
        }
      } catch (error) {
        console.error(`[MarkdownBrain] Failed to read ${file.path}:`, error);
      }
    }
    return ids;
  }
  /**
   * 清理孤儿笔记
   * @complexity O(1) - 单次网络请求
   */
  async cleanupOrphans(clientIds) {
    var _a;
    try {
      const result = await this.syncManager.fullSync(clientIds);
      const deleted = ((_a = result.data) == null ? void 0 : _a["deleted-count"]) || 0;
      if (deleted > 0) {
        console.log(`[MarkdownBrain] \u2713 Cleaned ${deleted} orphan notes`);
        new import_obsidian5.Notice(`\u6E05\u7406\u4E86 ${deleted} \u4E2A\u5B64\u513F\u7B14\u8BB0`);
      } else if (result.success) {
        console.log("[MarkdownBrain] \u2713 No orphan notes found");
      }
    } catch (error) {
      console.error("[MarkdownBrain] Full sync error:", error);
    }
  }
  /**
   * 批量增量同步
   * @complexity O(n) with batching
   */
  async incrementalSyncBatch(files) {
    const stats = { success: 0, failed: 0, skipped: 0 };
    const batchSize = 10;
    for (let i = 0; i < files.length; i += batchSize) {
      const batch = files.slice(i, i + batchSize);
      await Promise.all(batch.map((file) => this.syncOneFile(file, stats)));
      const progress = Math.min(i + batchSize, files.length);
      new import_obsidian5.Notice(`\u540C\u6B65\u8FDB\u5EA6: ${progress}/${files.length} (\u6210\u529F: ${stats.success}, \u5931\u8D25: ${stats.failed}, \u8DF3\u8FC7: ${stats.skipped})`);
    }
    const finalMsg = `\u7B14\u8BB0\u540C\u6B65\u5B8C\u6210! \u603B\u8BA1: ${files.length}, \u6210\u529F: ${stats.success}, \u5931\u8D25: ${stats.failed}, \u8DF3\u8FC7: ${stats.skipped}`;
    console.log(`[MarkdownBrain] ${finalMsg}`);
    new import_obsidian5.Notice(finalMsg, 5e3);
  }
  async syncAssetBatch(files) {
    if (files.length === 0) {
      console.log("[MarkdownBrain] No asset files to sync");
      return;
    }
    const stats = { success: 0, failed: 0, skipped: 0 };
    const batchSize = 5;
    for (let i = 0; i < files.length; i += batchSize) {
      const batch = files.slice(i, i + batchSize);
      await Promise.all(batch.map((file) => this.syncOneAsset(file, stats)));
      const progress = Math.min(i + batchSize, files.length);
      new import_obsidian5.Notice(`\u8D44\u6E90\u540C\u6B65\u8FDB\u5EA6: ${progress}/${files.length} (\u6210\u529F: ${stats.success}, \u5931\u8D25: ${stats.failed})`);
    }
    const finalMsg = `\u8D44\u6E90\u540C\u6B65\u5B8C\u6210! \u603B\u8BA1: ${files.length}, \u6210\u529F: ${stats.success}, \u5931\u8D25: ${stats.failed}`;
    console.log(`[MarkdownBrain] ${finalMsg}`);
    new import_obsidian5.Notice(finalMsg, 5e3);
  }
  async syncOneAsset(file, stats) {
    try {
      await this.performAssetSync(file, "create");
      stats.success++;
    } catch (error) {
      stats.failed++;
      console.error(`[MarkdownBrain] \u2717 Failed to sync asset ${file.path}:`, error);
    }
  }
  /**
   * 同步单个文件
   */
  async syncOneFile(file, stats) {
    try {
      await this.performSync(file, "modify");
      stats.success++;
    } catch (error) {
      stats.failed++;
      console.error(`[MarkdownBrain] \u2717 Failed to sync ${file.path}:`, error);
    }
  }
  onunload() {
    console.log("Unloading MarkdownBrain plugin");
    this.debounceService.clearAll();
    this.syncManager.destroy();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.syncManager.updateConfig({
      serverUrl: this.settings.serverUrl,
      syncKey: this.settings.syncKey
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy9tYWluLnRzIiwgIi4uLy4uLy4uLy4uLy4uL29ic2lkaWFuLXBsdWdpbi9zcmMvY29yZS9jbGllbnQtaWQudHMiLCAiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy9kb21haW4vdHlwZXMudHMiLCAiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy91dGlscy9hc3NldC50cyIsICIuLi8uLi8uLi8uLi8uLi9vYnNpZGlhbi1wbHVnaW4vc3JjL3V0aWxzL21pbWUudHMiLCAiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy91dGlscy9lbmNvZGluZy50cyIsICIuLi8uLi8uLi8uLi8uLi9vYnNpZGlhbi1wbHVnaW4vc3JjL3V0aWxzL2hhc2gudHMiLCAiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy9hcGkvc3luYy1hcGkudHMiLCAiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy9hcGkvb2JzaWRpYW4taHR0cC1jbGllbnQudHMiLCAiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy9zZXJ2aWNlcy9kZWJvdW5jZS50cyIsICIuLi8uLi8uLi8uLi8uLi9vYnNpZGlhbi1wbHVnaW4vc3JjL3NlcnZpY2VzL2NsaWVudC1pZC1jYWNoZS50cyIsICIuLi8uLi8uLi8uLi8uLi9vYnNpZGlhbi1wbHVnaW4vc3JjL3NlcnZpY2VzL21ldGFkYXRhLWV4dHJhY3Rvci50cyIsICIuLi8uLi8uLi8uLi8uLi9vYnNpZGlhbi1wbHVnaW4vc3JjL3BsdWdpbi9zZXR0aW5ncy10YWIudHMiLCAiLi4vLi4vLi4vLi4vLi4vb2JzaWRpYW4tcGx1Z2luL3NyYy9wbHVnaW4vZXZlbnRzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5NYW5pZmVzdCwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDTElFTlRfSURfS0VZLCBnZXRPckNyZWF0ZUNsaWVudElkIH0gZnJvbSAnLi9jb3JlL2NsaWVudC1pZCc7XG5pbXBvcnQge1xuICAgIE1hcmtkb3duQnJhaW5TZXR0aW5ncyxcbiAgICBERUZBVUxUX1NFVFRJTkdTLFxuICAgIFN5bmNTdGF0cyxcbiAgICBBc3NldFN5bmNEYXRhLFxufSBmcm9tICcuL2RvbWFpbi90eXBlcyc7XG5pbXBvcnQgeyBpc0Fzc2V0RmlsZSwgZ2V0Q29udGVudFR5cGUsIGFycmF5QnVmZmVyVG9CYXNlNjQsIHNoYTI1Nkhhc2gsIGhhc2hTdHJpbmcgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IFN5bmNBcGlDbGllbnQsIE9ic2lkaWFuSHR0cENsaWVudCB9IGZyb20gJy4vYXBpJztcbmltcG9ydCB7IERlYm91bmNlU2VydmljZSwgQ2xpZW50SWRDYWNoZSwgZXh0cmFjdE5vdGVNZXRhZGF0YSB9IGZyb20gJy4vc2VydmljZXMnO1xuaW1wb3J0IHsgTWFya2Rvd25CcmFpblNldHRpbmdUYWIsIHJlZ2lzdGVyRmlsZUV2ZW50cyB9IGZyb20gJy4vcGx1Z2luJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFya2Rvd25CcmFpblBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3MhOiBNYXJrZG93bkJyYWluU2V0dGluZ3M7XG4gICAgc3luY01hbmFnZXIhOiBTeW5jQXBpQ2xpZW50O1xuICAgIHByaXZhdGUgZGVib3VuY2VTZXJ2aWNlOiBEZWJvdW5jZVNlcnZpY2U7XG4gICAgcHJpdmF0ZSBwZW5kaW5nU3luY3M6IFNldDxzdHJpbmc+O1xuICAgIHByaXZhdGUgY2xpZW50SWRDYWNoZTogQ2xpZW50SWRDYWNoZTtcbiAgICBwcml2YXRlIGFzc2V0Q2xpZW50SWRDYWNoZTogQ2xpZW50SWRDYWNoZTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBtYW5pZmVzdDogUGx1Z2luTWFuaWZlc3QpIHtcbiAgICAgICAgc3VwZXIoYXBwLCBtYW5pZmVzdCk7XG4gICAgICAgIHRoaXMuZGVib3VuY2VTZXJ2aWNlID0gbmV3IERlYm91bmNlU2VydmljZSgpO1xuICAgICAgICB0aGlzLnBlbmRpbmdTeW5jcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5jbGllbnRJZENhY2hlID0gbmV3IENsaWVudElkQ2FjaGUoKTtcbiAgICAgICAgdGhpcy5hc3NldENsaWVudElkQ2FjaGUgPSBuZXcgQ2xpZW50SWRDYWNoZSgpO1xuICAgIH1cblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gUGx1Z2luIGxvYWRpbmcuLi4nKTtcblxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gU2V0dGluZ3MgbG9hZGVkOicsIHtcbiAgICAgICAgICAgIHNlcnZlclVybDogdGhpcy5zZXR0aW5ncy5zZXJ2ZXJVcmwsXG4gICAgICAgICAgICBoYXNTeW5jS2V5OiAhIXRoaXMuc2V0dGluZ3Muc3luY0tleSxcbiAgICAgICAgICAgIHN5bmNLZXlMZW5ndGg6IHRoaXMuc2V0dGluZ3Muc3luY0tleT8ubGVuZ3RoLFxuICAgICAgICAgICAgYXV0b1N5bmM6IHRoaXMuc2V0dGluZ3MuYXV0b1N5bmNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gXHU1MjFEXHU1OUNCXHU1MzE2XHU1NDBDXHU2QjY1XHU3QkExXHU3NDA2XHU1NjY4XG4gICAgICAgIGNvbnN0IGh0dHBDbGllbnQgPSBuZXcgT2JzaWRpYW5IdHRwQ2xpZW50KCk7XG4gICAgICAgIHRoaXMuc3luY01hbmFnZXIgPSBuZXcgU3luY0FwaUNsaWVudCh7XG4gICAgICAgICAgICBzZXJ2ZXJVcmw6IHRoaXMuc2V0dGluZ3Muc2VydmVyVXJsLFxuICAgICAgICAgICAgc3luY0tleTogdGhpcy5zZXR0aW5ncy5zeW5jS2V5XG4gICAgICAgIH0sIGh0dHBDbGllbnQpO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFN5bmNNYW5hZ2VyIGluaXRpYWxpemVkJyk7XG5cbiAgICAgICAgcmVnaXN0ZXJGaWxlRXZlbnRzKFxuICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgb25GaWxlQ2hhbmdlOiAoZmlsZSwgYWN0aW9uKSA9PiB0aGlzLmhhbmRsZUZpbGVDaGFuZ2UoZmlsZSwgYWN0aW9uKSxcbiAgICAgICAgICAgICAgICBvbkZpbGVEZWxldGU6IChmaWxlKSA9PiB0aGlzLmhhbmRsZUZpbGVEZWxldGUoZmlsZSksXG4gICAgICAgICAgICAgICAgb25GaWxlUmVuYW1lOiAoZmlsZSwgb2xkUGF0aCkgPT4gdGhpcy5oYW5kbGVGaWxlUmVuYW1lKGZpbGUsIG9sZFBhdGgpLFxuICAgICAgICAgICAgICAgIG9uQXNzZXRDaGFuZ2U6IChmaWxlLCBhY3Rpb24pID0+IHRoaXMuaGFuZGxlQXNzZXRDaGFuZ2UoZmlsZSwgYWN0aW9uKSxcbiAgICAgICAgICAgICAgICBvbkFzc2V0RGVsZXRlOiAoZmlsZSkgPT4gdGhpcy5oYW5kbGVBc3NldERlbGV0ZShmaWxlKSxcbiAgICAgICAgICAgICAgICBvbkFzc2V0UmVuYW1lOiAoZmlsZSwgb2xkUGF0aCkgPT4gdGhpcy5oYW5kbGVBc3NldFJlbmFtZShmaWxlLCBvbGRQYXRoKSxcbiAgICAgICAgICAgICAgICBvbk1ldGFkYXRhUmVzb2x2ZWQ6ICgpID0+IHt9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhZGQ6IChwYXRoKSA9PiB0aGlzLnBlbmRpbmdTeW5jcy5hZGQocGF0aCksXG4gICAgICAgICAgICAgICAgY2xlYXI6ICgpID0+IHRoaXMucGVuZGluZ1N5bmNzLmNsZWFyKCksXG4gICAgICAgICAgICAgICAgZm9yRWFjaDogKGNiKSA9PiB0aGlzLnBlbmRpbmdTeW5jcy5mb3JFYWNoKGNiKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoZXZlbnQpID0+IHRoaXMucmVnaXN0ZXJFdmVudChldmVudClcbiAgICAgICAgKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBGaWxlIGV2ZW50cyByZWdpc3RlcmVkJyk7XG5cbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU4QkJFXHU3RjZFXHU5NzYyXHU2NzdGXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTWFya2Rvd25CcmFpblNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBTZXR0aW5ncyB0YWIgYWRkZWQnKTtcblxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTU0N0RcdTRFRTRcdUZGMUFcdTYyNEJcdTUyQThcdTU0MENcdTZCNjVcdTVGNTNcdTUyNERcdTY1ODdcdTRFRjZcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc3luYy1jdXJyZW50LWZpbGUnLFxuICAgICAgICAgICAgbmFtZTogJ1N5bmMgY3VycmVudCBmaWxlJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVGaWxlQ2hhbmdlKGZpbGUsICdtb2RpZnknKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NTQ3RFx1NEVFNFx1RkYxQVx1NTQwQ1x1NkI2NVx1NjI0MFx1NjcwOVx1NjU4N1x1NEVGNlxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzeW5jLWFsbC1maWxlcycsXG4gICAgICAgICAgICBuYW1lOiAnU3luYyBhbGwgZmlsZXMnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN5bmNBbGxGaWxlcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBDb21tYW5kcyByZWdpc3RlcmVkJyk7XG5cbiAgICAgICAgYXdhaXQgdGhpcy5idWlsZENsaWVudElkQ2FjaGUoKTtcblxuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFx1MjcxMyBQbHVnaW4gbG9hZGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGJ1aWxkQ2xpZW50SWRDYWNoZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIGxldCBjYWNoZWQgPSAwO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgICAgY29uc3QgY2xpZW50SWQgPSBjYWNoZT8uZnJvbnRtYXR0ZXI/LltDTElFTlRfSURfS0VZXTtcbiAgICAgICAgICAgIGlmIChjbGllbnRJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50SWRDYWNoZS5zZXQoZmlsZS5wYXRoLCBTdHJpbmcoY2xpZW50SWQpLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgY2FjaGVkKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGBbTWFya2Rvd25CcmFpbl0gQ2xpZW50SWQgY2FjaGUgYnVpbHQ6ICR7Y2FjaGVkfS8ke2ZpbGVzLmxlbmd0aH0gZmlsZXNgKTtcbiAgICB9XG5cbiAgICBhc3luYyBoYW5kbGVGaWxlQ2hhbmdlKGZpbGU6IFRGaWxlLCBhY3Rpb246ICdjcmVhdGUnIHwgJ21vZGlmeScpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmF1dG9TeW5jKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEF1dG8tc3luYyBkaXNhYmxlZCwgc2tpcHBpbmc6JywgZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFx1NEY3Rlx1NzUyOFx1OTYzMlx1NjI5Nlx1OTA3Rlx1NTE0RFx1NUZFQlx1OTAxRlx1OEZERVx1N0VFRFx1NzY4NFx1NTQwQ1x1NkI2NVxuICAgICAgICB0aGlzLmRlYm91bmNlU2VydmljZS5kZWJvdW5jZShmaWxlLnBhdGgsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGVyZm9ybVN5bmMoZmlsZSwgYWN0aW9uKTtcbiAgICAgICAgfSwgMzAwKTtcbiAgICB9XG5cbiAgICBhc3luYyBwZXJmb3JtU3luYyhmaWxlOiBURmlsZSwgYWN0aW9uOiAnY3JlYXRlJyB8ICdtb2RpZnknKSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBGaWxlIGNoYW5nZSBkZXRlY3RlZDonLCB7XG4gICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgIGV4dGVuc2lvbjogZmlsZS5leHRlbnNpb24sXG4gICAgICAgICAgICBzaXplOiBmaWxlLnN0YXQuc2l6ZVxuICAgICAgICB9KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEZpbGUgcmVhZCBzdWNjZXNzZnVsbHk6Jywge1xuICAgICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICBjb250ZW50TGVuZ3RoOiBjb250ZW50Lmxlbmd0aFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZE1ldGFkYXRhID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IGV4dHJhY3ROb3RlTWV0YWRhdGEoY2FjaGVkTWV0YWRhdGEpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIE1ldGFkYXRhIGV4dHJhY3RlZDonLCB7XG4gICAgICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIHRhZ3NDb3VudDogbWV0YWRhdGEudGFncz8ubGVuZ3RoIHx8IDAsXG4gICAgICAgICAgICAgICAgaGVhZGluZ3NDb3VudDogbWV0YWRhdGEuaGVhZGluZ3M/Lmxlbmd0aCB8fCAwLFxuICAgICAgICAgICAgICAgIGhhc0Zyb250bWF0dGVyOiAhIW1ldGFkYXRhLmZyb250bWF0dGVyXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3Qgc3RhdCA9IGZpbGUuc3RhdDtcbiAgICAgICAgICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBoYXNoU3RyaW5nKGNvbnRlbnQpO1xuICAgICAgICAgICAgY29uc3QgbXRpbWUgPSBuZXcgRGF0ZShzdGF0Lm10aW1lKS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgY29uc3QgY2xpZW50SWQgPSBhd2FpdCBnZXRPckNyZWF0ZUNsaWVudElkKGZpbGUsIGNvbnRlbnQsIHRoaXMuYXBwKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBGaWxlIG1ldGFkYXRhOicsIHtcbiAgICAgICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgY2xpZW50SWQ6IGNsaWVudElkLFxuICAgICAgICAgICAgICAgIGhhc2g6IGhhc2gsXG4gICAgICAgICAgICAgICAgbXRpbWU6IG10aW1lXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3Qgc3luY0RhdGEgPSB7XG4gICAgICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIGNsaWVudElkOiBjbGllbnRJZCxcbiAgICAgICAgICAgICAgICBjbGllbnRUeXBlOiAnb2JzaWRpYW4nLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgaGFzaDogaGFzaCxcbiAgICAgICAgICAgICAgICBtdGltZTogbXRpbWUsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IG1ldGFkYXRhLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnN5bmNNYW5hZ2VyLnN5bmNOb3RlKHN5bmNEYXRhKTtcblxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGllbnRJZENhY2hlLnNldChmaWxlLnBhdGgsIGNsaWVudElkKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFx1MjcxMyBGaWxlIHN5bmNlZCBzdWNjZXNzZnVsbHk6JywgZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignW01hcmtkb3duQnJhaW5dIFx1MjcxNyBGaWxlIHN5bmMgZmFpbGVkOicsIGZpbGUucGF0aCwgcmVzdWx0LmVycm9yKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBcdTU0MENcdTZCNjVcdTU5MzFcdThEMjU6ICR7ZmlsZS5wYXRofVxcbiR7cmVzdWx0LmVycm9yfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW01hcmtkb3duQnJhaW5dIFx1MjcxNyBGaWxlIGNoYW5nZSBoYW5kbGVyIGVycm9yOicsIHtcbiAgICAgICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgICAgICAgICAgZXJyb3JTdGFjazogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1NTQwQ1x1NkI2NVx1OTUxOVx1OEJFRjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGhhbmRsZUZpbGVEZWxldGUoZmlsZTogVEZpbGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmF1dG9TeW5jKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEF1dG8tc3luYyBkaXNhYmxlZCwgc2tpcHBpbmcgZGVsZXRlOicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEZpbGUgZGVsZXRpb24gZGV0ZWN0ZWQ6Jywge1xuICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgZXh0ZW5zaW9uOiBmaWxlLmV4dGVuc2lvblxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjbGllbnRJZCA9IHRoaXMuY2xpZW50SWRDYWNoZS5nZXQoZmlsZS5wYXRoKTtcblxuICAgICAgICBpZiAoIWNsaWVudElkKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1tNYXJrZG93bkJyYWluXSBDYW5ub3Qgc3luYyBkZWxldGlvbiAtIGNsaWVudElkIG5vdCBpbiBjYWNoZTonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zeW5jTWFuYWdlci5zeW5jTm90ZSh7XG4gICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICBjbGllbnRJZDogY2xpZW50SWQsXG4gICAgICAgICAgICBjbGllbnRUeXBlOiAnb2JzaWRpYW4nLFxuICAgICAgICAgICAgYWN0aW9uOiAnZGVsZXRlJ1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRoaXMuY2xpZW50SWRDYWNoZS5kZWxldGUoZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gXHUyNzEzIEZpbGUgZGVsZXRpb24gc3luY2VkOicsIGZpbGUucGF0aCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTWFya2Rvd25CcmFpbl0gXHUyNzE3IEZpbGUgZGVsZXRpb24gc3luYyBmYWlsZWQ6JywgZmlsZS5wYXRoLCByZXN1bHQuZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgaGFuZGxlRmlsZVJlbmFtZShmaWxlOiBURmlsZSwgb2xkUGF0aDogc3RyaW5nKSB7XG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5hdXRvU3luYykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBBdXRvLXN5bmMgZGlzYWJsZWQsIHNraXBwaW5nIHJlbmFtZTonLCBvbGRQYXRoLCAnLT4nLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBGaWxlIHJlbmFtZSBkZXRlY3RlZDonLCB7XG4gICAgICAgICAgICBvbGRQYXRoOiBvbGRQYXRoLFxuICAgICAgICAgICAgbmV3UGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgZXh0ZW5zaW9uOiBmaWxlLmV4dGVuc2lvblxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNsaWVudElkQ2FjaGUucmVuYW1lKG9sZFBhdGgsIGZpbGUucGF0aCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gU3luY2luZyByZW5hbWUgd2l0aCBmcm9udG1hdHRlciBVVUlEJyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBlcmZvcm1TeW5jKGZpbGUsICdtb2RpZnknKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBcdTI3MTMgRmlsZSByZW5hbWUgc3luY2VkOicsIG9sZFBhdGgsICctPicsIGZpbGUucGF0aCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTWFya2Rvd25CcmFpbl0gXHUyNzE3IFJlbmFtZSBzeW5jIGV4Y2VwdGlvbjonLCB7XG4gICAgICAgICAgICAgICAgb2xkUGF0aDogb2xkUGF0aCxcbiAgICAgICAgICAgICAgICBuZXdQYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgXHU5MUNEXHU1NDdEXHU1NDBEXHU1NDBDXHU2QjY1XHU5NTE5XHU4QkVGOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgaGFuZGxlQXNzZXRDaGFuZ2UoZmlsZTogVEZpbGUsIGFjdGlvbjogJ2NyZWF0ZScgfCAnbW9kaWZ5Jykge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuYXV0b1N5bmMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gQXV0by1zeW5jIGRpc2FibGVkLCBza2lwcGluZyBhc3NldDonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kZWJvdW5jZVNlcnZpY2UuZGVib3VuY2UoZmlsZS5wYXRoLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBlcmZvcm1Bc3NldFN5bmMoZmlsZSwgYWN0aW9uKTtcbiAgICAgICAgfSwgNTAwKTtcbiAgICB9XG5cbiAgICBhc3luYyBwZXJmb3JtQXNzZXRTeW5jKGZpbGU6IFRGaWxlLCBhY3Rpb246ICdjcmVhdGUnIHwgJ21vZGlmeScpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBBc3NldCBjaGFuZ2UgZGV0ZWN0ZWQ6Jywge1xuICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICBleHRlbnNpb246IGZpbGUuZXh0ZW5zaW9uLFxuICAgICAgICAgICAgc2l6ZTogZmlsZS5zdGF0LnNpemVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWRCaW5hcnkoZmlsZSk7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgYXJyYXlCdWZmZXJUb0Jhc2U2NChidWZmZXIpO1xuICAgICAgICAgICAgY29uc3Qgc2hhMjU2ID0gYXdhaXQgc2hhMjU2SGFzaChidWZmZXIpO1xuXG4gICAgICAgICAgICBjb25zdCBjbGllbnRJZCA9IHRoaXMuYXNzZXRDbGllbnRJZENhY2hlLmdldChmaWxlLnBhdGgpID8/IGNyeXB0by5yYW5kb21VVUlEKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHN5bmNEYXRhOiBBc3NldFN5bmNEYXRhID0ge1xuICAgICAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICBjbGllbnRJZDogY2xpZW50SWQsXG4gICAgICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogZ2V0Q29udGVudFR5cGUoZmlsZS5leHRlbnNpb24pLFxuICAgICAgICAgICAgICAgIHNoYTI1Njogc2hhMjU2LFxuICAgICAgICAgICAgICAgIHNpemU6IGJ1ZmZlci5ieXRlTGVuZ3RoLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnN5bmNNYW5hZ2VyLnN5bmNBc3NldChzeW5jRGF0YSk7XG5cbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzZXRDbGllbnRJZENhY2hlLnNldChmaWxlLnBhdGgsIGNsaWVudElkKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFx1MjcxMyBBc3NldCBzeW5jZWQgc3VjY2Vzc2Z1bGx5OicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgQXNzZXQgc3luYyBmYWlsZWQ6JywgZmlsZS5wYXRoLCByZXN1bHQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1OEQ0NFx1NkU5MFx1NTQwQ1x1NkI2NVx1NTkzMVx1OEQyNTogJHtmaWxlLnBhdGh9XFxuJHtyZXN1bHQuZXJyb3J9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTWFya2Rvd25CcmFpbl0gXHUyNzE3IEFzc2V0IHN5bmMgZXhjZXB0aW9uOicsIHtcbiAgICAgICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1OEQ0NFx1NkU5MFx1NTQwQ1x1NkI2NVx1OTUxOVx1OEJFRjogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGhhbmRsZUFzc2V0RGVsZXRlKGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5hdXRvU3luYykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBBdXRvLXN5bmMgZGlzYWJsZWQsIHNraXBwaW5nIGFzc2V0IGRlbGV0ZTonLCBmaWxlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBBc3NldCBkZWxldGlvbiBkZXRlY3RlZDonLCBmaWxlLnBhdGgpO1xuXG4gICAgICAgIGNvbnN0IGNsaWVudElkID0gdGhpcy5hc3NldENsaWVudElkQ2FjaGUuZ2V0KGZpbGUucGF0aCk7XG4gICAgICAgIGlmICghY2xpZW50SWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignW01hcmtkb3duQnJhaW5dIENhbm5vdCBzeW5jIGFzc2V0IGRlbGV0aW9uIC0gY2xpZW50SWQgbm90IGluIGNhY2hlOicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnN5bmNNYW5hZ2VyLnN5bmNBc3NldCh7XG4gICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICBjbGllbnRJZDogY2xpZW50SWQsXG4gICAgICAgICAgICBjb250ZW50VHlwZTogZ2V0Q29udGVudFR5cGUoZmlsZS5leHRlbnNpb24pLFxuICAgICAgICAgICAgYWN0aW9uOiAnZGVsZXRlJ1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRoaXMuYXNzZXRDbGllbnRJZENhY2hlLmRlbGV0ZShmaWxlLnBhdGgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBcdTI3MTMgQXNzZXQgZGVsZXRpb24gc3luY2VkOicsIGZpbGUucGF0aCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTWFya2Rvd25CcmFpbl0gXHUyNzE3IEFzc2V0IGRlbGV0aW9uIHN5bmMgZmFpbGVkOicsIGZpbGUucGF0aCwgcmVzdWx0LmVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGhhbmRsZUFzc2V0UmVuYW1lKGZpbGU6IFRGaWxlLCBvbGRQYXRoOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmF1dG9TeW5jKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEF1dG8tc3luYyBkaXNhYmxlZCwgc2tpcHBpbmcgYXNzZXQgcmVuYW1lOicsIG9sZFBhdGgsICctPicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIEFzc2V0IHJlbmFtZSBkZXRlY3RlZDonLCBvbGRQYXRoLCAnLT4nLCBmaWxlLnBhdGgpO1xuXG4gICAgICAgIHRoaXMuYXNzZXRDbGllbnRJZENhY2hlLnJlbmFtZShvbGRQYXRoLCBmaWxlLnBhdGgpO1xuICAgICAgICBcbiAgICAgICAgYXdhaXQgdGhpcy5wZXJmb3JtQXNzZXRTeW5jKGZpbGUsICdtb2RpZnknKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTUxNjhcdTkxQ0ZcdTU0MENcdTZCNjVcdTYyNDBcdTY3MDlcdTY1ODdcdTRFRjZcbiAgICAgKiBAZmxvdyBcdTY1MzZcdTk2QzYgSURzIFx1MjE5MiBcdTZFMDVcdTc0MDZcdTVCNjRcdTUxM0YgXHUyMTkyIFx1NTg5RVx1OTFDRlx1NTQwQ1x1NkI2NSBNYXJrZG93biBcdTIxOTIgXHU1NDBDXHU2QjY1XHU4RDQ0XHU2RTkwXG4gICAgICogQGNvbXBsZXhpdHkgTyhuKSB3aGVyZSBuID0gXHU2NTg3XHU0RUY2XHU2NTcwXHU5MUNGXG4gICAgICovXG4gICAgYXN5bmMgc3luY0FsbEZpbGVzKCkge1xuICAgICAgICBjb25zdCBtYXJrZG93bkZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBjb25zdCBhc3NldEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoZiA9PiBpc0Fzc2V0RmlsZShmKSk7XG4gICAgICAgIGNvbnN0IHRvdGFsRmlsZXMgPSBtYXJrZG93bkZpbGVzLmxlbmd0aCArIGFzc2V0RmlsZXMubGVuZ3RoO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYFtNYXJrZG93bkJyYWluXSBTdGFydGluZyBmdWxsIHN5bmMgZm9yICR7bWFya2Rvd25GaWxlcy5sZW5ndGh9IG1hcmtkb3duICsgJHthc3NldEZpbGVzLmxlbmd0aH0gYXNzZXRzID0gJHt0b3RhbEZpbGVzfSBmaWxlc2ApO1xuICAgICAgICBuZXcgTm90aWNlKGBcdTVGMDBcdTU5Q0JcdTUxNjhcdTkxQ0ZcdTU0MENcdTZCNjUgJHt0b3RhbEZpbGVzfSBcdTRFMkFcdTY1ODdcdTRFRjYgKCR7bWFya2Rvd25GaWxlcy5sZW5ndGh9IFx1N0IxNFx1OEJCMCwgJHthc3NldEZpbGVzLmxlbmd0aH0gXHU4RDQ0XHU2RTkwKS4uLmApO1xuXG4gICAgICAgIC8vIFx1NkI2NVx1OUFBNCAxOiBcdTY1MzZcdTk2QzYgY2xpZW50X2lkc1xuICAgICAgICBjb25zdCBjbGllbnRJZHMgPSBhd2FpdCB0aGlzLmNvbGxlY3RDbGllbnRJZHMobWFya2Rvd25GaWxlcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbTWFya2Rvd25CcmFpbl0gQ29sbGVjdGVkICR7Y2xpZW50SWRzLmxlbmd0aH0gY2xpZW50IElEc2ApO1xuXG4gICAgICAgIC8vIFx1NkI2NVx1OUFBNCAyOiBcdTZFMDVcdTc0MDZcdTVCNjRcdTUxM0ZcdTY1ODdcdTY4NjMgKE8oMSkgXHU1MzU1XHU2QjIxXHU4QkY3XHU2QzQyKVxuICAgICAgICBhd2FpdCB0aGlzLmNsZWFudXBPcnBoYW5zKGNsaWVudElkcyk7XG5cbiAgICAgICAgLy8gXHU2QjY1XHU5QUE0IDM6IFx1NTg5RVx1OTFDRlx1NTQwQ1x1NkI2NSBNYXJrZG93blxuICAgICAgICBhd2FpdCB0aGlzLmluY3JlbWVudGFsU3luY0JhdGNoKG1hcmtkb3duRmlsZXMpO1xuXG4gICAgICAgIC8vIFx1NkI2NVx1OUFBNCA0OiBcdTU0MENcdTZCNjVcdThENDRcdTZFOTBcdTY1ODdcdTRFRjZcbiAgICAgICAgYXdhaXQgdGhpcy5zeW5jQXNzZXRCYXRjaChhc3NldEZpbGVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTY1MzZcdTk2QzZcdTYyNDBcdTY3MDlcdTY1ODdcdTRFRjZcdTc2ODQgY2xpZW50X2lkc1xuICAgICAqIEBjb21wbGV4aXR5IE8obikgdGltZSwgTyhuKSBzcGFjZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgY29sbGVjdENsaWVudElkcyhmaWxlczogVEZpbGVbXSk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgY29uc3QgaWRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgLy8gXHU1M0VBXHU1MzA1XHU1NDJCXHU5NzVFXHU3QTdBXHU2NTg3XHU0RUY2XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQ/LnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkcy5wdXNoKGF3YWl0IGdldE9yQ3JlYXRlQ2xpZW50SWQoZmlsZSwgY29udGVudCwgdGhpcy5hcHApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFtNYXJrZG93bkJyYWluXSBGYWlsZWQgdG8gcmVhZCAke2ZpbGUucGF0aH06YCwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpZHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2RTA1XHU3NDA2XHU1QjY0XHU1MTNGXHU3QjE0XHU4QkIwXG4gICAgICogQGNvbXBsZXhpdHkgTygxKSAtIFx1NTM1NVx1NkIyMVx1N0Y1MVx1N0VEQ1x1OEJGN1x1NkM0MlxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgY2xlYW51cE9ycGhhbnMoY2xpZW50SWRzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zeW5jTWFuYWdlci5mdWxsU3luYyhjbGllbnRJZHMpO1xuICAgICAgICAgICAgY29uc3QgZGVsZXRlZCA9IHJlc3VsdC5kYXRhPy5bJ2RlbGV0ZWQtY291bnQnXSB8fCAwO1xuXG4gICAgICAgICAgICBpZiAoZGVsZXRlZCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW01hcmtkb3duQnJhaW5dIFx1MjcxMyBDbGVhbmVkICR7ZGVsZXRlZH0gb3JwaGFuIG5vdGVzYCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHU2RTA1XHU3NDA2XHU0RTg2ICR7ZGVsZXRlZH0gXHU0RTJBXHU1QjY0XHU1MTNGXHU3QjE0XHU4QkIwYCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBcdTI3MTMgTm8gb3JwaGFuIG5vdGVzIGZvdW5kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGdWxsLXN5bmMgXHU1OTMxXHU4RDI1XHU0RTBEXHU0RTJEXHU2NUFEXHU2RDQxXHU3QTBCXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTWFya2Rvd25CcmFpbl0gRnVsbCBzeW5jIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NjI3OVx1OTFDRlx1NTg5RVx1OTFDRlx1NTQwQ1x1NkI2NVxuICAgICAqIEBjb21wbGV4aXR5IE8obikgd2l0aCBiYXRjaGluZ1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaW5jcmVtZW50YWxTeW5jQmF0Y2goZmlsZXM6IFRGaWxlW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgc3RhdHM6IFN5bmNTdGF0cyA9IHsgc3VjY2VzczogMCwgZmFpbGVkOiAwLCBza2lwcGVkOiAwIH07XG4gICAgICAgIGNvbnN0IGJhdGNoU2l6ZSA9IDEwO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmlsZXMubGVuZ3RoOyBpICs9IGJhdGNoU2l6ZSkge1xuICAgICAgICAgICAgY29uc3QgYmF0Y2ggPSBmaWxlcy5zbGljZShpLCBpICsgYmF0Y2hTaXplKTtcbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGJhdGNoLm1hcChmaWxlID0+IHRoaXMuc3luY09uZUZpbGUoZmlsZSwgc3RhdHMpKSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5taW4oaSArIGJhdGNoU2l6ZSwgZmlsZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1NTQwQ1x1NkI2NVx1OEZEQlx1NUVBNjogJHtwcm9ncmVzc30vJHtmaWxlcy5sZW5ndGh9IChcdTYyMTBcdTUyOUY6ICR7c3RhdHMuc3VjY2Vzc30sIFx1NTkzMVx1OEQyNTogJHtzdGF0cy5mYWlsZWR9LCBcdThERjNcdThGQzc6ICR7c3RhdHMuc2tpcHBlZH0pYCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmaW5hbE1zZyA9IGBcdTdCMTRcdThCQjBcdTU0MENcdTZCNjVcdTVCOENcdTYyMTAhIFx1NjAzQlx1OEJBMTogJHtmaWxlcy5sZW5ndGh9LCBcdTYyMTBcdTUyOUY6ICR7c3RhdHMuc3VjY2Vzc30sIFx1NTkzMVx1OEQyNTogJHtzdGF0cy5mYWlsZWR9LCBcdThERjNcdThGQzc6ICR7c3RhdHMuc2tpcHBlZH1gO1xuICAgICAgICBjb25zb2xlLmxvZyhgW01hcmtkb3duQnJhaW5dICR7ZmluYWxNc2d9YCk7XG4gICAgICAgIG5ldyBOb3RpY2UoZmluYWxNc2csIDUwMDApO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc3luY0Fzc2V0QmF0Y2goZmlsZXM6IFRGaWxlW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1tNYXJrZG93bkJyYWluXSBObyBhc3NldCBmaWxlcyB0byBzeW5jJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdGF0czogU3luY1N0YXRzID0geyBzdWNjZXNzOiAwLCBmYWlsZWQ6IDAsIHNraXBwZWQ6IDAgfTtcbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gNTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSArPSBiYXRjaFNpemUpIHtcbiAgICAgICAgICAgIGNvbnN0IGJhdGNoID0gZmlsZXMuc2xpY2UoaSwgaSArIGJhdGNoU2l6ZSk7XG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChiYXRjaC5tYXAoZmlsZSA9PiB0aGlzLnN5bmNPbmVBc3NldChmaWxlLCBzdGF0cykpKTtcblxuICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBNYXRoLm1pbihpICsgYmF0Y2hTaXplLCBmaWxlcy5sZW5ndGgpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgXHU4RDQ0XHU2RTkwXHU1NDBDXHU2QjY1XHU4RkRCXHU1RUE2OiAke3Byb2dyZXNzfS8ke2ZpbGVzLmxlbmd0aH0gKFx1NjIxMFx1NTI5RjogJHtzdGF0cy5zdWNjZXNzfSwgXHU1OTMxXHU4RDI1OiAke3N0YXRzLmZhaWxlZH0pYCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmaW5hbE1zZyA9IGBcdThENDRcdTZFOTBcdTU0MENcdTZCNjVcdTVCOENcdTYyMTAhIFx1NjAzQlx1OEJBMTogJHtmaWxlcy5sZW5ndGh9LCBcdTYyMTBcdTUyOUY6ICR7c3RhdHMuc3VjY2Vzc30sIFx1NTkzMVx1OEQyNTogJHtzdGF0cy5mYWlsZWR9YDtcbiAgICAgICAgY29uc29sZS5sb2coYFtNYXJrZG93bkJyYWluXSAke2ZpbmFsTXNnfWApO1xuICAgICAgICBuZXcgTm90aWNlKGZpbmFsTXNnLCA1MDAwKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHN5bmNPbmVBc3NldChmaWxlOiBURmlsZSwgc3RhdHM6IFN5bmNTdGF0cyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wZXJmb3JtQXNzZXRTeW5jKGZpbGUsICdjcmVhdGUnKTtcbiAgICAgICAgICAgIHN0YXRzLnN1Y2Nlc3MrKztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHN0YXRzLmZhaWxlZCsrO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgW01hcmtkb3duQnJhaW5dIFx1MjcxNyBGYWlsZWQgdG8gc3luYyBhc3NldCAke2ZpbGUucGF0aH06YCwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU1NDBDXHU2QjY1XHU1MzU1XHU0RTJBXHU2NTg3XHU0RUY2XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzeW5jT25lRmlsZShmaWxlOiBURmlsZSwgc3RhdHM6IFN5bmNTdGF0cyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGVyZm9ybVN5bmMoZmlsZSwgJ21vZGlmeScpO1xuICAgICAgICAgICAgc3RhdHMuc3VjY2VzcysrO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgc3RhdHMuZmFpbGVkKys7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBbTWFya2Rvd25CcmFpbl0gXHUyNzE3IEZhaWxlZCB0byBzeW5jICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1VubG9hZGluZyBNYXJrZG93bkJyYWluIHBsdWdpbicpO1xuICAgICAgICAvLyBcdTZFMDVcdTc0MDZcdTYyNDBcdTY3MDlcdTk2MzJcdTYyOTZcdTVCOUFcdTY1RjZcdTU2NjhcbiAgICAgICAgdGhpcy5kZWJvdW5jZVNlcnZpY2UuY2xlYXJBbGwoKTtcbiAgICAgICAgdGhpcy5zeW5jTWFuYWdlci5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuc3luY01hbmFnZXIudXBkYXRlQ29uZmlnKHtcbiAgICAgICAgICAgIHNlcnZlclVybDogdGhpcy5zZXR0aW5ncy5zZXJ2ZXJVcmwsXG4gICAgICAgICAgICBzeW5jS2V5OiB0aGlzLnNldHRpbmdzLnN5bmNLZXlcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRGaWxlLCBBcHAsIHBhcnNlWWFtbCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNvbnN0IENMSUVOVF9JRF9LRVkgPSAnbWFya2Rvd25icmFpbi1pZCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPckNyZWF0ZUNsaWVudElkKFxuICBmaWxlOiBURmlsZSxcbiAgY29udGVudDogc3RyaW5nLFxuICBhcHA6IEFwcFxuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgY2FjaGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gIGlmIChjYWNoZT8uZnJvbnRtYXR0ZXI/LltDTElFTlRfSURfS0VZXSkge1xuICAgIHJldHVybiBTdHJpbmcoY2FjaGUuZnJvbnRtYXR0ZXJbQ0xJRU5UX0lEX0tFWV0pLnRyaW0oKTtcbiAgfVxuXG4gIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gIGNvbnN0IGxhdGVzdENvbnRlbnQgPSBmaWxlQ29udGVudCB8fCBjb250ZW50O1xuXG4gIGNvbnN0IGZyb250bWF0dGVyTWF0Y2ggPSBsYXRlc3RDb250ZW50Lm1hdGNoKC9eLS0tXFxuKFtcXHNcXFNdKj8pXFxuLS0tLyk7XG4gIGlmIChmcm9udG1hdHRlck1hdGNoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGFyc2VZYW1sKGZyb250bWF0dGVyTWF0Y2hbMV0pO1xuICAgICAgaWYgKGZyb250bWF0dGVyPy5bQ0xJRU5UX0lEX0tFWV0pIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZyhmcm9udG1hdHRlcltDTElFTlRfSURfS0VZXSkudHJpbSgpO1xuICAgICAgfVxuICAgIH0gY2F0Y2gge1xuICAgICAgLy8gWUFNTCBwYXJzZSBlcnJvciwgd2lsbCBnZW5lcmF0ZSBuZXcgSURcbiAgICB9XG4gIH1cblxuICBjb25zdCBuZXdJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG5cbiAgYXdhaXQgYXBwLmZpbGVNYW5hZ2VyLnByb2Nlc3NGcm9udE1hdHRlcihmaWxlLCAoZnJvbnRtYXR0ZXIpID0+IHtcbiAgICBmcm9udG1hdHRlcltDTElFTlRfSURfS0VZXSA9IG5ld0lkO1xuICB9KTtcblxuICByZXR1cm4gbmV3SWQ7XG59XG4iLCAiLyoqXG4gKiBEb21haW4gdHlwZXMgZm9yIE1hcmtkb3duQnJhaW4gT2JzaWRpYW4gUGx1Z2luXG4gKiBcbiAqIEFsbCBpbnRlcmZhY2VzIGFuZCB0eXBlcyBleHRyYWN0ZWQgZnJvbSBtYWluLnRzIGZvciBiZXR0ZXIgbW9kdWxhcml0eS5cbiAqIE5vIHJ1bnRpbWUgZGVwZW5kZW5jaWVzIC0gcHVyZSB0eXBlIGRlZmluaXRpb25zLlxuICovXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTZXR0aW5nc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBNYXJrZG93bkJyYWluU2V0dGluZ3Mge1xuICBzZXJ2ZXJVcmw6IHN0cmluZztcbiAgc3luY0tleTogc3RyaW5nO1xuICBhdXRvU3luYzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE1hcmtkb3duQnJhaW5TZXR0aW5ncyA9IHtcbiAgc2VydmVyVXJsOiAnaHR0cHM6Ly9hcGkubWFya2Rvd25icmFpbi5jb20nLFxuICBzeW5jS2V5OiAnJyxcbiAgYXV0b1N5bmM6IHRydWVcbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTeW5jIENvbmZpZ3VyYXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3luY0NvbmZpZyB7XG4gIHNlcnZlclVybDogc3RyaW5nO1xuICBzeW5jS2V5OiBzdHJpbmc7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBOb3RlIE1ldGFkYXRhIChleHRyYWN0ZWQgZnJvbSBPYnNpZGlhbidzIG1ldGFkYXRhQ2FjaGUpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIFBvc2l0aW9uIHtcbiAgc3RhcnQ6IHsgbGluZTogbnVtYmVyOyBjb2w6IG51bWJlcjsgb2Zmc2V0OiBudW1iZXIgfTtcbiAgZW5kOiB7IGxpbmU6IG51bWJlcjsgY29sOiBudW1iZXI7IG9mZnNldDogbnVtYmVyIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGFnSW5mbyB7XG4gIHRhZzogc3RyaW5nO1xuICBwb3NpdGlvbjogUG9zaXRpb247XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGVhZGluZ0luZm8ge1xuICBoZWFkaW5nOiBzdHJpbmc7XG4gIGxldmVsOiBudW1iZXI7XG4gIHBvc2l0aW9uOiBQb3NpdGlvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBOb3RlTWV0YWRhdGEge1xuICB0YWdzPzogVGFnSW5mb1tdO1xuICBoZWFkaW5ncz86IEhlYWRpbmdJbmZvW107XG4gIGZyb250bWF0dGVyPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTeW5jIERhdGEgUGF5bG9hZHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCB0eXBlIFN5bmNBY3Rpb24gPSAnY3JlYXRlJyB8ICdtb2RpZnknIHwgJ2RlbGV0ZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3luY0RhdGEge1xuICBwYXRoOiBzdHJpbmc7XG4gIGNsaWVudElkOiBzdHJpbmc7XG4gIGNsaWVudFR5cGU6IHN0cmluZztcbiAgY29udGVudD86IHN0cmluZztcbiAgaGFzaD86IHN0cmluZztcbiAgbXRpbWU/OiBzdHJpbmc7XG4gIG1ldGFkYXRhPzogTm90ZU1ldGFkYXRhO1xuICBhY3Rpb246IFN5bmNBY3Rpb247XG59XG5cbmV4cG9ydCB0eXBlIEFzc2V0QWN0aW9uID0gJ2NyZWF0ZScgfCAnbW9kaWZ5JyB8ICdkZWxldGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFzc2V0U3luY0RhdGEge1xuICBwYXRoOiBzdHJpbmc7XG4gIGNsaWVudElkOiBzdHJpbmc7XG4gIGNvbnRlbnQ/OiBzdHJpbmc7XG4gIGNvbnRlbnRUeXBlOiBzdHJpbmc7XG4gIHNoYTI1Nj86IHN0cmluZztcbiAgc2l6ZT86IG51bWJlcjtcbiAgYWN0aW9uOiBBc3NldEFjdGlvbjtcbn1cblxuZXhwb3J0IHR5cGUgUmVzb3VyY2VTeW5jRGF0YSA9IEFzc2V0U3luY0RhdGE7XG5leHBvcnQgdHlwZSBSZXNvdXJjZUFjdGlvbiA9IEFzc2V0QWN0aW9uO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQVBJIFJlc3BvbnNlc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBWYXVsdEluZm8ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGRvbWFpbjogc3RyaW5nO1xuICAnY3JlYXRlZC1hdCc6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUZXN0Q29ubmVjdGlvblJlc3VsdCB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIHZhdWx0SW5mbz86IFZhdWx0SW5mbztcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3luY1Jlc3VsdCB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZ1bGxTeW5jUmVxdWVzdCB7XG4gIGNsaWVudElkczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRnVsbFN5bmNSZXNwb25zZURhdGEge1xuICAndmF1bHQtaWQnOiBzdHJpbmc7XG4gIGFjdGlvbjogc3RyaW5nO1xuICAnY2xpZW50LW5vdGVzJzogbnVtYmVyO1xuICAnZGVsZXRlZC1jb3VudCc6IG51bWJlcjtcbiAgJ3JlbWFpbmluZy1ub3Rlcyc6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGdWxsU3luY1Jlc3BvbnNlIHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgZGF0YT86IEZ1bGxTeW5jUmVzcG9uc2VEYXRhO1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFN5bmMgU3RhdGlzdGljc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBTeW5jU3RhdHMge1xuICBzdWNjZXNzOiBudW1iZXI7XG4gIGZhaWxlZDogbnVtYmVyO1xuICBza2lwcGVkOiBudW1iZXI7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQb3J0IEludGVyZmFjZXMgKGZvciBkZXBlbmRlbmN5IGluamVjdGlvbilcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyUG9ydCB7XG4gIGluZm8obWVzc2FnZTogc3RyaW5nLCBkYXRhPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiB2b2lkO1xuICB3YXJuKG1lc3NhZ2U6IHN0cmluZywgZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KTogdm9pZDtcbiAgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBkYXRhPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiB2b2lkO1xuICBkZWJ1ZyhtZXNzYWdlOiBzdHJpbmcsIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTm90aWNlUG9ydCB7XG4gIHNob3cobWVzc2FnZTogc3RyaW5nLCB0aW1lb3V0TXM/OiBudW1iZXIpOiB2b2lkO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpbGVJbmZvIHtcbiAgcGF0aDogc3RyaW5nO1xuICBleHRlbnNpb246IHN0cmluZztcbiAgc3RhdDoge1xuICAgIG10aW1lOiBudW1iZXI7XG4gICAgY3RpbWU6IG51bWJlcjtcbiAgICBzaXplOiBudW1iZXI7XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmF1bHRQb3J0IHtcbiAgZ2V0TWFya2Rvd25GaWxlcygpOiBGaWxlSW5mb1tdO1xuICByZWFkVGV4dChmaWxlOiBGaWxlSW5mbyk6IFByb21pc2U8c3RyaW5nPjtcbiAgcmVhZEJpbmFyeShmaWxlOiBGaWxlSW5mbyk6IFByb21pc2U8QXJyYXlCdWZmZXI+O1xuICBzdGF0KGZpbGU6IEZpbGVJbmZvKTogeyBtdGltZTogbnVtYmVyOyBzaXplOiBudW1iZXIgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDYWNoZWRNZXRhZGF0YSB7XG4gIHRhZ3M/OiBBcnJheTx7IHRhZzogc3RyaW5nOyBwb3NpdGlvbjogUG9zaXRpb24gfT47XG4gIGhlYWRpbmdzPzogQXJyYXk8eyBoZWFkaW5nOiBzdHJpbmc7IGxldmVsOiBudW1iZXI7IHBvc2l0aW9uOiBQb3NpdGlvbiB9PjtcbiAgZnJvbnRtYXR0ZXI/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNZXRhZGF0YVBvcnQge1xuICBnZXRGaWxlQ2FjaGUocGF0aDogc3RyaW5nKTogQ2FjaGVkTWV0YWRhdGEgfCBudWxsO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQVBJIENsaWVudCBJbnRlcmZhY2Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3luY0FwaSB7XG4gIHRlc3RDb25uZWN0aW9uKHRpbWVvdXQ/OiBudW1iZXIpOiBQcm9taXNlPFRlc3RDb25uZWN0aW9uUmVzdWx0PjtcbiAgc3luY05vdGUoZGF0YTogU3luY0RhdGEpOiBQcm9taXNlPFN5bmNSZXN1bHQ+O1xuICBmdWxsU3luYyhjbGllbnRJZHM6IHN0cmluZ1tdKTogUHJvbWlzZTxGdWxsU3luY1Jlc3BvbnNlPjtcbiAgc3luY0Fzc2V0KGRhdGE6IEFzc2V0U3luY0RhdGEpOiBQcm9taXNlPFN5bmNSZXN1bHQ+O1xufVxuIiwgImV4cG9ydCBjb25zdCBBU1NFVF9FWFRFTlNJT05TID0gbmV3IFNldChbXG4gICdwbmcnLCAnanBnJywgJ2pwZWcnLCAnZ2lmJywgJ3dlYnAnLCAnc3ZnJywgJ2JtcCcsICdpY28nLFxuICAncGRmJyxcbiAgJ21wMycsICdvZ2cnLCAnd2F2JyxcbiAgJ21wNCcsICd3ZWJtJ1xuXSk7XG5cbmV4cG9ydCBjb25zdCBSRVNPVVJDRV9FWFRFTlNJT05TID0gQVNTRVRfRVhURU5TSU9OUztcblxuZXhwb3J0IGludGVyZmFjZSBGaWxlV2l0aEV4dGVuc2lvbiB7XG4gIGV4dGVuc2lvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNBc3NldEZpbGUoZmlsZTogRmlsZVdpdGhFeHRlbnNpb24pOiBib29sZWFuIHtcbiAgcmV0dXJuIEFTU0VUX0VYVEVOU0lPTlMuaGFzKGZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkpO1xufVxuXG5leHBvcnQgY29uc3QgaXNSZXNvdXJjZUZpbGUgPSBpc0Fzc2V0RmlsZTtcbiIsICIvKipcbiAqIE1JTUUgdHlwZSB1dGlsaXRpZXNcbiAqIFxuICogUHVyZSBmdW5jdGlvbnMgZm9yIGRldGVybWluaW5nIE1JTUUgdHlwZXMgZnJvbSBmaWxlIGV4dGVuc2lvbnMuXG4gKiBObyBPYnNpZGlhbiBkZXBlbmRlbmNpZXMgLSBmdWxseSB1bml0LXRlc3RhYmxlLlxuICovXG5cbi8qKlxuICogTWFwcGluZyBvZiBmaWxlIGV4dGVuc2lvbnMgdG8gTUlNRSB0eXBlc1xuICovXG5leHBvcnQgY29uc3QgTUlNRV9UWVBFUzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgLy8gSW1hZ2VzXG4gICdwbmcnOiAnaW1hZ2UvcG5nJyxcbiAgJ2pwZyc6ICdpbWFnZS9qcGVnJyxcbiAgJ2pwZWcnOiAnaW1hZ2UvanBlZycsXG4gICdnaWYnOiAnaW1hZ2UvZ2lmJyxcbiAgJ3dlYnAnOiAnaW1hZ2Uvd2VicCcsXG4gICdzdmcnOiAnaW1hZ2Uvc3ZnK3htbCcsXG4gICdibXAnOiAnaW1hZ2UvYm1wJyxcbiAgJ2ljbyc6ICdpbWFnZS94LWljb24nLFxuICAvLyBEb2N1bWVudHNcbiAgJ3BkZic6ICdhcHBsaWNhdGlvbi9wZGYnLFxuICAvLyBBdWRpb1xuICAnbXAzJzogJ2F1ZGlvL21wZWcnLFxuICAnb2dnJzogJ2F1ZGlvL29nZycsXG4gICd3YXYnOiAnYXVkaW8vd2F2JyxcbiAgLy8gVmlkZW9cbiAgJ21wNCc6ICd2aWRlby9tcDQnLFxuICAnd2VibSc6ICd2aWRlby93ZWJtJ1xufTtcblxuLyoqXG4gKiBHZXQgTUlNRSB0eXBlIGZvciBhIGZpbGUgZXh0ZW5zaW9uXG4gKiBAcGFyYW0gZXh0ZW5zaW9uIC0gRmlsZSBleHRlbnNpb24gKHdpdGggb3Igd2l0aG91dCBkb3QpXG4gKiBAcmV0dXJucyBNSU1FIHR5cGUgc3RyaW5nLCBvciAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJyBmb3IgdW5rbm93biBleHRlbnNpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250ZW50VHlwZShleHRlbnNpb246IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGV4dCA9IGV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpO1xuICByZXR1cm4gTUlNRV9UWVBFU1tleHRdIHx8ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nO1xufVxuIiwgIi8qKlxuICogRW5jb2RpbmcgdXRpbGl0aWVzXG4gKiBcbiAqIFB1cmUgZnVuY3Rpb25zIGZvciBlbmNvZGluZyBiaW5hcnkgZGF0YS5cbiAqIE5vIE9ic2lkaWFuIGRlcGVuZGVuY2llcyAtIGZ1bGx5IHVuaXQtdGVzdGFibGUuXG4gKi9cblxuLyoqXG4gKiBDb252ZXJ0IEFycmF5QnVmZmVyIHRvIGJhc2U2NCBzdHJpbmdcbiAqIEBwYXJhbSBidWZmZXIgLSBBcnJheUJ1ZmZlciB0byBlbmNvZGVcbiAqIEByZXR1cm5zIEJhc2U2NCBlbmNvZGVkIHN0cmluZ1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXJyYXlCdWZmZXJUb0Jhc2U2NChidWZmZXI6IEFycmF5QnVmZmVyKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICBsZXQgYmluYXJ5ID0gJyc7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZXMuYnl0ZUxlbmd0aDsgaSsrKSB7XG4gICAgYmluYXJ5ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pO1xuICB9XG4gIHJldHVybiBidG9hKGJpbmFyeSk7XG59XG4iLCAiLyoqXG4gKiBIYXNoIHV0aWxpdGllc1xuICogXG4gKiBQdXJlIGZ1bmN0aW9ucyBmb3IgaGFzaGluZyBkYXRhIHVzaW5nIFdlYiBDcnlwdG8gQVBJLlxuICogTm8gT2JzaWRpYW4gZGVwZW5kZW5jaWVzIC0gZnVsbHkgdW5pdC10ZXN0YWJsZS5cbiAqL1xuXG4vKipcbiAqIENvbXB1dGUgU0hBLTI1NiBoYXNoIG9mIGFuIEFycmF5QnVmZmVyXG4gKiBAcGFyYW0gYnVmZmVyIC0gQXJyYXlCdWZmZXIgdG8gaGFzaFxuICogQHJldHVybnMgSGV4LWVuY29kZWQgU0hBLTI1NiBoYXNoICg2NCBjaGFyYWN0ZXJzKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2hhMjU2SGFzaChidWZmZXI6IEFycmF5QnVmZmVyKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgaGFzaEJ1ZmZlciA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgYnVmZmVyKTtcbiAgY29uc3QgaGFzaEFycmF5ID0gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShoYXNoQnVmZmVyKSk7XG4gIHJldHVybiBoYXNoQXJyYXkubWFwKGIgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgJzAnKSkuam9pbignJyk7XG59XG5cbi8qKlxuICogQ29tcHV0ZSBTSEEtMjU2IGhhc2ggb2YgYSBzdHJpbmdcbiAqIEBwYXJhbSBzdHIgLSBTdHJpbmcgdG8gaGFzaFxuICogQHJldHVybnMgSGV4LWVuY29kZWQgU0hBLTI1NiBoYXNoICg2NCBjaGFyYWN0ZXJzKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzaFN0cmluZyhzdHI6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgY29uc3QgZGF0YSA9IGVuY29kZXIuZW5jb2RlKHN0cik7XG4gIHJldHVybiBzaGEyNTZIYXNoKGRhdGEuYnVmZmVyKTtcbn1cbiIsICIvKipcbiAqIFN5bmMgQVBJIENsaWVudFxuICogXG4gKiBIVFRQIEFQSSBjbGllbnQgZm9yIE1hcmtkb3duQnJhaW4gc2VydmVyLlxuICogVXNlcyBIdHRwQ2xpZW50IGludGVyZmFjZSBmb3IgdGVzdGFiaWxpdHkgKGNhbiBtb2NrIE9ic2lkaWFuJ3MgcmVxdWVzdFVybCkuXG4gKi9cblxuaW1wb3J0IHR5cGUge1xuICBTeW5jQ29uZmlnLFxuICBTeW5jRGF0YSxcbiAgQXNzZXRTeW5jRGF0YSxcbiAgVGVzdENvbm5lY3Rpb25SZXN1bHQsXG4gIFN5bmNSZXN1bHQsXG4gIEZ1bGxTeW5jUmVzcG9uc2UsXG4gIEZ1bGxTeW5jUmVxdWVzdCxcbiAgU3luY0FwaSxcbn0gZnJvbSAnLi4vZG9tYWluL3R5cGVzJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEhUVFAgQ2xpZW50IEludGVyZmFjZSAoZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBIdHRwUmVzcG9uc2Uge1xuICBzdGF0dXM6IG51bWJlcjtcbiAganNvbjogdW5rbm93bjtcbiAgdGV4dDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEh0dHBSZXF1ZXN0IHtcbiAgdXJsOiBzdHJpbmc7XG4gIG1ldGhvZDogJ0dFVCcgfCAnUE9TVCcgfCAnUFVUJyB8ICdERUxFVEUnO1xuICBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICBib2R5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEh0dHBDbGllbnQge1xuICByZXF1ZXN0KHJlcTogSHR0cFJlcXVlc3QpOiBQcm9taXNlPEh0dHBSZXNwb25zZT47XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTeW5jIEFQSSBDbGllbnQgSW1wbGVtZW50YXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBTeW5jQXBpQ2xpZW50IGltcGxlbWVudHMgU3luY0FwaSB7XG4gIHByaXZhdGUgY29uZmlnOiBTeW5jQ29uZmlnO1xuICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQ7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBTeW5jQ29uZmlnLCBodHRwQ2xpZW50OiBIdHRwQ2xpZW50KSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5odHRwID0gaHR0cENsaWVudDtcbiAgfVxuXG4gIHVwZGF0ZUNvbmZpZyhjb25maWc6IFN5bmNDb25maWcpOiB2b2lkIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgfVxuXG4gIGFzeW5jIHRlc3RDb25uZWN0aW9uKHRpbWVvdXQ6IG51bWJlciA9IDMwMDAwKTogUHJvbWlzZTxUZXN0Q29ubmVjdGlvblJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuaHR0cC5yZXF1ZXN0KHtcbiAgICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5zZXJ2ZXJVcmx9L29ic2lkaWFuL3ZhdWx0L2luZm9gLFxuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuc3luY0tleX1gXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb24gYXMgeyB2YXVsdDogVGVzdENvbm5lY3Rpb25SZXN1bHRbJ3ZhdWx0SW5mbyddIH07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICB2YXVsdEluZm86IGRhdGEudmF1bHRcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGBIVFRQICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS50ZXh0IHx8ICdVbmtub3duIGVycm9yJ31gXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICAgIGlmIChlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmICduYW1lJyBpbiBlcnJvciAmJiBlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogYFx1OEZERVx1NjNBNVx1OEQ4NVx1NjVGNlx1RkYwOCR7dGltZW91dCAvIDEwMDB9XHU3OUQyXHVGRjA5YFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzeW5jTm90ZShkYXRhOiBTeW5jRGF0YSk6IFByb21pc2U8U3luY1Jlc3VsdD4ge1xuICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gU3RhcnRpbmcgc3luYzonLCB7XG4gICAgICBwYXRoOiBkYXRhLnBhdGgsXG4gICAgICBhY3Rpb246IGRhdGEuYWN0aW9uLFxuICAgICAgaGFzQ29udGVudDogISFkYXRhLmNvbnRlbnQsXG4gICAgICBjb250ZW50TGVuZ3RoOiBkYXRhLmNvbnRlbnQ/Lmxlbmd0aCxcbiAgICAgIHNlcnZlclVybDogdGhpcy5jb25maWcuc2VydmVyVXJsLFxuICAgICAgaGFzU3luY0tleTogISF0aGlzLmNvbmZpZy5zeW5jS2V5XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVxdWVzdEJvZHkgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gUmVxdWVzdCBib2R5IHNpemU6JywgcmVxdWVzdEJvZHkubGVuZ3RoLCAnYnl0ZXMnKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmh0dHAucmVxdWVzdCh7XG4gICAgICAgIHVybDogYCR7dGhpcy5jb25maWcuc2VydmVyVXJsfS9vYnNpZGlhbi9zeW5jYCxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLnN5bmNLZXl9YFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiByZXF1ZXN0Qm9keVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gUmVzcG9uc2U6Jywge1xuICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgYm9keVByZXZpZXc6IHJlc3BvbnNlLnRleHQ/LnN1YnN0cmluZygwLCAyMDApXG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gXHUyNzEzIFN5bmMgc3VjY2Vzc2Z1bDonLCBkYXRhLnBhdGgpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBlcnJvck1zZyA9IGBIVFRQICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS50ZXh0IHx8ICdTeW5jIGZhaWxlZCd9YDtcbiAgICAgICAgY29uc29sZS5lcnJvcignW01hcmtkb3duQnJhaW5dIFx1MjcxNyBTeW5jIGZhaWxlZDonLCB7XG4gICAgICAgICAgcGF0aDogZGF0YS5wYXRoLFxuICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIGVycm9yOiBlcnJvck1zZyxcbiAgICAgICAgICByZXNwb25zZUJvZHk6IHJlc3BvbnNlLnRleHRcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGVycm9yTXNnXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgU3luYyBleGNlcHRpb246Jywge1xuICAgICAgICBwYXRoOiBkYXRhLnBhdGgsXG4gICAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgICAgZXJyb3JTdGFjazogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVsbFN5bmMoY2xpZW50SWRzOiBzdHJpbmdbXSk6IFByb21pc2U8RnVsbFN5bmNSZXNwb25zZT4ge1xuICAgIGNvbnNvbGUubG9nKCdbTWFya2Rvd25CcmFpbl0gU3RhcnRpbmcgZnVsbCBzeW5jLi4uJywge1xuICAgICAgY2xpZW50Tm90ZUNvdW50OiBjbGllbnRJZHMubGVuZ3RoXG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVxdWVzdEJvZHk6IEZ1bGxTeW5jUmVxdWVzdCA9IHsgY2xpZW50SWRzIH07XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuaHR0cC5yZXF1ZXN0KHtcbiAgICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5zZXJ2ZXJVcmx9L29ic2lkaWFuL3N5bmMvZnVsbGAsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5zeW5jS2V5fWBcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpXG4gICAgICB9KTtcblxuICAgICAgLy8gQmFja3dhcmQgY29tcGF0aWJpbGl0eTogb2xkIHNlcnZlcnMgZG9uJ3Qgc3VwcG9ydCBmdWxsLXN5bmMgKDQwNClcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1tNYXJrZG93bkJyYWluXSBGdWxsIHN5bmMgbm90IHN1cHBvcnRlZCBieSBzZXJ2ZXIgKDQwNCksIHNraXBwaW5nIG9ycGhhbiBjbGVhbnVwJyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAndmF1bHQtaWQnOiAnJyxcbiAgICAgICAgICAgIGFjdGlvbjogJ2Z1bGwtc3luYycsXG4gICAgICAgICAgICAnY2xpZW50LW5vdGVzJzogY2xpZW50SWRzLmxlbmd0aCxcbiAgICAgICAgICAgICdkZWxldGVkLWNvdW50JzogMCxcbiAgICAgICAgICAgICdyZW1haW5pbmctbm90ZXMnOiBjbGllbnRJZHMubGVuZ3RoXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb24gYXMgRnVsbFN5bmNSZXNwb25zZVsnZGF0YSddO1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFx1MjcxMyBGdWxsIHN5bmMgc3VjY2Vzc2Z1bDonLCB7XG4gICAgICAgICAgZGVsZXRlZENvdW50OiBkYXRhPy5bJ2RlbGV0ZWQtY291bnQnXSxcbiAgICAgICAgICByZW1haW5pbmdOb3RlczogZGF0YT8uWydyZW1haW5pbmctbm90ZXMnXVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGVycm9yTXNnID0gYEhUVFAgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnRleHQgfHwgJ0Z1bGwgc3luYyBmYWlsZWQnfWA7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgRnVsbCBzeW5jIGZhaWxlZDonLCB7XG4gICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgZXJyb3I6IGVycm9yTXNnXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBlcnJvck1zZ1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck1zZyA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InO1xuICAgICAgY29uc29sZS5lcnJvcignW01hcmtkb3duQnJhaW5dIFx1MjcxNyBGdWxsIHN5bmMgZXhjZXB0aW9uOicsIHtcbiAgICAgICAgZXJyb3I6IGVycm9yTXNnXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3JNc2dcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3luY0Fzc2V0KGRhdGE6IEFzc2V0U3luY0RhdGEpOiBQcm9taXNlPFN5bmNSZXN1bHQ+IHtcbiAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFN0YXJ0aW5nIGFzc2V0IHN5bmM6Jywge1xuICAgICAgcGF0aDogZGF0YS5wYXRoLFxuICAgICAgY2xpZW50SWQ6IGRhdGEuY2xpZW50SWQsXG4gICAgICBhY3Rpb246IGRhdGEuYWN0aW9uLFxuICAgICAgY29udGVudFR5cGU6IGRhdGEuY29udGVudFR5cGUsXG4gICAgICBzaXplOiBkYXRhLnNpemVcbiAgICB9KTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuaHR0cC5yZXF1ZXN0KHtcbiAgICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5zZXJ2ZXJVcmx9L29ic2lkaWFuL2Fzc2V0cy9zeW5jYCxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuY29uZmlnLnN5bmNLZXl9YFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICBjb25zb2xlLmxvZygnW01hcmtkb3duQnJhaW5dIFx1MjcxMyBBc3NldCBzeW5jIHN1Y2Nlc3NmdWw6JywgZGF0YS5wYXRoKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZXJyb3JNc2cgPSBgSFRUUCAke3Jlc3BvbnNlLnN0YXR1c306ICR7cmVzcG9uc2UudGV4dCB8fCAnQXNzZXQgc3luYyBmYWlsZWQnfWA7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNYXJrZG93bkJyYWluXSBcdTI3MTcgQXNzZXQgc3luYyBmYWlsZWQ6Jywge1xuICAgICAgICAgIHBhdGg6IGRhdGEucGF0aCxcbiAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICBlcnJvcjogZXJyb3JNc2dcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3JNc2cgfTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW01hcmtkb3duQnJhaW5dIFx1MjcxNyBBc3NldCBzeW5jIGV4Y2VwdGlvbjonLCB7XG4gICAgICAgIHBhdGg6IGRhdGEucGF0aCxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAvLyBDbGVhbnVwIGlmIG5lZWRlZFxuICB9XG59XG4iLCAiLyoqXG4gKiBPYnNpZGlhbiBIVFRQIENsaWVudCBBZGFwdGVyXG4gKiBcbiAqIEltcGxlbWVudHMgSHR0cENsaWVudCBpbnRlcmZhY2UgdXNpbmcgT2JzaWRpYW4ncyByZXF1ZXN0VXJsLlxuICovXG5cbmltcG9ydCB7IHJlcXVlc3RVcmwgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgdHlwZSB7IEh0dHBDbGllbnQsIEh0dHBSZXF1ZXN0LCBIdHRwUmVzcG9uc2UgfSBmcm9tICcuL3N5bmMtYXBpJztcblxuZXhwb3J0IGNsYXNzIE9ic2lkaWFuSHR0cENsaWVudCBpbXBsZW1lbnRzIEh0dHBDbGllbnQge1xuICBhc3luYyByZXF1ZXN0KHJlcTogSHR0cFJlcXVlc3QpOiBQcm9taXNlPEh0dHBSZXNwb25zZT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG4gICAgICB1cmw6IHJlcS51cmwsXG4gICAgICBtZXRob2Q6IHJlcS5tZXRob2QsXG4gICAgICBoZWFkZXJzOiByZXEuaGVhZGVycyxcbiAgICAgIGJvZHk6IHJlcS5ib2R5LFxuICAgICAgdGhyb3c6IGZhbHNlXG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICBqc29uOiByZXNwb25zZS5qc29uLFxuICAgICAgdGV4dDogcmVzcG9uc2UudGV4dFxuICAgIH07XG4gIH1cbn1cbiIsICIvKipcbiAqIFRpbWVyIGZhY3RvcnkgaW50ZXJmYWNlIGZvciBkZXBlbmRlbmN5IGluamVjdGlvblxuICogQWxsb3dzIHRlc3Rpbmcgd2l0aCBtb2NrIHRpbWVyc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFRpbWVyRmFjdG9yeSB7XG4gICAgc2V0VGltZW91dDogKGNhbGxiYWNrOiAoKSA9PiB2b2lkLCBkZWxheTogbnVtYmVyKSA9PiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0PjtcbiAgICBjbGVhclRpbWVvdXQ6IChpZDogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0VGltZW91dD4pID0+IHZvaWQ7XG59XG5cbi8qKlxuICogRGVmYXVsdCB0aW1lciBmYWN0b3J5IHVzaW5nIGdsb2JhbCBzZXRUaW1lb3V0L2NsZWFyVGltZW91dFxuICovXG5leHBvcnQgY29uc3QgZGVmYXVsdFRpbWVyRmFjdG9yeTogVGltZXJGYWN0b3J5ID0ge1xuICAgIHNldFRpbWVvdXQ6IChjYWxsYmFjaywgZGVsYXkpID0+IHNldFRpbWVvdXQoY2FsbGJhY2ssIGRlbGF5KSxcbiAgICBjbGVhclRpbWVvdXQ6IChpZCkgPT4gY2xlYXJUaW1lb3V0KGlkKSxcbn07XG5cbi8qKlxuICogRGVib3VuY2Ugc2VydmljZSBmb3IgbWFuYWdpbmcgbXVsdGlwbGUgZGVib3VuY2VkIG9wZXJhdGlvbnMgYnkga2V5XG4gKiBcbiAqIEBleGFtcGxlXG4gKiBgYGB0c1xuICogY29uc3QgZGVib3VuY2UgPSBuZXcgRGVib3VuY2VTZXJ2aWNlKCk7XG4gKiBcbiAqIC8vIERlYm91bmNlIGZpbGUgc3luYyBieSBwYXRoXG4gKiBkZWJvdW5jZS5kZWJvdW5jZShmaWxlLnBhdGgsICgpID0+IHN5bmNGaWxlKGZpbGUpLCAzMDApO1xuICogXG4gKiAvLyBDbGVhciBhbGwgb24gdW5sb2FkXG4gKiBkZWJvdW5jZS5jbGVhckFsbCgpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBEZWJvdW5jZVNlcnZpY2Uge1xuICAgIHByaXZhdGUgdGltZXJzOiBNYXA8c3RyaW5nLCBSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0Pj47XG4gICAgcHJpdmF0ZSB0aW1lckZhY3Rvcnk6IFRpbWVyRmFjdG9yeTtcblxuICAgIGNvbnN0cnVjdG9yKHRpbWVyRmFjdG9yeTogVGltZXJGYWN0b3J5ID0gZGVmYXVsdFRpbWVyRmFjdG9yeSkge1xuICAgICAgICB0aGlzLnRpbWVycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy50aW1lckZhY3RvcnkgPSB0aW1lckZhY3Rvcnk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2NoZWR1bGUgYSBkZWJvdW5jZWQgY2FsbGJhY2sgZm9yIHRoZSBnaXZlbiBrZXlcbiAgICAgKiBJZiBhIHRpbWVyIGFscmVhZHkgZXhpc3RzIGZvciB0aGUga2V5LCBpdCB3aWxsIGJlIGNhbmNlbGxlZCBhbmQgcmVwbGFjZWRcbiAgICAgKi9cbiAgICBkZWJvdW5jZShrZXk6IHN0cmluZywgY2FsbGJhY2s6ICgpID0+IHZvaWQsIGRlbGF5OiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2FuY2VsIGV4aXN0aW5nIHRpbWVyIGZvciB0aGlzIGtleVxuICAgICAgICBjb25zdCBleGlzdGluZ1RpbWVyID0gdGhpcy50aW1lcnMuZ2V0KGtleSk7XG4gICAgICAgIGlmIChleGlzdGluZ1RpbWVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMudGltZXJGYWN0b3J5LmNsZWFyVGltZW91dChleGlzdGluZ1RpbWVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNjaGVkdWxlIG5ldyB0aW1lclxuICAgICAgICBjb25zdCB0aW1lciA9IHRoaXMudGltZXJGYWN0b3J5LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50aW1lcnMuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9LCBkZWxheSk7XG5cbiAgICAgICAgdGhpcy50aW1lcnMuc2V0KGtleSwgdGltZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbmNlbCBhIHNwZWNpZmljIGRlYm91bmNlZCBvcGVyYXRpb24gYnkga2V5XG4gICAgICovXG4gICAgY2FuY2VsKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy50aW1lcnMuZ2V0KGtleSk7XG4gICAgICAgIGlmICh0aW1lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVyRmFjdG9yeS5jbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgICAgICAgdGhpcy50aW1lcnMuZGVsZXRlKGtleSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBhbGwgcGVuZGluZyB0aW1lcnNcbiAgICAgKi9cbiAgICBjbGVhckFsbCgpOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCB0aW1lciBvZiB0aGlzLnRpbWVycy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgdGhpcy50aW1lckZhY3RvcnkuY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRpbWVycy5jbGVhcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGEga2V5IGhhcyBhIHBlbmRpbmcgdGltZXJcbiAgICAgKi9cbiAgICBoYXMoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXJzLmhhcyhrZXkpO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIENhY2hlIGZvciBtYXBwaW5nIGZpbGUgcGF0aHMgdG8gY2xpZW50IElEc1xuICogXG4gKiBQcm92aWRlcyBmYXN0IGxvb2t1cCBhbmQgaGFuZGxlcyBwYXRoIHJlbmFtZXMgZ3JhY2VmdWxseS5cbiAqIFVzZWQgdG8gdHJhY2sgY2xpZW50IElEcyB3aXRob3V0IHJlLXJlYWRpbmcgZmlsZSBjb250ZW50L2Zyb250bWF0dGVyLlxuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHNcbiAqIGNvbnN0IGNhY2hlID0gbmV3IENsaWVudElkQ2FjaGUoKTtcbiAqIFxuICogLy8gT24gc3luYyBzdWNjZXNzXG4gKiBjYWNoZS5zZXQoZmlsZS5wYXRoLCBjbGllbnRJZCk7XG4gKiBcbiAqIC8vIE9uIGZpbGUgZGVsZXRlXG4gKiBjb25zdCBjbGllbnRJZCA9IGNhY2hlLmdldChmaWxlLnBhdGgpO1xuICogY2FjaGUuZGVsZXRlKGZpbGUucGF0aCk7XG4gKiBcbiAqIC8vIE9uIGZpbGUgcmVuYW1lXG4gKiBjYWNoZS5yZW5hbWUob2xkUGF0aCwgbmV3UGF0aCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIENsaWVudElkQ2FjaGUge1xuICAgIHByaXZhdGUgY2FjaGU6IE1hcDxzdHJpbmcsIHN0cmluZz47XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jYWNoZSA9IG5ldyBNYXAoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY2xpZW50IElEIGZvciBhIGZpbGUgcGF0aFxuICAgICAqL1xuICAgIGdldChwYXRoOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZS5nZXQocGF0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGNsaWVudCBJRCBmb3IgYSBmaWxlIHBhdGhcbiAgICAgKi9cbiAgICBzZXQocGF0aDogc3RyaW5nLCBjbGllbnRJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY2FjaGUuc2V0KHBhdGgsIGNsaWVudElkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhIHBhdGggaGFzIGEgY2FjaGVkIGNsaWVudCBJRFxuICAgICAqL1xuICAgIGhhcyhwYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGUuaGFzKHBhdGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBjbGllbnQgSUQgZm9yIGEgZmlsZSBwYXRoXG4gICAgICovXG4gICAgZGVsZXRlKHBhdGg6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLmNhY2hlLmRlbGV0ZShwYXRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgZmlsZSByZW5hbWUgLSBtb3ZlcyBjbGllbnQgSUQgZnJvbSBvbGQgcGF0aCB0byBuZXcgcGF0aFxuICAgICAqL1xuICAgIHJlbmFtZShvbGRQYXRoOiBzdHJpbmcsIG5ld1BhdGg6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBjbGllbnRJZCA9IHRoaXMuY2FjaGUuZ2V0KG9sZFBhdGgpO1xuICAgICAgICBpZiAoY2xpZW50SWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5jYWNoZS5kZWxldGUob2xkUGF0aCk7XG4gICAgICAgICAgICB0aGlzLmNhY2hlLnNldChuZXdQYXRoLCBjbGllbnRJZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBhbGwgY2FjaGVkIGVudHJpZXNcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jYWNoZS5jbGVhcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBudW1iZXIgb2YgY2FjaGVkIGVudHJpZXNcbiAgICAgKi9cbiAgICBnZXQgc2l6ZSgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZS5zaXplO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgZW50cmllcyBhcyBhcnJheSBvZiBbcGF0aCwgY2xpZW50SWRdIHR1cGxlc1xuICAgICAqL1xuICAgIGVudHJpZXMoKTogQXJyYXk8W3N0cmluZywgc3RyaW5nXT4ge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmNhY2hlLmVudHJpZXMoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBjbGllbnQgSURzXG4gICAgICovXG4gICAgZ2V0QWxsQ2xpZW50SWRzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5jYWNoZS52YWx1ZXMoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgY2FjaGUgZnJvbSBlbnRyaWVzIChyZXBsYWNlcyBleGlzdGluZyBjYWNoZSlcbiAgICAgKi9cbiAgICBidWlsZEZyb21FbnRyaWVzKGVudHJpZXM6IEFycmF5PFtzdHJpbmcsIHN0cmluZ10+KTogdm9pZCB7XG4gICAgICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcbiAgICAgICAgZm9yIChjb25zdCBbcGF0aCwgY2xpZW50SWRdIG9mIGVudHJpZXMpIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGUuc2V0KHBhdGgsIGNsaWVudElkKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBOb3RlTWV0YWRhdGEgfSBmcm9tICcuLi9kb21haW4vdHlwZXMnO1xuXG4vKipcbiAqIE1pbmltYWwgcmVwcmVzZW50YXRpb24gb2YgT2JzaWRpYW4ncyBDYWNoZWRNZXRhZGF0YVxuICogVXNlZCBmb3IgdHlwZS1zYWZlIGV4dHJhY3Rpb24gd2l0aG91dCBmdWxsIE9ic2lkaWFuIGRlcGVuZGVuY3lcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBPYnNpZGlhbkNhY2hlZE1ldGFkYXRhIHtcbiAgICB0YWdzPzogQXJyYXk8e1xuICAgICAgICB0YWc6IHN0cmluZztcbiAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgIHN0YXJ0OiB7IGxpbmU6IG51bWJlcjsgY29sOiBudW1iZXI7IG9mZnNldDogbnVtYmVyIH07XG4gICAgICAgICAgICBlbmQ6IHsgbGluZTogbnVtYmVyOyBjb2w6IG51bWJlcjsgb2Zmc2V0OiBudW1iZXIgfTtcbiAgICAgICAgfTtcbiAgICB9PjtcbiAgICBoZWFkaW5ncz86IEFycmF5PHtcbiAgICAgICAgaGVhZGluZzogc3RyaW5nO1xuICAgICAgICBsZXZlbDogbnVtYmVyO1xuICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgc3RhcnQ6IHsgbGluZTogbnVtYmVyOyBjb2w6IG51bWJlcjsgb2Zmc2V0OiBudW1iZXIgfTtcbiAgICAgICAgICAgIGVuZDogeyBsaW5lOiBudW1iZXI7IGNvbDogbnVtYmVyOyBvZmZzZXQ6IG51bWJlciB9O1xuICAgICAgICB9O1xuICAgIH0+O1xuICAgIGZyb250bWF0dGVyPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG59XG5cbi8qKlxuICogRXh0cmFjdCBub3RlIG1ldGFkYXRhIGZyb20gT2JzaWRpYW4ncyBjYWNoZWQgbWV0YWRhdGFcbiAqIFxuICogUHVyZSBmdW5jdGlvbiAtIG5vIHNpZGUgZWZmZWN0cywgZWFzaWx5IHRlc3RhYmxlXG4gKiBcbiAqIEBwYXJhbSBjYWNoZWQgLSBPYnNpZGlhbidzIENhY2hlZE1ldGFkYXRhIChvciBudWxsL3VuZGVmaW5lZClcbiAqIEByZXR1cm5zIE5vdGVNZXRhZGF0YSB3aXRoIHRhZ3MsIGhlYWRpbmdzLCBhbmQgZnJvbnRtYXR0ZXJcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBjb25zdCBjYWNoZWQgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gKiBjb25zdCBtZXRhZGF0YSA9IGV4dHJhY3ROb3RlTWV0YWRhdGEoY2FjaGVkKTtcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdE5vdGVNZXRhZGF0YShjYWNoZWQ6IE9ic2lkaWFuQ2FjaGVkTWV0YWRhdGEgfCBudWxsIHwgdW5kZWZpbmVkKTogTm90ZU1ldGFkYXRhIHtcbiAgICBpZiAoIWNhY2hlZCkge1xuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgY29uc3QgbWV0YWRhdGE6IE5vdGVNZXRhZGF0YSA9IHt9O1xuXG4gICAgaWYgKGNhY2hlZC50YWdzKSB7XG4gICAgICAgIG1ldGFkYXRhLnRhZ3MgPSBjYWNoZWQudGFncy5tYXAodGFnID0+ICh7XG4gICAgICAgICAgICB0YWc6IHRhZy50YWcsXG4gICAgICAgICAgICBwb3NpdGlvbjogdGFnLnBvc2l0aW9uLFxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgaWYgKGNhY2hlZC5oZWFkaW5ncykge1xuICAgICAgICBtZXRhZGF0YS5oZWFkaW5ncyA9IGNhY2hlZC5oZWFkaW5ncy5tYXAoaGVhZGluZyA9PiAoe1xuICAgICAgICAgICAgaGVhZGluZzogaGVhZGluZy5oZWFkaW5nLFxuICAgICAgICAgICAgbGV2ZWw6IGhlYWRpbmcubGV2ZWwsXG4gICAgICAgICAgICBwb3NpdGlvbjogaGVhZGluZy5wb3NpdGlvbixcbiAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIGlmIChjYWNoZWQuZnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgbWV0YWRhdGEuZnJvbnRtYXR0ZXIgPSBjYWNoZWQuZnJvbnRtYXR0ZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1ldGFkYXRhO1xufVxuIiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHR5cGUgTWFya2Rvd25CcmFpblBsdWdpbiBmcm9tICcuLi9tYWluJztcblxuZXhwb3J0IGNsYXNzIE1hcmtkb3duQnJhaW5TZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBNYXJrZG93bkJyYWluUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTWFya2Rvd25CcmFpblBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnTWFya2Rvd25CcmFpbiBcdTU0MENcdTZCNjVcdThCQkVcdTdGNkUnIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1NjcwRFx1NTJBMVx1NTY2OFx1NTczMFx1NTc0MCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnTWFya2Rvd25CcmFpbiBcdTY3MERcdTUyQTFcdTU2NjggQVBJIFx1NTczMFx1NTc0MCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2h0dHBzOi8vYXBpLm1hcmtkb3duYnJhaW4uY29tJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VydmVyVXJsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VydmVyVXJsID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTeW5jIEtleScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU0RUNFXHU3QkExXHU3NDA2XHU1NDBFXHU1M0YwXHU4M0I3XHU1M0Q2XHU3Njg0XHU1NDBDXHU2QjY1XHU1QkM2XHU5NEE1JylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigneHh4eHh4eHgteHh4eC14eHh4LXh4eHgteHh4eHh4eHh4eHh4JylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3luY0tleSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmNLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1NkQ0Qlx1OEJENVx1OEZERVx1NjNBNScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU2RDRCXHU4QkQ1XHU0RTBFXHU2NzBEXHU1MkExXHU1NjY4XHU3Njg0XHU4RkRFXHU2M0E1XHVGRjA4MzBcdTc5RDJcdThEODVcdTY1RjZcdUZGMDknKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1NkQ0Qlx1OEJENScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdcdTZENEJcdThCRDVcdTRFMkQuLi4nKTtcblxuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdcdTZCNjNcdTU3MjhcdTZENEJcdThCRDVcdThGREVcdTYzQTUuLi4nKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5zeW5jTWFuYWdlci50ZXN0Q29ubmVjdGlvbigzMDAwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1x1NkQ0Qlx1OEJENScpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2VzcyAmJiByZXN1bHQudmF1bHRJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBcdTI3MDUgXHU4RkRFXHU2M0E1XHU2MjEwXHU1MjlGXHVGRjAxXFxuYCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFZhdWx0OiAke3Jlc3VsdC52YXVsdEluZm8ubmFtZX1cXG5gICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgRG9tYWluOiAke3Jlc3VsdC52YXVsdEluZm8uZG9tYWlufWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgNTAwMFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc0QyBcdThGREVcdTYzQTVcdTU5MzFcdThEMjU6ICR7cmVzdWx0LmVycm9yIHx8ICdVbmtub3duIGVycm9yJ31gLCA1MDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTYyNzlcdTkxQ0ZcdTU0MENcdTZCNjUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1NjI0Qlx1NTJBOFx1NTQwQ1x1NkI2NVx1NjI0MFx1NjcwOSBNYXJrZG93biBcdTY1ODdcdTRFRjZcdTUyMzBcdTY3MERcdTUyQTFcdTU2NjgnKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1NUYwMFx1NTlDQlx1NTQwQ1x1NkI2NScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdcdTU0MENcdTZCNjVcdTRFMkQuLi4nKTtcblxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zeW5jQWxsRmlsZXMoKTtcblxuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0RGlzYWJsZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnXHU1RjAwXHU1OUNCXHU1NDBDXHU2QjY1Jyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1ODFFQVx1NTJBOFx1NTQwQ1x1NkI2NScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU2NTg3XHU0RUY2XHU0RkVFXHU2NTM5XHU2NUY2XHU4MUVBXHU1MkE4XHU1NDBDXHU2QjY1XHU1MjMwXHU2NzBEXHU1MkExXHU1NjY4JylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvU3luYylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9TeW5jID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgVEZpbGUsIEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IGlzQXNzZXRGaWxlIH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgdHlwZSBGaWxlRXZlbnRDYWxsYmFjayA9IChmaWxlOiBURmlsZSwgYWN0aW9uOiAnY3JlYXRlJyB8ICdtb2RpZnknKSA9PiB2b2lkO1xuZXhwb3J0IHR5cGUgRmlsZURlbGV0ZUNhbGxiYWNrID0gKGZpbGU6IFRGaWxlKSA9PiB2b2lkO1xuZXhwb3J0IHR5cGUgRmlsZVJlbmFtZUNhbGxiYWNrID0gKGZpbGU6IFRGaWxlLCBvbGRQYXRoOiBzdHJpbmcpID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBBc3NldEV2ZW50Q2FsbGJhY2sgPSAoZmlsZTogVEZpbGUsIGFjdGlvbjogJ2NyZWF0ZScgfCAnbW9kaWZ5JykgPT4gdm9pZDtcbmV4cG9ydCB0eXBlIEFzc2V0RGVsZXRlQ2FsbGJhY2sgPSAoZmlsZTogVEZpbGUpID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBBc3NldFJlbmFtZUNhbGxiYWNrID0gKGZpbGU6IFRGaWxlLCBvbGRQYXRoOiBzdHJpbmcpID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBNZXRhZGF0YVJlc29sdmVkQ2FsbGJhY2sgPSAoKSA9PiB2b2lkO1xuXG5leHBvcnQgdHlwZSBSZXNvdXJjZUV2ZW50Q2FsbGJhY2sgPSBBc3NldEV2ZW50Q2FsbGJhY2s7XG5leHBvcnQgdHlwZSBSZXNvdXJjZURlbGV0ZUNhbGxiYWNrID0gQXNzZXREZWxldGVDYWxsYmFjaztcbmV4cG9ydCB0eXBlIFJlc291cmNlUmVuYW1lQ2FsbGJhY2sgPSBBc3NldFJlbmFtZUNhbGxiYWNrO1xuXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50SGFuZGxlcnMge1xuICAgIG9uRmlsZUNoYW5nZTogRmlsZUV2ZW50Q2FsbGJhY2s7XG4gICAgb25GaWxlRGVsZXRlOiBGaWxlRGVsZXRlQ2FsbGJhY2s7XG4gICAgb25GaWxlUmVuYW1lOiBGaWxlUmVuYW1lQ2FsbGJhY2s7XG4gICAgb25Bc3NldENoYW5nZTogQXNzZXRFdmVudENhbGxiYWNrO1xuICAgIG9uQXNzZXREZWxldGU6IEFzc2V0RGVsZXRlQ2FsbGJhY2s7XG4gICAgb25Bc3NldFJlbmFtZTogQXNzZXRSZW5hbWVDYWxsYmFjaztcbiAgICBvbk1ldGFkYXRhUmVzb2x2ZWQ6IE1ldGFkYXRhUmVzb2x2ZWRDYWxsYmFjaztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQZW5kaW5nU3luY3NNYW5hZ2VyIHtcbiAgICBhZGQocGF0aDogc3RyaW5nKTogdm9pZDtcbiAgICBjbGVhcigpOiB2b2lkO1xuICAgIGZvckVhY2goY2FsbGJhY2s6IChwYXRoOiBzdHJpbmcpID0+IHZvaWQpOiB2b2lkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJGaWxlRXZlbnRzKFxuICAgIGFwcDogQXBwLFxuICAgIGhhbmRsZXJzOiBFdmVudEhhbmRsZXJzLFxuICAgIHBlbmRpbmdTeW5jczogUGVuZGluZ1N5bmNzTWFuYWdlcixcbiAgICByZWdpc3RlckV2ZW50OiAoZXZlbnQ6IFJldHVyblR5cGU8dHlwZW9mIGFwcC52YXVsdC5vbj4pID0+IHZvaWRcbik6IHZvaWQge1xuICAgIHJlZ2lzdGVyRXZlbnQoXG4gICAgICAgIGFwcC52YXVsdC5vbignY3JlYXRlJywgKGZpbGUpID0+IHtcbiAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlcnMub25GaWxlQ2hhbmdlKGZpbGUsICdjcmVhdGUnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXNzZXRGaWxlKGZpbGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXJzLm9uQXNzZXRDaGFuZ2UoZmlsZSwgJ2NyZWF0ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgcmVnaXN0ZXJFdmVudChcbiAgICAgICAgYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCAoZmlsZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgIGlmIChmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICBwZW5kaW5nU3luY3MuYWRkKGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0Fzc2V0RmlsZShmaWxlKSkge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVycy5vbkFzc2V0Q2hhbmdlKGZpbGUsICdtb2RpZnknKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIHJlZ2lzdGVyRXZlbnQoXG4gICAgICAgIGFwcC5tZXRhZGF0YUNhY2hlLm9uKCdyZXNvbHZlZCcsICgpID0+IHtcbiAgICAgICAgICAgIHBlbmRpbmdTeW5jcy5mb3JFYWNoKChmaWxlUGF0aCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXJzLm9uRmlsZUNoYW5nZShmaWxlLCAnbW9kaWZ5Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwZW5kaW5nU3luY3MuY2xlYXIoKTtcbiAgICAgICAgICAgIGhhbmRsZXJzLm9uTWV0YWRhdGFSZXNvbHZlZCgpO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICByZWdpc3RlckV2ZW50KFxuICAgICAgICBhcHAudmF1bHQub24oJ2RlbGV0ZScsIChmaWxlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXJzLm9uRmlsZURlbGV0ZShmaWxlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXNzZXRGaWxlKGZpbGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXJzLm9uQXNzZXREZWxldGUoZmlsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICk7XG5cbiAgICByZWdpc3RlckV2ZW50KFxuICAgICAgICBhcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXJzLm9uRmlsZVJlbmFtZShmaWxlLCBvbGRQYXRoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXNzZXRGaWxlKGZpbGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXJzLm9uQXNzZXRSZW5hbWUoZmlsZSwgb2xkUGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICk7XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUEyRDs7O0FDQTNELHNCQUFzQztBQUUvQixJQUFNLGdCQUFnQjtBQUU3QixlQUFzQixvQkFDcEIsTUFDQSxTQUNBLEtBQ2lCO0FBUm5CO0FBU0UsUUFBTSxRQUFRLElBQUksY0FBYyxhQUFhLElBQUk7QUFDakQsT0FBSSxvQ0FBTyxnQkFBUCxtQkFBcUIsZ0JBQWdCO0FBQ3ZDLFdBQU8sT0FBTyxNQUFNLFlBQVksYUFBYSxDQUFDLEVBQUUsS0FBSztBQUFBLEVBQ3ZEO0FBRUEsUUFBTSxjQUFjLE1BQU0sSUFBSSxNQUFNLEtBQUssSUFBSTtBQUM3QyxRQUFNLGdCQUFnQixlQUFlO0FBRXJDLFFBQU0sbUJBQW1CLGNBQWMsTUFBTSx1QkFBdUI7QUFDcEUsTUFBSSxrQkFBa0I7QUFDcEIsUUFBSTtBQUNGLFlBQU0sa0JBQWMsMkJBQVUsaUJBQWlCLENBQUMsQ0FBQztBQUNqRCxVQUFJLDJDQUFjLGdCQUFnQjtBQUNoQyxlQUFPLE9BQU8sWUFBWSxhQUFhLENBQUMsRUFBRSxLQUFLO0FBQUEsTUFDakQ7QUFBQSxJQUNGLFNBQVE7QUFBQSxJQUVSO0FBQUEsRUFDRjtBQUVBLFFBQU0sUUFBUSxPQUFPLFdBQVc7QUFFaEMsUUFBTSxJQUFJLFlBQVksbUJBQW1CLE1BQU0sQ0FBQyxnQkFBZ0I7QUFDOUQsZ0JBQVksYUFBYSxJQUFJO0FBQUEsRUFDL0IsQ0FBQztBQUVELFNBQU87QUFDVDs7O0FDbkJPLElBQU0sbUJBQTBDO0FBQUEsRUFDckQsV0FBVztBQUFBLEVBQ1gsU0FBUztBQUFBLEVBQ1QsVUFBVTtBQUNaOzs7QUNyQk8sSUFBTSxtQkFBbUIsb0JBQUksSUFBSTtBQUFBLEVBQ3RDO0FBQUEsRUFBTztBQUFBLEVBQU87QUFBQSxFQUFRO0FBQUEsRUFBTztBQUFBLEVBQVE7QUFBQSxFQUFPO0FBQUEsRUFBTztBQUFBLEVBQ25EO0FBQUEsRUFDQTtBQUFBLEVBQU87QUFBQSxFQUFPO0FBQUEsRUFDZDtBQUFBLEVBQU87QUFDVCxDQUFDO0FBUU0sU0FBUyxZQUFZLE1BQWtDO0FBQzVELFNBQU8saUJBQWlCLElBQUksS0FBSyxVQUFVLFlBQVksQ0FBQztBQUMxRDs7O0FDTE8sSUFBTSxhQUFxQztBQUFBO0FBQUEsRUFFaEQsT0FBTztBQUFBLEVBQ1AsT0FBTztBQUFBLEVBQ1AsUUFBUTtBQUFBLEVBQ1IsT0FBTztBQUFBLEVBQ1AsUUFBUTtBQUFBLEVBQ1IsT0FBTztBQUFBLEVBQ1AsT0FBTztBQUFBLEVBQ1AsT0FBTztBQUFBO0FBQUEsRUFFUCxPQUFPO0FBQUE7QUFBQSxFQUVQLE9BQU87QUFBQSxFQUNQLE9BQU87QUFBQSxFQUNQLE9BQU87QUFBQTtBQUFBLEVBRVAsT0FBTztBQUFBLEVBQ1AsUUFBUTtBQUNWO0FBT08sU0FBUyxlQUFlLFdBQTJCO0FBQ3hELFFBQU0sTUFBTSxVQUFVLFlBQVk7QUFDbEMsU0FBTyxXQUFXLEdBQUcsS0FBSztBQUM1Qjs7O0FDM0JBLGVBQXNCLG9CQUFvQixRQUFzQztBQUM5RSxRQUFNLFFBQVEsSUFBSSxXQUFXLE1BQU07QUFDbkMsTUFBSSxTQUFTO0FBQ2IsV0FBUyxJQUFJLEdBQUcsSUFBSSxNQUFNLFlBQVksS0FBSztBQUN6QyxjQUFVLE9BQU8sYUFBYSxNQUFNLENBQUMsQ0FBQztBQUFBLEVBQ3hDO0FBQ0EsU0FBTyxLQUFLLE1BQU07QUFDcEI7OztBQ1BBLGVBQXNCLFdBQVcsUUFBc0M7QUFDckUsUUFBTSxhQUFhLE1BQU0sT0FBTyxPQUFPLE9BQU8sV0FBVyxNQUFNO0FBQy9ELFFBQU0sWUFBWSxNQUFNLEtBQUssSUFBSSxXQUFXLFVBQVUsQ0FBQztBQUN2RCxTQUFPLFVBQVUsSUFBSSxPQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsU0FBUyxHQUFHLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRTtBQUNwRTtBQU9BLGVBQXNCLFdBQVcsS0FBOEI7QUFDN0QsUUFBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxRQUFNLE9BQU8sUUFBUSxPQUFPLEdBQUc7QUFDL0IsU0FBTyxXQUFXLEtBQUssTUFBTTtBQUMvQjs7O0FDZ0JPLElBQU0sZ0JBQU4sTUFBdUM7QUFBQSxFQUk1QyxZQUFZLFFBQW9CLFlBQXdCO0FBQ3RELFNBQUssU0FBUztBQUNkLFNBQUssT0FBTztBQUFBLEVBQ2Q7QUFBQSxFQUVBLGFBQWEsUUFBMEI7QUFDckMsU0FBSyxTQUFTO0FBQUEsRUFDaEI7QUFBQSxFQUVBLE1BQU0sZUFBZSxVQUFrQixLQUFzQztBQUMzRSxRQUFJO0FBQ0YsWUFBTSxXQUFXLE1BQU0sS0FBSyxLQUFLLFFBQVE7QUFBQSxRQUN2QyxLQUFLLEdBQUcsS0FBSyxPQUFPLFNBQVM7QUFBQSxRQUM3QixRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUCxpQkFBaUIsVUFBVSxLQUFLLE9BQU8sT0FBTztBQUFBLFFBQ2hEO0FBQUEsTUFDRixDQUFDO0FBRUQsVUFBSSxTQUFTLFdBQVcsS0FBSztBQUMzQixjQUFNLE9BQU8sU0FBUztBQUN0QixlQUFPO0FBQUEsVUFDTCxTQUFTO0FBQUEsVUFDVCxXQUFXLEtBQUs7QUFBQSxRQUNsQjtBQUFBLE1BQ0YsT0FBTztBQUNMLGVBQU87QUFBQSxVQUNMLFNBQVM7QUFBQSxVQUNULE9BQU8sUUFBUSxTQUFTLE1BQU0sS0FBSyxTQUFTLFFBQVEsZUFBZTtBQUFBLFFBQ3JFO0FBQUEsTUFDRjtBQUFBLElBQ0YsU0FBUyxPQUFnQjtBQUN2QixVQUFJLFNBQVMsT0FBTyxVQUFVLFlBQVksVUFBVSxTQUFTLE1BQU0sU0FBUyxjQUFjO0FBQ3hGLGVBQU87QUFBQSxVQUNMLFNBQVM7QUFBQSxVQUNULE9BQU8saUNBQVEsVUFBVSxHQUFJO0FBQUEsUUFDL0I7QUFBQSxNQUNGO0FBQ0EsYUFBTztBQUFBLFFBQ0wsU0FBUztBQUFBLFFBQ1QsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxNQUNsRDtBQUFBLElBQ0Y7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFNLFNBQVMsTUFBcUM7QUE1RnREO0FBNkZJLFlBQVEsSUFBSSxrQ0FBa0M7QUFBQSxNQUM1QyxNQUFNLEtBQUs7QUFBQSxNQUNYLFFBQVEsS0FBSztBQUFBLE1BQ2IsWUFBWSxDQUFDLENBQUMsS0FBSztBQUFBLE1BQ25CLGdCQUFlLFVBQUssWUFBTCxtQkFBYztBQUFBLE1BQzdCLFdBQVcsS0FBSyxPQUFPO0FBQUEsTUFDdkIsWUFBWSxDQUFDLENBQUMsS0FBSyxPQUFPO0FBQUEsSUFDNUIsQ0FBQztBQUVELFFBQUk7QUFDRixZQUFNLGNBQWMsS0FBSyxVQUFVLElBQUk7QUFDdkMsY0FBUSxJQUFJLHNDQUFzQyxZQUFZLFFBQVEsT0FBTztBQUU3RSxZQUFNLFdBQVcsTUFBTSxLQUFLLEtBQUssUUFBUTtBQUFBLFFBQ3ZDLEtBQUssR0FBRyxLQUFLLE9BQU8sU0FBUztBQUFBLFFBQzdCLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNQLGdCQUFnQjtBQUFBLFVBQ2hCLGlCQUFpQixVQUFVLEtBQUssT0FBTyxPQUFPO0FBQUEsUUFDaEQ7QUFBQSxRQUNBLE1BQU07QUFBQSxNQUNSLENBQUM7QUFFRCxjQUFRLElBQUksNkJBQTZCO0FBQUEsUUFDdkMsUUFBUSxTQUFTO0FBQUEsUUFDakIsY0FBYSxjQUFTLFNBQVQsbUJBQWUsVUFBVSxHQUFHO0FBQUEsTUFDM0MsQ0FBQztBQUVELFVBQUksU0FBUyxXQUFXLEtBQUs7QUFDM0IsZ0JBQVEsSUFBSSwyQ0FBc0MsS0FBSyxJQUFJO0FBQzNELGVBQU8sRUFBRSxTQUFTLEtBQUs7QUFBQSxNQUN6QixPQUFPO0FBQ0wsY0FBTSxXQUFXLFFBQVEsU0FBUyxNQUFNLEtBQUssU0FBUyxRQUFRLGFBQWE7QUFDM0UsZ0JBQVEsTUFBTSx1Q0FBa0M7QUFBQSxVQUM5QyxNQUFNLEtBQUs7QUFBQSxVQUNYLFFBQVEsU0FBUztBQUFBLFVBQ2pCLE9BQU87QUFBQSxVQUNQLGNBQWMsU0FBUztBQUFBLFFBQ3pCLENBQUM7QUFDRCxlQUFPO0FBQUEsVUFDTCxTQUFTO0FBQUEsVUFDVCxPQUFPO0FBQUEsUUFDVDtBQUFBLE1BQ0Y7QUFBQSxJQUNGLFNBQVMsT0FBTztBQUNkLGNBQVEsTUFBTSwwQ0FBcUM7QUFBQSxRQUNqRCxNQUFNLEtBQUs7QUFBQSxRQUNYO0FBQUEsUUFDQSxjQUFjLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLFFBQ3ZELFlBQVksaUJBQWlCLFFBQVEsTUFBTSxRQUFRO0FBQUEsTUFDckQsQ0FBQztBQUNELGFBQU87QUFBQSxRQUNMLFNBQVM7QUFBQSxRQUNULE9BQU8saUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsTUFDbEQ7QUFBQSxJQUNGO0FBQUEsRUFDRjtBQUFBLEVBRUEsTUFBTSxTQUFTLFdBQWdEO0FBQzdELFlBQVEsSUFBSSx5Q0FBeUM7QUFBQSxNQUNuRCxpQkFBaUIsVUFBVTtBQUFBLElBQzdCLENBQUM7QUFFRCxRQUFJO0FBQ0YsWUFBTSxjQUErQixFQUFFLFVBQVU7QUFDakQsWUFBTSxXQUFXLE1BQU0sS0FBSyxLQUFLLFFBQVE7QUFBQSxRQUN2QyxLQUFLLEdBQUcsS0FBSyxPQUFPLFNBQVM7QUFBQSxRQUM3QixRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDUCxnQkFBZ0I7QUFBQSxVQUNoQixpQkFBaUIsVUFBVSxLQUFLLE9BQU8sT0FBTztBQUFBLFFBQ2hEO0FBQUEsUUFDQSxNQUFNLEtBQUssVUFBVSxXQUFXO0FBQUEsTUFDbEMsQ0FBQztBQUdELFVBQUksU0FBUyxXQUFXLEtBQUs7QUFDM0IsZ0JBQVEsS0FBSyxrRkFBa0Y7QUFDL0YsZUFBTztBQUFBLFVBQ0wsU0FBUztBQUFBLFVBQ1QsTUFBTTtBQUFBLFlBQ0osWUFBWTtBQUFBLFlBQ1osUUFBUTtBQUFBLFlBQ1IsZ0JBQWdCLFVBQVU7QUFBQSxZQUMxQixpQkFBaUI7QUFBQSxZQUNqQixtQkFBbUIsVUFBVTtBQUFBLFVBQy9CO0FBQUEsUUFDRjtBQUFBLE1BQ0Y7QUFFQSxVQUFJLFNBQVMsV0FBVyxLQUFLO0FBQzNCLGNBQU0sT0FBTyxTQUFTO0FBQ3RCLGdCQUFRLElBQUksZ0RBQTJDO0FBQUEsVUFDckQsY0FBYyw2QkFBTztBQUFBLFVBQ3JCLGdCQUFnQiw2QkFBTztBQUFBLFFBQ3pCLENBQUM7QUFDRCxlQUFPO0FBQUEsVUFDTCxTQUFTO0FBQUEsVUFDVDtBQUFBLFFBQ0Y7QUFBQSxNQUNGLE9BQU87QUFDTCxjQUFNLFdBQVcsUUFBUSxTQUFTLE1BQU0sS0FBSyxTQUFTLFFBQVEsa0JBQWtCO0FBQ2hGLGdCQUFRLE1BQU0sNENBQXVDO0FBQUEsVUFDbkQsUUFBUSxTQUFTO0FBQUEsVUFDakIsT0FBTztBQUFBLFFBQ1QsQ0FBQztBQUNELGVBQU87QUFBQSxVQUNMLFNBQVM7QUFBQSxVQUNULE9BQU87QUFBQSxRQUNUO0FBQUEsTUFDRjtBQUFBLElBQ0YsU0FBUyxPQUFPO0FBQ2QsWUFBTSxXQUFXLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUMxRCxjQUFRLE1BQU0sK0NBQTBDO0FBQUEsUUFDdEQsT0FBTztBQUFBLE1BQ1QsQ0FBQztBQUNELGFBQU87QUFBQSxRQUNMLFNBQVM7QUFBQSxRQUNULE9BQU87QUFBQSxNQUNUO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFBQSxFQUVBLE1BQU0sVUFBVSxNQUEwQztBQUN4RCxZQUFRLElBQUksd0NBQXdDO0FBQUEsTUFDbEQsTUFBTSxLQUFLO0FBQUEsTUFDWCxVQUFVLEtBQUs7QUFBQSxNQUNmLFFBQVEsS0FBSztBQUFBLE1BQ2IsYUFBYSxLQUFLO0FBQUEsTUFDbEIsTUFBTSxLQUFLO0FBQUEsSUFDYixDQUFDO0FBRUQsUUFBSTtBQUNGLFlBQU0sV0FBVyxNQUFNLEtBQUssS0FBSyxRQUFRO0FBQUEsUUFDdkMsS0FBSyxHQUFHLEtBQUssT0FBTyxTQUFTO0FBQUEsUUFDN0IsUUFBUTtBQUFBLFFBQ1IsU0FBUztBQUFBLFVBQ1AsZ0JBQWdCO0FBQUEsVUFDaEIsaUJBQWlCLFVBQVUsS0FBSyxPQUFPLE9BQU87QUFBQSxRQUNoRDtBQUFBLFFBQ0EsTUFBTSxLQUFLLFVBQVUsSUFBSTtBQUFBLE1BQzNCLENBQUM7QUFFRCxVQUFJLFNBQVMsV0FBVyxLQUFLO0FBQzNCLGdCQUFRLElBQUksaURBQTRDLEtBQUssSUFBSTtBQUNqRSxlQUFPLEVBQUUsU0FBUyxLQUFLO0FBQUEsTUFDekIsT0FBTztBQUNMLGNBQU0sV0FBVyxRQUFRLFNBQVMsTUFBTSxLQUFLLFNBQVMsUUFBUSxtQkFBbUI7QUFDakYsZ0JBQVEsTUFBTSw2Q0FBd0M7QUFBQSxVQUNwRCxNQUFNLEtBQUs7QUFBQSxVQUNYLFFBQVEsU0FBUztBQUFBLFVBQ2pCLE9BQU87QUFBQSxRQUNULENBQUM7QUFDRCxlQUFPLEVBQUUsU0FBUyxPQUFPLE9BQU8sU0FBUztBQUFBLE1BQzNDO0FBQUEsSUFDRixTQUFTLE9BQU87QUFDZCxjQUFRLE1BQU0sZ0RBQTJDO0FBQUEsUUFDdkQsTUFBTSxLQUFLO0FBQUEsUUFDWCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ2xELENBQUM7QUFDRCxhQUFPO0FBQUEsUUFDTCxTQUFTO0FBQUEsUUFDVCxPQUFPLGlCQUFpQixRQUFRLE1BQU0sVUFBVTtBQUFBLE1BQ2xEO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFBQSxFQUVBLFVBQWdCO0FBQUEsRUFFaEI7QUFDRjs7O0FDalFBLElBQUFDLG1CQUEyQjtBQUdwQixJQUFNLHFCQUFOLE1BQStDO0FBQUEsRUFDcEQsTUFBTSxRQUFRLEtBQXlDO0FBQ3JELFVBQU0sV0FBVyxVQUFNLDZCQUFXO0FBQUEsTUFDaEMsS0FBSyxJQUFJO0FBQUEsTUFDVCxRQUFRLElBQUk7QUFBQSxNQUNaLFNBQVMsSUFBSTtBQUFBLE1BQ2IsTUFBTSxJQUFJO0FBQUEsTUFDVixPQUFPO0FBQUEsSUFDVCxDQUFDO0FBRUQsV0FBTztBQUFBLE1BQ0wsUUFBUSxTQUFTO0FBQUEsTUFDakIsTUFBTSxTQUFTO0FBQUEsTUFDZixNQUFNLFNBQVM7QUFBQSxJQUNqQjtBQUFBLEVBQ0Y7QUFDRjs7O0FDYk8sSUFBTSxzQkFBb0M7QUFBQSxFQUM3QyxZQUFZLENBQUMsVUFBVSxVQUFVLFdBQVcsVUFBVSxLQUFLO0FBQUEsRUFDM0QsY0FBYyxDQUFDLE9BQU8sYUFBYSxFQUFFO0FBQ3pDO0FBZ0JPLElBQU0sa0JBQU4sTUFBc0I7QUFBQSxFQUl6QixZQUFZLGVBQTZCLHFCQUFxQjtBQUMxRCxTQUFLLFNBQVMsb0JBQUksSUFBSTtBQUN0QixTQUFLLGVBQWU7QUFBQSxFQUN4QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxTQUFTLEtBQWEsVUFBc0IsT0FBcUI7QUFFN0QsVUFBTSxnQkFBZ0IsS0FBSyxPQUFPLElBQUksR0FBRztBQUN6QyxRQUFJLGtCQUFrQixRQUFXO0FBQzdCLFdBQUssYUFBYSxhQUFhLGFBQWE7QUFBQSxJQUNoRDtBQUdBLFVBQU0sUUFBUSxLQUFLLGFBQWEsV0FBVyxNQUFNO0FBQzdDLFdBQUssT0FBTyxPQUFPLEdBQUc7QUFDdEIsZUFBUztBQUFBLElBQ2IsR0FBRyxLQUFLO0FBRVIsU0FBSyxPQUFPLElBQUksS0FBSyxLQUFLO0FBQUEsRUFDOUI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLE9BQU8sS0FBbUI7QUFDdEIsVUFBTSxRQUFRLEtBQUssT0FBTyxJQUFJLEdBQUc7QUFDakMsUUFBSSxVQUFVLFFBQVc7QUFDckIsV0FBSyxhQUFhLGFBQWEsS0FBSztBQUNwQyxXQUFLLE9BQU8sT0FBTyxHQUFHO0FBQUEsSUFDMUI7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxXQUFpQjtBQUNiLGVBQVcsU0FBUyxLQUFLLE9BQU8sT0FBTyxHQUFHO0FBQ3RDLFdBQUssYUFBYSxhQUFhLEtBQUs7QUFBQSxJQUN4QztBQUNBLFNBQUssT0FBTyxNQUFNO0FBQUEsRUFDdEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLElBQUksS0FBc0I7QUFDdEIsV0FBTyxLQUFLLE9BQU8sSUFBSSxHQUFHO0FBQUEsRUFDOUI7QUFDSjs7O0FDbEVPLElBQU0sZ0JBQU4sTUFBb0I7QUFBQSxFQUd2QixjQUFjO0FBQ1YsU0FBSyxRQUFRLG9CQUFJLElBQUk7QUFBQSxFQUN6QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsSUFBSSxNQUFrQztBQUNsQyxXQUFPLEtBQUssTUFBTSxJQUFJLElBQUk7QUFBQSxFQUM5QjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsSUFBSSxNQUFjLFVBQXdCO0FBQ3RDLFNBQUssTUFBTSxJQUFJLE1BQU0sUUFBUTtBQUFBLEVBQ2pDO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxJQUFJLE1BQXVCO0FBQ3ZCLFdBQU8sS0FBSyxNQUFNLElBQUksSUFBSTtBQUFBLEVBQzlCO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxPQUFPLE1BQW9CO0FBQ3ZCLFNBQUssTUFBTSxPQUFPLElBQUk7QUFBQSxFQUMxQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsT0FBTyxTQUFpQixTQUF1QjtBQUMzQyxVQUFNLFdBQVcsS0FBSyxNQUFNLElBQUksT0FBTztBQUN2QyxRQUFJLGFBQWEsUUFBVztBQUN4QixXQUFLLE1BQU0sT0FBTyxPQUFPO0FBQ3pCLFdBQUssTUFBTSxJQUFJLFNBQVMsUUFBUTtBQUFBLElBQ3BDO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsUUFBYztBQUNWLFNBQUssTUFBTSxNQUFNO0FBQUEsRUFDckI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLElBQUksT0FBZTtBQUNmLFdBQU8sS0FBSyxNQUFNO0FBQUEsRUFDdEI7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLFVBQW1DO0FBQy9CLFdBQU8sTUFBTSxLQUFLLEtBQUssTUFBTSxRQUFRLENBQUM7QUFBQSxFQUMxQztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0Esa0JBQTRCO0FBQ3hCLFdBQU8sTUFBTSxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUM7QUFBQSxFQUN6QztBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsaUJBQWlCLFNBQXdDO0FBQ3JELFNBQUssTUFBTSxNQUFNO0FBQ2pCLGVBQVcsQ0FBQyxNQUFNLFFBQVEsS0FBSyxTQUFTO0FBQ3BDLFdBQUssTUFBTSxJQUFJLE1BQU0sUUFBUTtBQUFBLElBQ2pDO0FBQUEsRUFDSjtBQUNKOzs7QUNqRU8sU0FBUyxvQkFBb0IsUUFBaUU7QUFDakcsTUFBSSxDQUFDLFFBQVE7QUFDVCxXQUFPLENBQUM7QUFBQSxFQUNaO0FBRUEsUUFBTSxXQUF5QixDQUFDO0FBRWhDLE1BQUksT0FBTyxNQUFNO0FBQ2IsYUFBUyxPQUFPLE9BQU8sS0FBSyxJQUFJLFVBQVE7QUFBQSxNQUNwQyxLQUFLLElBQUk7QUFBQSxNQUNULFVBQVUsSUFBSTtBQUFBLElBQ2xCLEVBQUU7QUFBQSxFQUNOO0FBRUEsTUFBSSxPQUFPLFVBQVU7QUFDakIsYUFBUyxXQUFXLE9BQU8sU0FBUyxJQUFJLGNBQVk7QUFBQSxNQUNoRCxTQUFTLFFBQVE7QUFBQSxNQUNqQixPQUFPLFFBQVE7QUFBQSxNQUNmLFVBQVUsUUFBUTtBQUFBLElBQ3RCLEVBQUU7QUFBQSxFQUNOO0FBRUEsTUFBSSxPQUFPLGFBQWE7QUFDcEIsYUFBUyxjQUFjLE9BQU87QUFBQSxFQUNsQztBQUVBLFNBQU87QUFDWDs7O0FDbEVBLElBQUFDLG1CQUF1RDtBQUdoRCxJQUFNLDBCQUFOLGNBQXNDLGtDQUFpQjtBQUFBLEVBRzFELFlBQVksS0FBVSxRQUE2QjtBQUMvQyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNsQjtBQUFBLEVBRUEsVUFBZ0I7QUFDWixVQUFNLEVBQUUsWUFBWSxJQUFJO0FBRXhCLGdCQUFZLE1BQU07QUFDbEIsZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFBTSx5Q0FBcUIsQ0FBQztBQUV6RCxRQUFJLHlCQUFRLFdBQVcsRUFDbEIsUUFBUSxnQ0FBTyxFQUNmLFFBQVEsbURBQTBCLEVBQ2xDLFFBQVEsVUFBUSxLQUNaLGVBQWUsK0JBQStCLEVBQzlDLFNBQVMsS0FBSyxPQUFPLFNBQVMsU0FBUyxFQUN2QyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxZQUFZO0FBQ2pDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHlCQUFRLFdBQVcsRUFDbEIsUUFBUSxVQUFVLEVBQ2xCLFFBQVEsMEVBQWMsRUFDdEIsUUFBUSxVQUFRLEtBQ1osZUFBZSxzQ0FBc0MsRUFDckQsU0FBUyxLQUFLLE9BQU8sU0FBUyxPQUFPLEVBQ3JDLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLFVBQVU7QUFDL0IsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ25DLENBQUMsQ0FBQztBQUVWLFFBQUkseUJBQVEsV0FBVyxFQUNsQixRQUFRLDBCQUFNLEVBQ2QsUUFBUSx3RkFBa0IsRUFDMUIsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsY0FBSSxFQUNsQixRQUFRLFlBQVk7QUFDakIsYUFBTyxZQUFZLElBQUk7QUFDdkIsYUFBTyxjQUFjLHVCQUFRO0FBRTdCLFVBQUksd0JBQU8seUNBQVc7QUFFdEIsWUFBTSxTQUFTLE1BQU0sS0FBSyxPQUFPLFlBQVksZUFBZSxHQUFLO0FBRWpFLGFBQU8sWUFBWSxLQUFLO0FBQ3hCLGFBQU8sY0FBYyxjQUFJO0FBRXpCLFVBQUksT0FBTyxXQUFXLE9BQU8sV0FBVztBQUNwQyxZQUFJO0FBQUEsVUFDQTtBQUFBLFNBQ1UsT0FBTyxVQUFVLElBQUk7QUFBQSxVQUNwQixPQUFPLFVBQVUsTUFBTTtBQUFBLFVBQ2xDO0FBQUEsUUFDSjtBQUFBLE1BQ0osT0FBTztBQUNILFlBQUksd0JBQU8sb0NBQVcsT0FBTyxTQUFTLGVBQWUsSUFBSSxHQUFJO0FBQUEsTUFDakU7QUFBQSxJQUNKLENBQUMsQ0FBQztBQUVWLFFBQUkseUJBQVEsV0FBVyxFQUNsQixRQUFRLDBCQUFNLEVBQ2QsUUFBUSxvRkFBd0IsRUFDaEMsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsMEJBQU0sRUFDcEIsUUFBUSxZQUFZO0FBQ2pCLGFBQU8sWUFBWSxJQUFJO0FBQ3ZCLGFBQU8sY0FBYyx1QkFBUTtBQUU3QixZQUFNLEtBQUssT0FBTyxhQUFhO0FBRS9CLGFBQU8sWUFBWSxLQUFLO0FBQ3hCLGFBQU8sY0FBYywwQkFBTTtBQUFBLElBQy9CLENBQUMsQ0FBQztBQUVWLFFBQUkseUJBQVEsV0FBVyxFQUNsQixRQUFRLDBCQUFNLEVBQ2QsUUFBUSxnRkFBZSxFQUN2QixVQUFVLFlBQVUsT0FDaEIsU0FBUyxLQUFLLE9BQU8sU0FBUyxRQUFRLEVBQ3RDLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLFdBQVc7QUFDaEMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ25DLENBQUMsQ0FBQztBQUFBLEVBQ2Q7QUFDSjs7O0FDNUZBLElBQUFDLG1CQUEyQjtBQStCcEIsU0FBUyxtQkFDWixLQUNBLFVBQ0EsY0FDQSxlQUNJO0FBQ0o7QUFBQSxJQUNJLElBQUksTUFBTSxHQUFHLFVBQVUsQ0FBQyxTQUFTO0FBQzdCLFVBQUksZ0JBQWdCLHdCQUFPO0FBQ3ZCLFlBQUksS0FBSyxjQUFjLE1BQU07QUFDekIsbUJBQVMsYUFBYSxNQUFNLFFBQVE7QUFBQSxRQUN4QyxXQUFXLFlBQVksSUFBSSxHQUFHO0FBQzFCLG1CQUFTLGNBQWMsTUFBTSxRQUFRO0FBQUEsUUFDekM7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUVBO0FBQUEsSUFDSSxJQUFJLE1BQU0sR0FBRyxVQUFVLENBQUMsU0FBUztBQUM3QixVQUFJLGdCQUFnQix3QkFBTztBQUN2QixZQUFJLEtBQUssY0FBYyxNQUFNO0FBQ3pCLHVCQUFhLElBQUksS0FBSyxJQUFJO0FBQUEsUUFDOUIsV0FBVyxZQUFZLElBQUksR0FBRztBQUMxQixtQkFBUyxjQUFjLE1BQU0sUUFBUTtBQUFBLFFBQ3pDO0FBQUEsTUFDSjtBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFFQTtBQUFBLElBQ0ksSUFBSSxjQUFjLEdBQUcsWUFBWSxNQUFNO0FBQ25DLG1CQUFhLFFBQVEsQ0FBQyxhQUFhO0FBQy9CLGNBQU0sT0FBTyxJQUFJLE1BQU0sc0JBQXNCLFFBQVE7QUFDckQsWUFBSSxnQkFBZ0Isd0JBQU87QUFDdkIsbUJBQVMsYUFBYSxNQUFNLFFBQVE7QUFBQSxRQUN4QztBQUFBLE1BQ0osQ0FBQztBQUNELG1CQUFhLE1BQU07QUFDbkIsZUFBUyxtQkFBbUI7QUFBQSxJQUNoQyxDQUFDO0FBQUEsRUFDTDtBQUVBO0FBQUEsSUFDSSxJQUFJLE1BQU0sR0FBRyxVQUFVLENBQUMsU0FBUztBQUM3QixVQUFJLGdCQUFnQix3QkFBTztBQUN2QixZQUFJLEtBQUssY0FBYyxNQUFNO0FBQ3pCLG1CQUFTLGFBQWEsSUFBSTtBQUFBLFFBQzlCLFdBQVcsWUFBWSxJQUFJLEdBQUc7QUFDMUIsbUJBQVMsY0FBYyxJQUFJO0FBQUEsUUFDL0I7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUVBO0FBQUEsSUFDSSxJQUFJLE1BQU0sR0FBRyxVQUFVLENBQUMsTUFBTSxZQUFZO0FBQ3RDLFVBQUksZ0JBQWdCLHdCQUFPO0FBQ3ZCLFlBQUksS0FBSyxjQUFjLE1BQU07QUFDekIsbUJBQVMsYUFBYSxNQUFNLE9BQU87QUFBQSxRQUN2QyxXQUFXLFlBQVksSUFBSSxHQUFHO0FBQzFCLG1CQUFTLGNBQWMsTUFBTSxPQUFPO0FBQUEsUUFDeEM7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUNKOzs7QWJwRkEsSUFBcUIsc0JBQXJCLGNBQWlELHdCQUFPO0FBQUEsRUFRcEQsWUFBWSxLQUFVLFVBQTBCO0FBQzVDLFVBQU0sS0FBSyxRQUFRO0FBQ25CLFNBQUssa0JBQWtCLElBQUksZ0JBQWdCO0FBQzNDLFNBQUssZUFBZSxvQkFBSSxJQUFJO0FBQzVCLFNBQUssZ0JBQWdCLElBQUksY0FBYztBQUN2QyxTQUFLLHFCQUFxQixJQUFJLGNBQWM7QUFBQSxFQUNoRDtBQUFBLEVBRUEsTUFBTSxTQUFTO0FBN0JuQjtBQThCUSxZQUFRLElBQUksMERBQTBEO0FBQ3RFLFlBQVEsSUFBSSxtQ0FBbUM7QUFFL0MsVUFBTSxLQUFLLGFBQWE7QUFFeEIsWUFBUSxJQUFJLG9DQUFvQztBQUFBLE1BQzVDLFdBQVcsS0FBSyxTQUFTO0FBQUEsTUFDekIsWUFBWSxDQUFDLENBQUMsS0FBSyxTQUFTO0FBQUEsTUFDNUIsZ0JBQWUsVUFBSyxTQUFTLFlBQWQsbUJBQXVCO0FBQUEsTUFDdEMsVUFBVSxLQUFLLFNBQVM7QUFBQSxJQUM1QixDQUFDO0FBR0QsVUFBTSxhQUFhLElBQUksbUJBQW1CO0FBQzFDLFNBQUssY0FBYyxJQUFJLGNBQWM7QUFBQSxNQUNqQyxXQUFXLEtBQUssU0FBUztBQUFBLE1BQ3pCLFNBQVMsS0FBSyxTQUFTO0FBQUEsSUFDM0IsR0FBRyxVQUFVO0FBQ2IsWUFBUSxJQUFJLHlDQUF5QztBQUVyRDtBQUFBLE1BQ0ksS0FBSztBQUFBLE1BQ0w7QUFBQSxRQUNJLGNBQWMsQ0FBQyxNQUFNLFdBQVcsS0FBSyxpQkFBaUIsTUFBTSxNQUFNO0FBQUEsUUFDbEUsY0FBYyxDQUFDLFNBQVMsS0FBSyxpQkFBaUIsSUFBSTtBQUFBLFFBQ2xELGNBQWMsQ0FBQyxNQUFNLFlBQVksS0FBSyxpQkFBaUIsTUFBTSxPQUFPO0FBQUEsUUFDcEUsZUFBZSxDQUFDLE1BQU0sV0FBVyxLQUFLLGtCQUFrQixNQUFNLE1BQU07QUFBQSxRQUNwRSxlQUFlLENBQUMsU0FBUyxLQUFLLGtCQUFrQixJQUFJO0FBQUEsUUFDcEQsZUFBZSxDQUFDLE1BQU0sWUFBWSxLQUFLLGtCQUFrQixNQUFNLE9BQU87QUFBQSxRQUN0RSxvQkFBb0IsTUFBTTtBQUFBLFFBQUM7QUFBQSxNQUMvQjtBQUFBLE1BQ0E7QUFBQSxRQUNJLEtBQUssQ0FBQyxTQUFTLEtBQUssYUFBYSxJQUFJLElBQUk7QUFBQSxRQUN6QyxPQUFPLE1BQU0sS0FBSyxhQUFhLE1BQU07QUFBQSxRQUNyQyxTQUFTLENBQUMsT0FBTyxLQUFLLGFBQWEsUUFBUSxFQUFFO0FBQUEsTUFDakQ7QUFBQSxNQUNBLENBQUMsVUFBVSxLQUFLLGNBQWMsS0FBSztBQUFBLElBQ3ZDO0FBQ0EsWUFBUSxJQUFJLHdDQUF3QztBQUdwRCxTQUFLLGNBQWMsSUFBSSx3QkFBd0IsS0FBSyxLQUFLLElBQUksQ0FBQztBQUM5RCxZQUFRLElBQUksb0NBQW9DO0FBR2hELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNO0FBQ1osY0FBTSxPQUFPLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFDOUMsWUFBSSxNQUFNO0FBQ04sZUFBSyxpQkFBaUIsTUFBTSxRQUFRO0FBQUEsUUFDeEM7QUFBQSxNQUNKO0FBQUEsSUFDSixDQUFDO0FBR0QsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU07QUFDWixhQUFLLGFBQWE7QUFBQSxNQUN0QjtBQUFBLElBQ0osQ0FBQztBQUNELFlBQVEsSUFBSSxxQ0FBcUM7QUFFakQsVUFBTSxLQUFLLG1CQUFtQjtBQUU5QixZQUFRLElBQUksbURBQThDO0FBQzFELFlBQVEsSUFBSSwwREFBMEQ7QUFBQSxFQUMxRTtBQUFBLEVBRUEsTUFBYyxxQkFBb0M7QUF0R3REO0FBdUdRLFVBQU0sUUFBUSxLQUFLLElBQUksTUFBTSxpQkFBaUI7QUFDOUMsUUFBSSxTQUFTO0FBRWIsZUFBVyxRQUFRLE9BQU87QUFDdEIsWUFBTSxRQUFRLEtBQUssSUFBSSxjQUFjLGFBQWEsSUFBSTtBQUN0RCxZQUFNLFlBQVcsb0NBQU8sZ0JBQVAsbUJBQXFCO0FBQ3RDLFVBQUksVUFBVTtBQUNWLGFBQUssY0FBYyxJQUFJLEtBQUssTUFBTSxPQUFPLFFBQVEsRUFBRSxLQUFLLENBQUM7QUFDekQ7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFlBQVEsSUFBSSx5Q0FBeUMsTUFBTSxJQUFJLE1BQU0sTUFBTSxRQUFRO0FBQUEsRUFDdkY7QUFBQSxFQUVBLE1BQU0saUJBQWlCLE1BQWEsUUFBNkI7QUFDN0QsUUFBSSxDQUFDLEtBQUssU0FBUyxVQUFVO0FBQ3pCLGNBQVEsSUFBSSxpREFBaUQsS0FBSyxJQUFJO0FBQ3RFO0FBQUEsSUFDSjtBQUdBLFNBQUssZ0JBQWdCLFNBQVMsS0FBSyxNQUFNLFlBQVk7QUFDakQsWUFBTSxLQUFLLFlBQVksTUFBTSxNQUFNO0FBQUEsSUFDdkMsR0FBRyxHQUFHO0FBQUEsRUFDVjtBQUFBLEVBRUEsTUFBTSxZQUFZLE1BQWEsUUFBNkI7QUFsSWhFO0FBb0lRLFlBQVEsSUFBSSx5Q0FBeUM7QUFBQSxNQUNqRCxNQUFNLEtBQUs7QUFBQSxNQUNYO0FBQUEsTUFDQSxXQUFXLEtBQUs7QUFBQSxNQUNoQixNQUFNLEtBQUssS0FBSztBQUFBLElBQ3BCLENBQUM7QUFFRCxRQUFJO0FBQ0EsWUFBTSxVQUFVLE1BQU0sS0FBSyxJQUFJLE1BQU0sS0FBSyxJQUFJO0FBQzlDLGNBQVEsSUFBSSwyQ0FBMkM7QUFBQSxRQUNuRCxNQUFNLEtBQUs7QUFBQSxRQUNYLGVBQWUsUUFBUTtBQUFBLE1BQzNCLENBQUM7QUFFRCxZQUFNLGlCQUFpQixLQUFLLElBQUksY0FBYyxhQUFhLElBQUk7QUFDL0QsWUFBTSxXQUFXLG9CQUFvQixjQUFjO0FBRW5ELGNBQVEsSUFBSSx1Q0FBdUM7QUFBQSxRQUMvQyxNQUFNLEtBQUs7QUFBQSxRQUNYLGFBQVcsY0FBUyxTQUFULG1CQUFlLFdBQVU7QUFBQSxRQUNwQyxpQkFBZSxjQUFTLGFBQVQsbUJBQW1CLFdBQVU7QUFBQSxRQUM1QyxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVM7QUFBQSxNQUMvQixDQUFDO0FBRUQsWUFBTSxPQUFPLEtBQUs7QUFDbEIsWUFBTSxPQUFPLE1BQU0sV0FBVyxPQUFPO0FBQ3JDLFlBQU0sUUFBUSxJQUFJLEtBQUssS0FBSyxLQUFLLEVBQUUsWUFBWTtBQUMvQyxZQUFNLFdBQVcsTUFBTSxvQkFBb0IsTUFBTSxTQUFTLEtBQUssR0FBRztBQUVsRSxjQUFRLElBQUksa0NBQWtDO0FBQUEsUUFDMUMsTUFBTSxLQUFLO0FBQUEsUUFDWDtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsTUFDSixDQUFDO0FBRUQsWUFBTSxXQUFXO0FBQUEsUUFDYixNQUFNLEtBQUs7QUFBQSxRQUNYO0FBQUEsUUFDQSxZQUFZO0FBQUEsUUFDWjtBQUFBLFFBQ0E7QUFBQSxRQUNBO0FBQUEsUUFDQTtBQUFBLFFBQ0E7QUFBQSxNQUNKO0FBRUEsWUFBTSxTQUFTLE1BQU0sS0FBSyxZQUFZLFNBQVMsUUFBUTtBQUV2RCxVQUFJLE9BQU8sU0FBUztBQUNoQixhQUFLLGNBQWMsSUFBSSxLQUFLLE1BQU0sUUFBUTtBQUMxQyxnQkFBUSxJQUFJLG9EQUErQyxLQUFLLElBQUk7QUFBQSxNQUN4RSxPQUFPO0FBQ0gsZ0JBQVEsTUFBTSw0Q0FBdUMsS0FBSyxNQUFNLE9BQU8sS0FBSztBQUM1RSxZQUFJLHdCQUFPLDZCQUFTLEtBQUssSUFBSTtBQUFBLEVBQUssT0FBTyxLQUFLLEVBQUU7QUFBQSxNQUNwRDtBQUFBLElBQ0osU0FBUyxPQUFPO0FBQ1osY0FBUSxNQUFNLHFEQUFnRDtBQUFBLFFBQzFELE1BQU0sS0FBSztBQUFBLFFBQ1g7QUFBQSxRQUNBLGNBQWMsaUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsUUFDdkQsWUFBWSxpQkFBaUIsUUFBUSxNQUFNLFFBQVE7QUFBQSxNQUN2RCxDQUFDO0FBQ0QsVUFBSSx3QkFBTyw2QkFBUyxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsZUFBZSxFQUFFO0FBQUEsSUFDbEY7QUFBQSxFQUNKO0FBQUEsRUFFQSxNQUFNLGlCQUFpQixNQUFhO0FBQ2hDLFFBQUksQ0FBQyxLQUFLLFNBQVMsVUFBVTtBQUN6QixjQUFRLElBQUksd0RBQXdELEtBQUssSUFBSTtBQUM3RTtBQUFBLElBQ0o7QUFFQSxZQUFRLElBQUksMkNBQTJDO0FBQUEsTUFDbkQsTUFBTSxLQUFLO0FBQUEsTUFDWCxXQUFXLEtBQUs7QUFBQSxJQUNwQixDQUFDO0FBRUQsVUFBTSxXQUFXLEtBQUssY0FBYyxJQUFJLEtBQUssSUFBSTtBQUVqRCxRQUFJLENBQUMsVUFBVTtBQUNYLGNBQVEsS0FBSyxpRUFBaUUsS0FBSyxJQUFJO0FBQ3ZGO0FBQUEsSUFDSjtBQUVBLFVBQU0sU0FBUyxNQUFNLEtBQUssWUFBWSxTQUFTO0FBQUEsTUFDM0MsTUFBTSxLQUFLO0FBQUEsTUFDWDtBQUFBLE1BQ0EsWUFBWTtBQUFBLE1BQ1osUUFBUTtBQUFBLElBQ1osQ0FBQztBQUVELFFBQUksT0FBTyxTQUFTO0FBQ2hCLFdBQUssY0FBYyxPQUFPLEtBQUssSUFBSTtBQUNuQyxjQUFRLElBQUksZ0RBQTJDLEtBQUssSUFBSTtBQUFBLElBQ3BFLE9BQU87QUFDSCxjQUFRLE1BQU0scURBQWdELEtBQUssTUFBTSxPQUFPLEtBQUs7QUFBQSxJQUN6RjtBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQU0saUJBQWlCLE1BQWEsU0FBaUI7QUFDakQsUUFBSSxDQUFDLEtBQUssU0FBUyxVQUFVO0FBQ3pCLGNBQVEsSUFBSSx3REFBd0QsU0FBUyxNQUFNLEtBQUssSUFBSTtBQUM1RjtBQUFBLElBQ0o7QUFFQSxZQUFRLElBQUkseUNBQXlDO0FBQUEsTUFDakQ7QUFBQSxNQUNBLFNBQVMsS0FBSztBQUFBLE1BQ2QsV0FBVyxLQUFLO0FBQUEsSUFDcEIsQ0FBQztBQUVELFNBQUssY0FBYyxPQUFPLFNBQVMsS0FBSyxJQUFJO0FBRTVDLFFBQUk7QUFDQSxjQUFRLElBQUksc0RBQXNEO0FBQ2xFLFlBQU0sS0FBSyxZQUFZLE1BQU0sUUFBUTtBQUVyQyxjQUFRLElBQUksOENBQXlDLFNBQVMsTUFBTSxLQUFLLElBQUk7QUFBQSxJQUNqRixTQUFTLE9BQU87QUFDWixjQUFRLE1BQU0saURBQTRDO0FBQUEsUUFDdEQ7QUFBQSxRQUNBLFNBQVMsS0FBSztBQUFBLFFBQ2Q7QUFBQSxRQUNBLGNBQWMsaUJBQWlCLFFBQVEsTUFBTSxVQUFVO0FBQUEsTUFDM0QsQ0FBQztBQUNELFVBQUksd0JBQU8sK0NBQVksaUJBQWlCLFFBQVEsTUFBTSxVQUFVLGVBQWUsRUFBRTtBQUFBLElBQ3JGO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBTSxrQkFBa0IsTUFBYSxRQUE2QjtBQUM5RCxRQUFJLENBQUMsS0FBSyxTQUFTLFVBQVU7QUFDekIsY0FBUSxJQUFJLHVEQUF1RCxLQUFLLElBQUk7QUFDNUU7QUFBQSxJQUNKO0FBRUEsU0FBSyxnQkFBZ0IsU0FBUyxLQUFLLE1BQU0sWUFBWTtBQUNqRCxZQUFNLEtBQUssaUJBQWlCLE1BQU0sTUFBTTtBQUFBLElBQzVDLEdBQUcsR0FBRztBQUFBLEVBQ1Y7QUFBQSxFQUVBLE1BQU0saUJBQWlCLE1BQWEsUUFBNkI7QUFqUnJFO0FBa1JRLFlBQVEsSUFBSSwwQ0FBMEM7QUFBQSxNQUNsRCxNQUFNLEtBQUs7QUFBQSxNQUNYO0FBQUEsTUFDQSxXQUFXLEtBQUs7QUFBQSxNQUNoQixNQUFNLEtBQUssS0FBSztBQUFBLElBQ3BCLENBQUM7QUFFRCxRQUFJO0FBQ0EsWUFBTSxTQUFTLE1BQU0sS0FBSyxJQUFJLE1BQU0sV0FBVyxJQUFJO0FBQ25ELFlBQU0sVUFBVSxNQUFNLG9CQUFvQixNQUFNO0FBQ2hELFlBQU0sU0FBUyxNQUFNLFdBQVcsTUFBTTtBQUV0QyxZQUFNLFlBQVcsVUFBSyxtQkFBbUIsSUFBSSxLQUFLLElBQUksTUFBckMsWUFBMEMsT0FBTyxXQUFXO0FBRTdFLFlBQU0sV0FBMEI7QUFBQSxRQUM1QixNQUFNLEtBQUs7QUFBQSxRQUNYO0FBQUEsUUFDQTtBQUFBLFFBQ0EsYUFBYSxlQUFlLEtBQUssU0FBUztBQUFBLFFBQzFDO0FBQUEsUUFDQSxNQUFNLE9BQU87QUFBQSxRQUNiO0FBQUEsTUFDSjtBQUVBLFlBQU0sU0FBUyxNQUFNLEtBQUssWUFBWSxVQUFVLFFBQVE7QUFFeEQsVUFBSSxPQUFPLFNBQVM7QUFDaEIsYUFBSyxtQkFBbUIsSUFBSSxLQUFLLE1BQU0sUUFBUTtBQUMvQyxnQkFBUSxJQUFJLHFEQUFnRCxLQUFLLElBQUk7QUFBQSxNQUN6RSxPQUFPO0FBQ0gsZ0JBQVEsTUFBTSw2Q0FBd0MsS0FBSyxNQUFNLE9BQU8sS0FBSztBQUM3RSxZQUFJLHdCQUFPLHlDQUFXLEtBQUssSUFBSTtBQUFBLEVBQUssT0FBTyxLQUFLLEVBQUU7QUFBQSxNQUN0RDtBQUFBLElBQ0osU0FBUyxPQUFPO0FBQ1osY0FBUSxNQUFNLGdEQUEyQztBQUFBLFFBQ3JELE1BQU0sS0FBSztBQUFBLFFBQ1gsT0FBTyxpQkFBaUIsUUFBUSxNQUFNLFVBQVU7QUFBQSxNQUNwRCxDQUFDO0FBQ0QsVUFBSSx3QkFBTyx5Q0FBVyxpQkFBaUIsUUFBUSxNQUFNLFVBQVUsZUFBZSxFQUFFO0FBQUEsSUFDcEY7QUFBQSxFQUNKO0FBQUEsRUFFQSxNQUFNLGtCQUFrQixNQUFhO0FBQ2pDLFFBQUksQ0FBQyxLQUFLLFNBQVMsVUFBVTtBQUN6QixjQUFRLElBQUksOERBQThELEtBQUssSUFBSTtBQUNuRjtBQUFBLElBQ0o7QUFFQSxZQUFRLElBQUksNENBQTRDLEtBQUssSUFBSTtBQUVqRSxVQUFNLFdBQVcsS0FBSyxtQkFBbUIsSUFBSSxLQUFLLElBQUk7QUFDdEQsUUFBSSxDQUFDLFVBQVU7QUFDWCxjQUFRLEtBQUssdUVBQXVFLEtBQUssSUFBSTtBQUM3RjtBQUFBLElBQ0o7QUFFQSxVQUFNLFNBQVMsTUFBTSxLQUFLLFlBQVksVUFBVTtBQUFBLE1BQzVDLE1BQU0sS0FBSztBQUFBLE1BQ1g7QUFBQSxNQUNBLGFBQWEsZUFBZSxLQUFLLFNBQVM7QUFBQSxNQUMxQyxRQUFRO0FBQUEsSUFDWixDQUFDO0FBRUQsUUFBSSxPQUFPLFNBQVM7QUFDaEIsV0FBSyxtQkFBbUIsT0FBTyxLQUFLLElBQUk7QUFDeEMsY0FBUSxJQUFJLGlEQUE0QyxLQUFLLElBQUk7QUFBQSxJQUNyRSxPQUFPO0FBQ0gsY0FBUSxNQUFNLHNEQUFpRCxLQUFLLE1BQU0sT0FBTyxLQUFLO0FBQUEsSUFDMUY7QUFBQSxFQUNKO0FBQUEsRUFFQSxNQUFNLGtCQUFrQixNQUFhLFNBQWlCO0FBQ2xELFFBQUksQ0FBQyxLQUFLLFNBQVMsVUFBVTtBQUN6QixjQUFRLElBQUksOERBQThELFNBQVMsTUFBTSxLQUFLLElBQUk7QUFDbEc7QUFBQSxJQUNKO0FBRUEsWUFBUSxJQUFJLDBDQUEwQyxTQUFTLE1BQU0sS0FBSyxJQUFJO0FBRTlFLFNBQUssbUJBQW1CLE9BQU8sU0FBUyxLQUFLLElBQUk7QUFFakQsVUFBTSxLQUFLLGlCQUFpQixNQUFNLFFBQVE7QUFBQSxFQUM5QztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9BLE1BQU0sZUFBZTtBQUNqQixVQUFNLGdCQUFnQixLQUFLLElBQUksTUFBTSxpQkFBaUI7QUFDdEQsVUFBTSxhQUFhLEtBQUssSUFBSSxNQUFNLFNBQVMsRUFBRSxPQUFPLE9BQUssWUFBWSxDQUFDLENBQUM7QUFDdkUsVUFBTSxhQUFhLGNBQWMsU0FBUyxXQUFXO0FBRXJELFlBQVEsSUFBSSwwQ0FBMEMsY0FBYyxNQUFNLGVBQWUsV0FBVyxNQUFNLGFBQWEsVUFBVSxRQUFRO0FBQ3pJLFFBQUksd0JBQU8sd0NBQVUsVUFBVSx3QkFBUyxjQUFjLE1BQU0sa0JBQVEsV0FBVyxNQUFNLG1CQUFTO0FBRzlGLFVBQU0sWUFBWSxNQUFNLEtBQUssaUJBQWlCLGFBQWE7QUFDM0QsWUFBUSxJQUFJLDZCQUE2QixVQUFVLE1BQU0sYUFBYTtBQUd0RSxVQUFNLEtBQUssZUFBZSxTQUFTO0FBR25DLFVBQU0sS0FBSyxxQkFBcUIsYUFBYTtBQUc3QyxVQUFNLEtBQUssZUFBZSxVQUFVO0FBQUEsRUFDeEM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsTUFBYyxpQkFBaUIsT0FBbUM7QUFDOUQsVUFBTSxNQUFnQixDQUFDO0FBQ3ZCLGVBQVcsUUFBUSxPQUFPO0FBQ3RCLFVBQUk7QUFDQSxjQUFNLFVBQVUsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLElBQUk7QUFFOUMsYUFBSSxtQ0FBUyxPQUFPLFVBQVMsR0FBRztBQUM1QixjQUFJLEtBQUssTUFBTSxvQkFBb0IsTUFBTSxTQUFTLEtBQUssR0FBRyxDQUFDO0FBQUEsUUFDL0Q7QUFBQSxNQUNKLFNBQVMsT0FBTztBQUNaLGdCQUFRLE1BQU0sa0NBQWtDLEtBQUssSUFBSSxLQUFLLEtBQUs7QUFBQSxNQUN2RTtBQUFBLElBQ0o7QUFDQSxXQUFPO0FBQUEsRUFDWDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxNQUFjLGVBQWUsV0FBb0M7QUF6WnJFO0FBMFpRLFFBQUk7QUFDQSxZQUFNLFNBQVMsTUFBTSxLQUFLLFlBQVksU0FBUyxTQUFTO0FBQ3hELFlBQU0sWUFBVSxZQUFPLFNBQVAsbUJBQWMscUJBQW9CO0FBRWxELFVBQUksVUFBVSxHQUFHO0FBQ2IsZ0JBQVEsSUFBSSxrQ0FBNkIsT0FBTyxlQUFlO0FBQy9ELFlBQUksd0JBQU8sc0JBQU8sT0FBTyxpQ0FBUTtBQUFBLE1BQ3JDLFdBQVcsT0FBTyxTQUFTO0FBQ3ZCLGdCQUFRLElBQUksOENBQXlDO0FBQUEsTUFDekQ7QUFBQSxJQUNKLFNBQVMsT0FBTztBQUVaLGNBQVEsTUFBTSxvQ0FBb0MsS0FBSztBQUFBLElBQzNEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxNQUFjLHFCQUFxQixPQUErQjtBQUM5RCxVQUFNLFFBQW1CLEVBQUUsU0FBUyxHQUFHLFFBQVEsR0FBRyxTQUFTLEVBQUU7QUFDN0QsVUFBTSxZQUFZO0FBRWxCLGFBQVMsSUFBSSxHQUFHLElBQUksTUFBTSxRQUFRLEtBQUssV0FBVztBQUM5QyxZQUFNLFFBQVEsTUFBTSxNQUFNLEdBQUcsSUFBSSxTQUFTO0FBQzFDLFlBQU0sUUFBUSxJQUFJLE1BQU0sSUFBSSxVQUFRLEtBQUssWUFBWSxNQUFNLEtBQUssQ0FBQyxDQUFDO0FBRWxFLFlBQU0sV0FBVyxLQUFLLElBQUksSUFBSSxXQUFXLE1BQU0sTUFBTTtBQUNyRCxVQUFJLHdCQUFPLDZCQUFTLFFBQVEsSUFBSSxNQUFNLE1BQU0sbUJBQVMsTUFBTSxPQUFPLG1CQUFTLE1BQU0sTUFBTSxtQkFBUyxNQUFNLE9BQU8sR0FBRztBQUFBLElBQ3BIO0FBRUEsVUFBTSxXQUFXLHVEQUFlLE1BQU0sTUFBTSxtQkFBUyxNQUFNLE9BQU8sbUJBQVMsTUFBTSxNQUFNLG1CQUFTLE1BQU0sT0FBTztBQUM3RyxZQUFRLElBQUksbUJBQW1CLFFBQVEsRUFBRTtBQUN6QyxRQUFJLHdCQUFPLFVBQVUsR0FBSTtBQUFBLEVBQzdCO0FBQUEsRUFFQSxNQUFjLGVBQWUsT0FBK0I7QUFDeEQsUUFBSSxNQUFNLFdBQVcsR0FBRztBQUNwQixjQUFRLElBQUksd0NBQXdDO0FBQ3BEO0FBQUEsSUFDSjtBQUVBLFVBQU0sUUFBbUIsRUFBRSxTQUFTLEdBQUcsUUFBUSxHQUFHLFNBQVMsRUFBRTtBQUM3RCxVQUFNLFlBQVk7QUFFbEIsYUFBUyxJQUFJLEdBQUcsSUFBSSxNQUFNLFFBQVEsS0FBSyxXQUFXO0FBQzlDLFlBQU0sUUFBUSxNQUFNLE1BQU0sR0FBRyxJQUFJLFNBQVM7QUFDMUMsWUFBTSxRQUFRLElBQUksTUFBTSxJQUFJLFVBQVEsS0FBSyxhQUFhLE1BQU0sS0FBSyxDQUFDLENBQUM7QUFFbkUsWUFBTSxXQUFXLEtBQUssSUFBSSxJQUFJLFdBQVcsTUFBTSxNQUFNO0FBQ3JELFVBQUksd0JBQU8seUNBQVcsUUFBUSxJQUFJLE1BQU0sTUFBTSxtQkFBUyxNQUFNLE9BQU8sbUJBQVMsTUFBTSxNQUFNLEdBQUc7QUFBQSxJQUNoRztBQUVBLFVBQU0sV0FBVyx1REFBZSxNQUFNLE1BQU0sbUJBQVMsTUFBTSxPQUFPLG1CQUFTLE1BQU0sTUFBTTtBQUN2RixZQUFRLElBQUksbUJBQW1CLFFBQVEsRUFBRTtBQUN6QyxRQUFJLHdCQUFPLFVBQVUsR0FBSTtBQUFBLEVBQzdCO0FBQUEsRUFFQSxNQUFjLGFBQWEsTUFBYSxPQUFpQztBQUNyRSxRQUFJO0FBQ0EsWUFBTSxLQUFLLGlCQUFpQixNQUFNLFFBQVE7QUFDMUMsWUFBTTtBQUFBLElBQ1YsU0FBUyxPQUFPO0FBQ1osWUFBTTtBQUNOLGNBQVEsTUFBTSwrQ0FBMEMsS0FBSyxJQUFJLEtBQUssS0FBSztBQUFBLElBQy9FO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBS0EsTUFBYyxZQUFZLE1BQWEsT0FBaUM7QUFDcEUsUUFBSTtBQUdBLFlBQU0sS0FBSyxZQUFZLE1BQU0sUUFBUTtBQUNyQyxZQUFNO0FBQUEsSUFDVixTQUFTLE9BQU87QUFDWixZQUFNO0FBQ04sY0FBUSxNQUFNLHlDQUFvQyxLQUFLLElBQUksS0FBSyxLQUFLO0FBQUEsSUFDekU7QUFBQSxFQUNKO0FBQUEsRUFFQSxXQUFXO0FBQ1AsWUFBUSxJQUFJLGdDQUFnQztBQUU1QyxTQUFLLGdCQUFnQixTQUFTO0FBQzlCLFNBQUssWUFBWSxRQUFRO0FBQUEsRUFDN0I7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0IsTUFBTSxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQzdFO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDakIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQ2pDLFNBQUssWUFBWSxhQUFhO0FBQUEsTUFDMUIsV0FBVyxLQUFLLFNBQVM7QUFBQSxNQUN6QixTQUFTLEtBQUssU0FBUztBQUFBLElBQzNCLENBQUM7QUFBQSxFQUNMO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
