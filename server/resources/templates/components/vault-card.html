<!-- Vault Card Component
  Parameters:
  - vault: vault object with id, name, domain, sync-key, masked-key, root-doc-id, documents
-->
<div class="vault-card">
    <!-- Header -->
    <div class="vault-header">
      <div class="vault-info">
        <h3>{{vault.name}}</h3>
        <a href="http://{{vault.domain}}" target="_blank" class="vault-domain">
          <i data-lucide="globe" class="icon-xs"></i>
          <span>{{vault.domain}}</span>
          <i data-lucide="external-link" class="icon-xs"></i>
        </a>
      </div>

      <!-- Actions -->
      <div class="vault-actions">
        <button type="button"
                class="action-menu-btn"
                onclick="toggleActionMenu(this)">
          <i data-lucide="more-vertical" class="icon-md"></i>
        </button>
        <div class="action-menu">
          <button type="button" onclick="window.open('http://{{vault.domain}}', '_blank'); toggleActionMenu(this.closest('.vault-actions').querySelector('.action-menu-btn'))">
            <i data-lucide="external-link" class="icon-xs"></i>
            <span>Open site</span>
          </button>
          <button type="button" onclick="openEditModal('{{vault.id}}', '{{vault.name}}', '{{vault.domain}}'); toggleActionMenu(this.closest('.vault-actions').querySelector('.action-menu-btn'))">
            <i data-lucide="pencil" class="icon-xs"></i>
            <span>Edit</span>
          </button>
          <button type="button"
                  class="danger"
                  hx-delete="/admin/vaults/{{vault.id}}"
                  hx-confirm="Are you sure you want to delete '{{vault.name}}'? This cannot be undone."
                  hx-swap="none"
                  hx-on::after-request="if(event.detail.successful) { showNotification('Site deleted', 'success'); htmx.trigger('body', 'refreshList'); } else { showNotification('Delete failed', 'error'); }">
            <i data-lucide="trash-2" class="icon-xs"></i>
            <span>Delete</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Sync Key Section -->
    <div class="vault-section">
      <span class="section-label">Sync Key</span>
      <div class="sync-key-box">
        <div class="sync-key-header">
          <span class="text-xs text-[var(--text-tertiary)]">For Obsidian plugin sync</span>
          <div class="sync-key-actions">
            <button type="button"
                    class="icon-btn"
                    onclick="toggleSyncKey(this, '{{vault.id}}')"
                    title="Show/Hide">
              <i data-lucide="eye" class="icon-xs"></i>
            </button>
            <button type="button"
                    class="icon-btn"
                    onclick="copyToClipboard('{{vault.sync-key}}')"
                    title="Copy">
              <i data-lucide="copy" class="icon-xs"></i>
            </button>
          </div>
        </div>
        <div class="sync-key-value" id="key-{{vault.id}}" data-key="{{vault.sync-key}}">
          {{vault.masked-key}}
        </div>
      </div>
    </div>

    <!-- Home Page Section -->
    <div class="vault-section">
      <span class="section-label">Home Page</span>
      {% with vault-id=vault.id root-doc-id=vault.root-doc-id documents=vault.documents %}
        {% include "templates/admin/root-doc-selector.html" %}
      {% endwith %}
    </div>
</div>
