{% extends "templates/frontend/base.html" %}

{% block title %}{{ docs.0.doc.title }} - {{ vault.name }}{% endblock %}

{% block content %}
<div class="notes-container grow flex overflow-x-auto overflow-y-hidden" id="notes">
  {% for doc_data in docs %}
  <div
    class="note grow shrink-0 overflow-y-auto w-full md:w-[625px] md:max-w-[625px] bg-white sticky top-0"
    id="note-{{ doc_data.doc.id }}"
  >
    <article class="p-4 md:p-8 prose">
      <h1>{{ doc_data.doc.title }}</h1>
      {{ doc_data.doc.html-content|safe }}
      <p class="last-updated">Last updated: {{ doc_data.doc.updated-at }}</p>
    </article>

    {% if doc_data.backlinks|length > 0 %}
    <div class="backlinks-section px-4 md:px-8">
      <h2 class="backlinks-title">Links to this note</h2>
      <div class="backlinks-grid">
        {% for backlink in doc_data.backlinks %}
        <div class="backlink-item">
          <a
            href="/{{ backlink.id }}"
            hx-get="/{{ backlink.id }}"
            hx-headers='{"X-From-Note-Id": "{{ doc_data.doc.id }}"}'
            hx-target="#notes"
            hx-swap="beforeend"
          >
            <span class="backlink-title">{{ backlink.title }}</span>
            {% if backlink.description %}
            <p class="backlink-desc">{{ backlink.description }}</p>
            {% endif %}
          </a>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
  {% endfor %}
</div>
{% endblock %}
