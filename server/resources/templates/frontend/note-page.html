{% extends "templates/frontend/base.html" %}

{% block title %}{{ notes.0.note.title }} - {{ vault.name }}{% endblock %}

{% block content %}
<div class="notes-container grow flex overflow-x-auto overflow-y-hidden" id="notes">
  {% for note_data in notes %}
  <div
    class="note grow shrink-0 overflow-y-auto w-full md:w-[625px] md:max-w-[625px] bg-white sticky top-0"
    id="note-{{ note_data.note.client-id }}"
  >
    <article class="p-4 md:p-8 prose">
      <h1>{{ note_data.note.title }}</h1>
      {{ note_data.note.html-content|safe }}
      <p class="last-updated">Last updated: {{ note_data.note.updated-at }}</p>
    </article>

    {% if note_data.backlinks|length > 0 %}
    <div class="backlinks-section px-4 md:px-8">
      <h2 class="backlinks-title">Links to this note</h2>
      <div class="backlinks-grid">
        {% for backlink in note_data.backlinks %}
        <div class="backlink-item">
          <a
            href="/{{ backlink.client-id }}"
            hx-get="/{{ backlink.client-id }}"
            hx-headers='{"X-From-Note-Id": "{{ note_data.note.client-id }}"}'
            hx-target="#notes"
            hx-swap="beforeend"
          >
            <span class="backlink-title">{{ backlink.title }}</span>
            <p class="backlink-desc">{{ backlink.description|default:"" }}</p>
          </a>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
  {% endfor %}
</div>
{% endblock %}
